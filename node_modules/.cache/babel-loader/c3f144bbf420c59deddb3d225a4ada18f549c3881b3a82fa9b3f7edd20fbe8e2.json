{"ast":null,"code":"import { config } from '@onflow/config';\nexport { config } from '@onflow/config';\nimport * as sdk from '@onflow/sdk';\nimport { invariant as invariant$1, arg, encodeMessageFromSignable, config as config$1, resolve, pipe, interaction, createSignableVoucher, send as send$1, getTransactionStatus, decode, block, getEventsAtBlockHeightRange, getAccount, atBlockHeight } from '@onflow/sdk';\nexport { TestUtils, account, arg, args, atBlockHeight, atBlockId, authorization, authorizations, block, build, createSignableVoucher, decode, getAccount, getBlock, getBlockHeader, getCollection, getEvents, getEventsAtBlockHeightRange, getEventsAtBlockIds, getNetworkParameters, getTransaction, getTransactionStatus, invariant, isBad, isOk, limit, param, params, payer, ping, pipe, proposer, ref, script, send, transaction, validator, voucherIntercept, voucherToTxId, why } from '@onflow/sdk';\nimport { log, LEVELS } from '@onflow/util-logger';\nimport { invariant } from '@onflow/util-invariant';\nimport * as t$1 from '@onflow/types';\nimport fetchTransport from 'cross-fetch';\nimport { withPrefix, sansPrefix } from '@onflow/util-address';\nexport { display, sansPrefix, withPrefix } from '@onflow/util-address';\nimport { subscriber, snapshoter, send, spawn, INIT, SUBSCRIBE, UNSUBSCRIBE, UPDATED as UPDATED$2, SNAPSHOT as SNAPSHOT$1 } from '@onflow/util-actor';\nimport * as rlp from '@onflow/rlp';\nimport { Buffer, encode } from '@onflow/rlp';\nimport { uid } from '@onflow/util-uid';\nimport require$$0 from 'buffer';\nexport { template as cadence, template as cdc } from '@onflow/util-template';\nasync function getChainIdFromAccessNode() {\n  const response = await sdk.send([sdk.getNetworkParameters()]).then(sdk.decode);\n  return response.chainId;\n}\n\n/**\n * Sets the default chain id to the chain id of the access node\n *\n * @returns {string} The chain id of the access node\n *\n * @example\n * // returns \"testnet\"\n * setChainIdDefault()\n */\nasync function setChainIdDefault() {\n  const network = await getChainIdFromAccessNode();\n  config.put(\"flow.network.default\", network);\n  return network;\n}\n\n/**\n * @description\n * Gets the chain ID if its set, otherwise gets the chain ID from the access node\n *\n * @returns {string} The chain ID of the access node\n * @throws {Error} If the chain ID is not found\n *\n * @example\n * // returns \"testnet\"\n * getChainId()\n */\nasync function getChainId() {\n  let network = await config.get(\"flow.network.default\");\n  if (!network) {\n    network = await setChainIdDefault();\n    if (!network) {\n      network = await config.get(\"flow.network\");\n      if (network) {\n        log.deprecate({\n          pkg: \"FCL\",\n          subject: 'Using the \"flow.network\" configuration key for specifying the flow network',\n          message: \"Configuring flow.network is no longer required\",\n          transition: \"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/TRANSITIONS.md#0002-deprecate-flow.network-config-key\"\n        });\n      } else {\n        network = await config.get(\"env\");\n        if (network) log.deprecate({\n          pkg: \"FCL\",\n          subject: 'Using the \"env\" configuration key for specifying the flow network',\n          message: \"Configuring to specify flow network is no longer required\",\n          transition: \"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/TRANSITIONS.md#0001-deprecate-env-config-key\"\n        });\n      }\n    }\n  }\n  invariant(network, \"Error getting chainId from access node. Please configure flow.network instead\");\n  return network;\n}\n\n/**\n * @description\n * Watches the config for changes to access node and updates the chain id accordingly\n *\n * @returns {Function} A function that unsubscribes the listener\n *\n */\nfunction watchForChainIdChanges() {\n  return config.subscribe(function configSubscriber(config) {\n    const nextAccessNode = config?.[\"accessNode.api\"];\n    if (this.prevAccessNode !== nextAccessNode) {\n      setChainIdDefault();\n    }\n    this.prevAccessNode = nextAccessNode;\n  }.bind({}));\n}\nfunction isAndroid() {\n  return typeof navigator !== \"undefined\" && /android/i.test(navigator.userAgent);\n}\nfunction isSmallIOS() {\n  return typeof navigator !== \"undefined\" && /iPhone|iPod/.test(navigator.userAgent);\n}\nfunction isLargeIOS() {\n  return typeof navigator !== \"undefined\" && /iPad/.test(navigator.userAgent);\n}\nfunction isIOS() {\n  return isSmallIOS() || isLargeIOS();\n}\nfunction isMobile() {\n  return isAndroid() || isIOS();\n}\nconst isServerSide = () => typeof window === \"undefined\";\nconst SESSION_STORAGE = {\n  can: !isServerSide(),\n  get: async key => JSON.parse(sessionStorage.getItem(key)),\n  put: async (key, value) => sessionStorage.setItem(key, JSON.stringify(value))\n};\nconfig({\n  \"discovery.wallet.method.default\": \"IFRAME/RPC\",\n  \"fcl.storage.default\": SESSION_STORAGE\n});\n\n// Set chain id default on access node change\nwatchForChainIdChanges();\nasync function configLens(regex) {\n  return Object.fromEntries(Object.entries(await config().where(regex)).map(_ref => {\n    let [key, value] = _ref;\n    return [key.replace(regex, \"\"), value];\n  }));\n}\nconst VERSION = \"1.4.1\";\nconst is = type => d => typeof d === type;\nconst isRequired = d => d != null;\nconst isObject = is(\"object\");\nconst isString = is(\"string\");\nconst isFunc = is(\"function\");\nconst isNumber = is(\"number\");\nfunction normalizeArgs(ax) {\n  if (isFunc(ax)) return ax(sdk.arg, t$1);\n  return [];\n}\nasync function httpDocumentResolver(_ref) {\n  let {\n    url\n  } = _ref;\n  invariant(typeof url !== \"undefined\", \"retrieve({ url }) -- url must be defined\");\n  let res;\n  try {\n    res = await fetchTransport(url);\n  } catch (e) {\n    throw new Error(\"httpDocumentResolver Error: Failed to retrieve document.\");\n  }\n  let document = res.ok ? await res.json() : null;\n  return document;\n}\nconst DOCUMENT_RESOLVERS = new Map([[\"http\", httpDocumentResolver], [\"https\", httpDocumentResolver]]);\nasync function retrieve(_ref2) {\n  let {\n    url\n  } = _ref2;\n  invariant(typeof url !== \"undefined\", \"retrieve({ url }) -- url must be defined\");\n  invariant(typeof url === \"string\", \"retrieve({ url }) -- url must be a string\");\n  const documentResolversFromConfig = await config().where(/^document\\.resolver\\./);\n  Object.keys(documentResolversFromConfig).map(key => {\n    const resolverFromConfig = documentResolversFromConfig[key];\n    const resolverProtocol = key.replace(/^document\\.resolver\\./, \"\");\n    DOCUMENT_RESOLVERS.set(resolverProtocol, resolverFromConfig);\n  });\n  const urlParts = /^(.*):\\/\\/([A-Za-z0-9\\-\\.]+)(:[0-9]+)?(.*)$/.exec(url);\n  invariant(urlParts, \"Failed to parse URL\");\n  const protocol = urlParts[1];\n  invariant(urlParts, \"Failed to parse URL protocol\");\n  const resolver = DOCUMENT_RESOLVERS.get(protocol);\n  invariant(resolver, `No resolver found for protcol=${protocol}`);\n  let document = await resolver({\n    url\n  });\n  return document;\n}\nfunction normalizeInteractionTemplate(template) {\n  if (template == null) return null;\n  switch (template[\"f_version\"]) {\n    case \"1.0.0\":\n      return template;\n    default:\n      throw new Error(\"normalizeInteractionTemplate Error: Invalid InteractionTemplate\");\n  }\n}\n\n/**\n * @description Fills import addresses in Cadence for network\n * \n * @param {object} params\n * @param {string} params.network - Network to derive Cadence for\n * @param {object} params.template - Interaction Template to derive Cadence from\n * @returns {string} - Cadence\n */\nfunction deriveCadenceByNetwork(_ref) {\n  let {\n    network,\n    template\n  } = _ref;\n  invariant$1(network != undefined, \"deriveCadenceByNetwork({ network }) -- network must be defined\");\n  invariant$1(typeof network === \"string\", \"deriveCadenceByNetwork({ network }) -- network must be a string\");\n  invariant$1(template != undefined, \"generateDependencyPin({ template }) -- template must be defined\");\n  invariant$1(typeof template === \"object\", \"generateDependencyPin({ template }) -- template must be an object\");\n  invariant$1(template.f_type === \"InteractionTemplate\", \"generateDependencyPin({ template }) -- template must be an InteractionTemplate\");\n  template = normalizeInteractionTemplate(template);\n  switch (template.f_version) {\n    case \"1.0.0\":\n      let networkDependencies = Object.keys(template?.data?.dependencies).map(dependencyPlaceholder => {\n        let dependencyNetworkContracts = Object.values(template?.data?.dependencies?.[dependencyPlaceholder]);\n        invariant$1(dependencyNetworkContracts, `deriveCadenceByNetwork -- Could not find contracts for dependency placeholder: ${dependencyPlaceholder}`);\n        invariant$1(dependencyNetworkContracts.length === 0, `deriveCadenceByNetwork -- Could not find contracts for dependency placeholder: ${dependencyPlaceholder}`);\n        let dependencyContract = dependencyNetworkContracts[0];\n        let dependencyContractForNetwork = dependencyContract?.[network];\n        invariant$1(dependencyContractForNetwork, `deriveCadenceByNetwork -- Could not find ${network} network information for dependency: ${dependencyPlaceholder}`);\n        return [dependencyPlaceholder, dependencyContractForNetwork.address];\n      });\n      return networkDependencies.reduce((cadence, _ref2) => {\n        let [placeholder, address] = _ref2;\n        const regex = new RegExp(\"(\\\\b\" + placeholder + \"\\\\b)\", \"g\");\n        return cadence.replace(regex, address);\n      }, template.data.cadence);\n    default:\n      throw new Error(\"deriveCadenceByNetwork Error: Unsupported template version\");\n  }\n}\nasync function deriveDependencies(_ref) {\n  let {\n    template\n  } = _ref;\n  const network = await getChainId();\n  invariant(network, \"FCL configureDependencies Error: Missing configuration value for 'flow.network'\");\n  const derivedDependencies = {};\n  switch (template[\"f_version\"]) {\n    case \"1.0.0\":\n      const dependencyPlaceholderKeys = Object.keys(template?.data?.dependencies);\n      for (let dependencyPlaceholderKey of dependencyPlaceholderKeys) {\n        let dependencyPlaceholder = template?.data?.dependencies[dependencyPlaceholderKey];\n        const dependencyPlaceholderContractsKeys = Object.keys(dependencyPlaceholder);\n        invariant(dependencyPlaceholderContractsKeys.length > 0, `FCL configureDependencies Error: No contracts found in template for placeholder=${dependencyPlaceholderKey}`);\n        const dependencyPlaceholderContract = dependencyPlaceholder[dependencyPlaceholderContractsKeys[0]];\n        const dependency = dependencyPlaceholderContract[network];\n        invariant(dependency, `FCL configureDependencies Error: No dependency information for placeholder=${dependencyPlaceholderKey} contract=${dependencyPlaceholderContractsKeys[0]} network=${network}`);\n        invariant(dependency?.address, `FCL configureDependencies Error: No address information for placeholder=${dependencyPlaceholderKey} contract=${dependencyPlaceholderContractsKeys[0]} network=${network}`);\n        derivedDependencies[dependencyPlaceholderKey] = withPrefix(dependency?.address);\n      }\n      return derivedDependencies;\n    default:\n      throw new Error(\"FCL configureDependencies Error: Unsupported template version\");\n  }\n}\nasync function prepTemplateOpts(opts) {\n  if (isString(opts?.template)) {\n    opts.template = await retrieve({\n      url: opts?.template\n    });\n  }\n  let dependencies = {};\n  if (opts?.template) {\n    opts.template = normalizeInteractionTemplate(opts?.template);\n    dependencies = await deriveDependencies({\n      template: opts.template\n    });\n  }\n  const cadence = opts.cadence || deriveCadenceByNetwork({\n    template: opts.template,\n    network: await getChainId()\n  });\n  opts.cadence = cadence;\n  opts.dependencies = dependencies;\n  return opts;\n}\nasync function pre(type, opts) {\n  // prettier-ignore\n  invariant(isRequired(opts), `${type}(opts) -- opts is required`);\n  // prettier-ignore\n  invariant(isObject(opts), `${type}(opts) -- opts must be an object`);\n  // prettier-ignore\n  invariant(!(opts.cadence && opts.template), `${type}({ template, cadence }) -- cannot pass both cadence and template`);\n  // prettier-ignore\n  invariant(isRequired(opts.cadence || opts?.template), `${type}({ cadence }) -- cadence is required`);\n  // // prettier-ignore\n  invariant(isString(opts.cadence) || opts?.template, `${type}({ cadence }) -- cadence must be a string`);\n  // prettier-ignore\n  invariant(opts.cadence || (await sdk.config().get(\"flow.network\")), `${type}(opts) -- Required value for \"flow.network\" not defined in config. See: ${\"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"}`);\n  // prettier-ignore\n  invariant(await sdk.config().get(\"accessNode.api\"), `${type}(opts) -- Required value for \"accessNode.api\" not defined in config. See: ${\"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"}`);\n}\nasync function preMutate(opts) {\n  return pre(\"mutate\", opts);\n}\nasync function preQuery(opts) {\n  return pre(\"query\", opts);\n}\n\n/**\n * @description\n * Allows you to submit scripts to query the blockchain.\n *\n *  @param {object} opts - Query Options and configuration\n *  @param {string} opts.cadence - Cadence Script used to query Flow\n *  @param {import(\"../fcl\").ArgsFn} [opts.args] - Arguments passed to cadence script\n *  @param {object} [opts.template] - Interaction Template for a script\n *  @param {number} [opts.limit]   - Compute Limit for Query\n *  @returns {Promise}\n *\n *  @example\n *    const cadence = `\n *      cadence: `\n *        pub fun main(a: Int, b: Int, c: Address): Int {\n *          log(c)\n *          return a + b\n *        }\n *    `.trim()\n *\n *    const args = (arg, t) => [\n *      arg(5, t.Int),\n *      arg(7, t.Int),\n *      arg(\"0xb2db43ad6bc345fec9\", t.Address),\n *    ]\n *\n *    await query({ cadence, args })\n */\nasync function query() {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  await preQuery(opts);\n  opts = await prepTemplateOpts(opts);\n  return sdk.config().overload(opts.dependencies || {}, async () =>\n  // prettier-ignore\n  sdk.send([sdk.script(opts.cadence), sdk.args(normalizeArgs(opts.args || [])), opts.limit && typeof opts.limit === \"number\" && sdk.limit(opts.limit)]).then(sdk.decode));\n}\nasync function fetchServices(servicesURL, code) {\n  if (servicesURL == null || code == null) return [];\n  const url = new URL(servicesURL);\n  url.searchParams.append(\"code\", code);\n  const resp = await fetch(url, {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  }).then(d => d.json());\n  if (Array.isArray(resp)) return resp;\n\n  // Backwards compatibility for First-Gen Wallet Providers\n  const services = [];\n\n  // Convert authorizations into authz services\n  if (Array.isArray(resp.authorizations)) {\n    for (let service of resp.authorizations) {\n      services.push({\n        type: \"authz\",\n        keyId: resp.keyId,\n        ...service\n      });\n    }\n  }\n\n  // Convert Provider info into an authn service\n  if (resp.provider != null) {\n    services.push({\n      type: \"authn\",\n      id: \"wallet-provider#authn\",\n      ...resp.provider\n    });\n  }\n  return services;\n}\nfunction mergeServices() {\n  let sx1 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  let sx2 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  // TODO: Make this smarter\n  return [...sx1, ...sx2];\n}\nconst SERVICE_PRAGMA = {\n  f_type: \"Service\",\n  f_vsn: \"1.0.0\"\n};\nconst IDENTITY_PRAGMA = {\n  f_type: \"Identity\",\n  f_vsn: \"1.0.0\"\n};\nconst USER_PRAGMA = {\n  f_type: \"USER\",\n  f_vsn: \"1.0.0\"\n};\nconst POLLING_RESPONSE_PRAGMA = {\n  f_type: \"PollingResponse\",\n  f_vsn: \"1.0.0\"\n};\nconst COMPOSITE_SIGNATURE_PRAGMA = {\n  f_type: \"CompositeSignature\",\n  f_vsn: \"1.0.0\"\n};\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"identity\": {\n//     \"address\": \"0x____\"\n//   },\n//   \"provider\": {\n//     \"address\": \"0x____\",\n//     \"name\": \"Best Wallet\",\n//     \"description\": \"The Best Wallet\"\n//     \"icon\": \"https://\",\n//   }\n// }\nfunction normalizeAuthn(service) {\n  if (service == null) return null;\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.authn,\n        id: service.pid,\n        provider: {\n          address: withPrefix(service.addr),\n          name: service.name,\n          icon: service.icon\n        }\n      };\n  }\n}\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nfunction normalizeAuthz(service) {\n  if (service == null) return null;\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId\n        },\n        params: service.params,\n        data: service.data\n      };\n  }\n}\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"pre-authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of pre-authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nfunction normalizePreAuthz(service) {\n  if (service == null) return null;\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId\n        },\n        params: service.params,\n        data: service.data\n      };\n  }\n}\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"frame\",\n//    \"endpoint\": \"https://rawr\",\n//    \"data\": {},   // Sent to frame when ready\n//    \"params\": {}, // include in query params on frame\n// }\nfunction normalizeFrame(service) {\n  if (service == null) return null;\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return {\n        old: service,\n        ...SERVICE_PRAGMA,\n        type: \"frame\",\n        endpoint: service.endpoint,\n        params: service.params || {},\n        data: service.data || {}\n      };\n  }\n}\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"back-channel-rpc\",\n//    \"endpoint\": \"https://rawr\",\n//    \"method\": \"HTTP/GET\", // HTTP/GET | HTTP/POST\n//    \"data\": {},           // included in body of rpc\n//    \"params\": {},         // included as query params on endpoint url\n// }\nfunction normalizeBackChannelRpc(service) {\n  if (service == null) return null;\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: \"back-channel-rpc\",\n        endpoint: service.endpoint,\n        method: service.method,\n        params: service.params || {},\n        data: service.data || {}\n      };\n  }\n}\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"open-id\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"method: \"data\",\n//   \"data\": {\n//      \"profile\": {\n//        \"name\": \"Bob\",\n//        \"family_name\": \"Builder\",\n//        \"given_name\": \"Robert\",\n//        \"middle_name\": \"the\",\n//        \"nickname\": \"Bob the Builder\",\n//        \"perferred_username\": \"bob\",\n//        \"profile\": \"https://www.bobthebuilder.com/\",\n//        \"picture\": \"https://avatars.onflow.org/avatar/bob\",\n//        \"gender\": \"...\",\n//        \"birthday\": \"2001-01-18\",\n//        \"zoneinfo\": \"America/Vancouver\",\n//        \"locale\": \"en-us\",\n//        \"updated_at\": \"1614970797388\"\n//      },\n//      \"email\": {\n//        \"email\": \"bob@bob.bob\",\n//        \"email_verified\": true\n//      },\n//      \"address\": {\n//        \"address\": \"One Apple Park Way, Cupertino, CA 95014, USA\"\n//      },\n//      \"phone\": {\n//        \"phone_number\": \"+1 (xxx) yyy-zzzz\",\n//        \"phone_number_verified\": true\n//      },\n//      \"social\": {\n//        \"twitter\": \"@_qvvg\",\n//        \"twitter_verified\": true\n//      },\n//   }\n// }\nfunction normalizeOpenId(service) {\n  if (service == null) return null;\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      return null;\n  }\n}\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"user-signature\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"IFRAME/RPC\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of user-signature request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nfunction normalizeUserSignature(service) {\n  if (service == null) return null;\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      throw new Error(\"Invalid user-signature service\");\n  }\n}\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    type: \"local-view\",\n//    method: \"VIEW/IFRAME\",\n//    endpoint: \"https://woot.org/authz/local\",\n//    data: {},\n//    params: {},\n// }\nfunction normalizeLocalView(resp) {\n  if (resp == null) return null;\n  if (resp.method == null) {\n    resp = {\n      ...resp,\n      type: \"local-view\",\n      method: \"VIEW/IFRAME\"\n    };\n  }\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp;\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: resp.type || \"local-view\",\n        method: resp.method,\n        endpoint: resp.endpoint,\n        data: resp.data || {},\n        params: resp.params || {}\n      };\n  }\n}\n\n// {\n//   \"f_type\": \"Service\",                    // Its a service!\n//   \"f_vsn\": \"1.0.0\",                       // Follows the v1.0.0 spec for the service\n//   \"type\": \"account-proof\",                // the type of service it is\n//   \"method\": \"DATA\",                       // Its data!\n//   \"uid\": \"awesome-wallet#account-proof\",  // A unique identifier for the service\n//   \"data\": {\n//     \"f_type\": \"account-proof\",\n//     \"f_vsn\": \"1.0.0\",\n//     \"nonce\": \"0A1BC2FF\",                  // Nonce signed by the current account-proof (minimum 32 bytes in total, i.e 64 hex characters)\n//     \"address\": \"0xUSER\",                  // The user's address (8 bytes, i.e 16 hex characters)\n//     \"signature\": CompositeSignature,      // address (sans-prefix), keyId, signature (hex)\n// }\n\nfunction normalizeAccountProof(service) {\n  if (service == null) return null;\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      throw new Error(`FCL Normalizer Error: Invalid account-proof service`);\n  }\n}\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn-refresh\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\",  // \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nfunction normalizeAuthnRefresh(service) {\n  if (service == null) return null;\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service;\n    default:\n      throw new Error(\"Invalid authn-refresh service\");\n  }\n}\nconst serviceNormalizers = {\n  \"back-channel-rpc\": normalizeBackChannelRpc,\n  \"pre-authz\": normalizePreAuthz,\n  authz: normalizeAuthz,\n  authn: normalizeAuthn,\n  frame: normalizeFrame,\n  \"open-id\": normalizeOpenId,\n  \"user-signature\": normalizeUserSignature,\n  \"local-view\": normalizeLocalView,\n  \"account-proof\": normalizeAccountProof,\n  \"authn-refresh\": normalizeAuthnRefresh\n};\nfunction normalizeService(service, data) {\n  try {\n    var normalized = serviceNormalizers[service.type](service, data);\n    return normalized;\n  } catch (error) {\n    console.error(`Unrecognized FCL Service Type [${service.type}]`, service, error);\n    return service;\n  }\n}\nfunction deriveCompositeId(authn) {\n  return rlp.encode([authn.provider.address || authn.provider.name || \"UNSPECIFIED\", authn.id]).toString(\"hex\");\n}\nfunction normalizeData(data) {\n  data.addr = data.addr ? withPrefix(data.addr) : null;\n  data.paddr = data.paddr ? withPrefix(data.paddr) : null;\n  return data;\n}\nfunction findService(type, services) {\n  return services.find(d => d.type === type);\n}\nasync function buildUser(data) {\n  data = normalizeData(data);\n  var services = mergeServices(data.services || [], await fetchServices(data.hks, data.code)).map(service => normalizeService(service, data));\n  const authn = findService(\"authn\", services);\n  return {\n    ...USER_PRAGMA,\n    addr: withPrefix(data.addr),\n    cid: deriveCompositeId(authn),\n    loggedIn: true,\n    services: services,\n    expiresAt: data.expires\n  };\n}\nfunction serviceOfType() {\n  let services = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  let type = arguments.length > 1 ? arguments[1] : undefined;\n  return services.find(service => service.type === type);\n}\nfunction serviceEndpoint(service) {\n  const url = new URL(service.endpoint);\n  if (window?.location?.origin) {\n    url.searchParams.append(\"l6n\", window.location.origin);\n  }\n  if (service.params != null) {\n    for (let [key, value] of Object.entries(service.params || {})) {\n      url.searchParams.append(key, value);\n    }\n  }\n  return url;\n}\nfunction fetchService(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const method = opts.method || \"POST\";\n  const body = method === \"GET\" ? undefined : JSON.stringify(opts.data || service.data || {});\n  return fetch(serviceEndpoint(service), {\n    method: method,\n    headers: {\n      ...(service.headers || {}),\n      ...(opts.headers || {}),\n      \"Content-Type\": \"application/json\"\n    },\n    body: body\n  }).then(d => d.json());\n}\n\n// {\n//    \"f_type\": \"PollingResponse\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"status\": \"PENDING\", // PENDING | APPROVED | DECLINED | REDIRECT\n//    \"reason\": null,      // Reason for Declining Transaction\n//    \"data\": null,        // Return value for APPROVED\n//    \"updates\": BackChannelRpc,\n//    \"local\": Frame,\n// }\nfunction normalizePollingResponse(resp) {\n  if (resp == null) return null;\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp;\n    default:\n      return {\n        ...POLLING_RESPONSE_PRAGMA,\n        status: resp.status ?? \"APPROVED\",\n        reason: resp.reason ?? null,\n        data: resp.compositeSignature || resp.data || {\n          ...resp\n        } || {},\n        updates: normalizeBackChannelRpc(resp.authorizationUpdates),\n        local: normalizeFrame((resp.local || [])[0])\n      };\n  }\n}\nconst OPTIONS = {\n  \"HTTP/GET\": \"GET\",\n  \"HTTP/POST\": \"POST\"\n};\nconst serviceMethod = service => {\n  invariant(OPTIONS[service.method], \"Invalid Service Method for type back-channel-rpc\", {\n    service\n  });\n  return OPTIONS[service.method];\n};\nasync function poll(service) {\n  let canContinue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => true;\n  invariant(service, \"Missing Polling Service\", {\n    service\n  });\n  if (!canContinue()) throw new Error(\"Externally Halted\");\n  let resp;\n  try {\n    if (typeof document !== \"undefined\" && document.visibilityState === \"hidden\") {\n      await new Promise(r => setTimeout(r, 500));\n      return poll(service, canContinue);\n    }\n    resp = await fetchService(service, {\n      method: serviceMethod(service)\n    }).then(normalizePollingResponse);\n  } catch (error) {\n    throw error;\n  }\n  switch (resp.status) {\n    case \"APPROVED\":\n      return resp.data;\n    case \"DECLINED\":\n      throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`);\n    default:\n      await new Promise(r => setTimeout(r, 500));\n      return poll(resp.updates, canContinue);\n  }\n}\nconst FRAME = \"FCL_IFRAME\";\nconst FRAME_STYLES = `\n  position:fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  height: 100%;\n  width: 100vw;\n  display:block;\n  background:rgba(0,0,0,0.25);\n  z-index: 2147483647;\n  box-sizing: border-box;\n  color-scheme: light;\n`;\nfunction renderFrame(src) {\n  invariant(!document.getElementById(FRAME), \"Attempt at triggering multiple Frames\", {\n    src\n  });\n  const $frame = document.createElement(\"iframe\");\n  $frame.src = src;\n  $frame.id = FRAME;\n  $frame.allow = \"usb *; hid *\";\n  $frame.frameBorder = \"0\";\n  $frame.style.cssText = FRAME_STYLES;\n  document.body.append($frame);\n  const unmount = () => {\n    if (document.getElementById(FRAME)) {\n      document.getElementById(FRAME).remove();\n    }\n  };\n  return [$frame.contentWindow, unmount];\n}\nconst POP = \"FCL_POP\";\nlet popup = null;\nlet previousUrl$1 = null;\nfunction popupWindow(url, windowName, win, w, h) {\n  const y = win.top.outerHeight / 2 + win.top.screenY - h / 2;\n  const x = win.top.outerWidth / 2 + win.top.screenX - w / 2;\n  const popup = win.open(url, windowName, `toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${w}, height=${h}, top=${y}, left=${x}`);\n  if (!popup) throw new Error(\"Popup failed to open (was it blocked by a popup blocker?)\");\n  return popup;\n}\nfunction renderPop(src) {\n  if (popup == null || popup?.closed) {\n    popup = popupWindow(src, POP, window, 640, 770);\n  } else if (previousUrl$1 !== src) {\n    popup.location.replace(src);\n    popup.focus();\n  } else {\n    popup.focus();\n  }\n  previousUrl$1 = src;\n  const unmount = () => {\n    if (popup && !popup.closed) {\n      popup.close();\n    }\n    popup = null;\n  };\n  return [popup, unmount];\n}\nlet tab$1 = null;\nlet previousUrl = null;\nfunction renderTab(src) {\n  if (tab$1 == null || tab$1?.closed) {\n    tab$1 = window.open(src, \"_blank\");\n    if (!tab$1) throw new Error(\"Tab failed to open (was it blocked by the browser?)\");\n  } else if (previousUrl !== src) {\n    tab$1.location.replace(src);\n    tab$1.focus();\n  } else {\n    tab$1.focus();\n  }\n  previousUrl = src;\n  const unmount = () => {\n    if (tab$1 && !tab$1.closed) {\n      tab$1.close();\n    }\n    tab$1 = null;\n  };\n  return [tab$1, unmount];\n}\nconst VIEWS = {\n  \"VIEW/IFRAME\": renderFrame,\n  \"VIEW/POP\": renderPop,\n  \"VIEW/TAB\": renderTab\n};\nasync function execLocal(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  try {\n    return VIEWS[service.method](serviceEndpoint(service), opts);\n  } catch (error) {\n    console.error(\"execLocal({service, opts = {}})\", error, {\n      service,\n      opts\n    });\n    throw error;\n  }\n}\nasync function execHttpPost(_ref) {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  const resp = await fetchService(service, {\n    data: {\n      fclVersion: VERSION,\n      service: {\n        params: service.params,\n        data: service.data,\n        type: service.type\n      },\n      config,\n      ...body\n    }\n  }).then(normalizePollingResponse);\n  if (resp.status === \"APPROVED\") {\n    return resp.data;\n  } else if (resp.status === \"DECLINED\") {\n    throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`);\n  } else if (resp.status === \"REDIRECT\") {\n    return resp;\n  } else if (resp.status === \"PENDING\") {\n    var canContinue = true;\n    const [_, unmount] = await execLocal(normalizeLocalView(resp.local));\n    const close = () => {\n      try {\n        unmount();\n        canContinue = false;\n      } catch (error) {\n        console.error(\"Frame Close Error\", error);\n      }\n    };\n    return poll(resp.updates, () => canContinue).then(serviceResponse => {\n      close();\n      return serviceResponse;\n    }).catch(error => {\n      console.error(error);\n      close();\n      throw error;\n    });\n  } else {\n    console.error(`Auto Decline: Invalid Response`, {\n      service,\n      resp\n    });\n    throw new Error(`Auto Decline: Invalid Response`);\n  }\n}\nconst CLOSE_EVENT = \"FCL:VIEW:CLOSE\";\nconst READY_EVENT = \"FCL:VIEW:READY\";\nconst RESPONSE_EVENT = \"FCL:VIEW:RESPONSE\";\nconst _ = e => typeof e === \"string\" && e.toLowerCase();\nconst IGNORE = new Set([\"monetizationstart\", \"monetizationpending\", \"monetizationprogress\", \"monetizationstop\"]);\nconst deprecate = (was, want) => console.warn(\"DEPRECATION NOTICE\", `Received ${was}, please use ${want} for this and future versions of FCL`);\nconst buildMessageHandler = _ref => {\n  let {\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage\n  } = _ref;\n  return e => {\n    try {\n      if (typeof e.data !== \"object\") return;\n      if (IGNORE.has(e.data.type)) return;\n      if (_(e.data.type) === _(CLOSE_EVENT)) close();\n      if (_(e.data.type) === _(READY_EVENT)) onReady(e, {\n        send,\n        close\n      });\n      if (_(e.data.type) === _(RESPONSE_EVENT)) onResponse(e, {\n        send,\n        close\n      });\n      onMessage(e, {\n        send,\n        close\n      });\n\n      // Backwards Compatible\n      if (_(e.data.type) === _(\"FCL:FRAME:READY\")) {\n        deprecate(e.data.type, READY_EVENT);\n        onReady(e, {\n          send,\n          close\n        });\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT);\n        onResponse(e, {\n          send,\n          close\n        });\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:CLOSE\")) {\n        deprecate(e.data.type, CLOSE_EVENT);\n        close();\n      }\n      //\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT);\n        onResponse(e, {\n          send,\n          close\n        });\n      }\n      if (_(e.data.type) === _(\"FCL::AUTHZ_READY\")) {\n        deprecate(e.data.type, READY_EVENT);\n        onReady(e, {\n          send,\n          close\n        });\n      }\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT);\n        close();\n      }\n      if (_(e.data.type) === _(\"FCL::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT);\n        close();\n      }\n    } catch (error) {\n      console.error(\"Frame Callback Error\", error);\n      close();\n    }\n  };\n};\nconst noop$3 = () => {};\nfunction frame(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (service == null) return {\n    send: noop$3,\n    close: noop$3\n  };\n  const onClose = opts.onClose || noop$3;\n  const onMessage = opts.onMessage || noop$3;\n  const onReady = opts.onReady || noop$3;\n  const onResponse = opts.onResponse || noop$3;\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage\n  });\n  window.addEventListener(\"message\", handler);\n  const [$frame, unmount] = renderFrame(serviceEndpoint(service));\n  return {\n    send,\n    close\n  };\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler);\n      unmount();\n      onClose();\n    } catch (error) {\n      console.error(\"Frame Close Error\", error);\n    }\n  }\n  function send(msg) {\n    try {\n      $frame.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\");\n    } catch (error) {\n      console.error(\"Frame Send Error\", msg, error);\n    }\n  }\n}\nfunction execIframeRPC(_ref) {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  return new Promise((resolve, reject) => {\n    const id = uid();\n    const includeOlderJsonRpcCall = opts.includeOlderJsonRpcCall;\n    frame(service, {\n      async onReady(_, _ref2) {\n        let {\n          send\n        } = _ref2;\n        try {\n          send({\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            fclVersion: VERSION,\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config\n          });\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config,\n            deprecated: {\n              message: \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\"\n            }\n          });\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n              deprecated: {\n                message: \"jsonrpc is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\"\n              }\n            });\n          }\n        } catch (error) {\n          throw error;\n        }\n      },\n      onResponse(e, _ref3) {\n        let {\n          close\n        } = _ref3;\n        try {\n          if (typeof e.data !== \"object\") return;\n          const resp = normalizePollingResponse(e.data);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              close();\n              break;\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`);\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(`Declined: No reason supplied`);\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onResponse error\", error);\n          throw error;\n        }\n      },\n      onMessage(e, _ref4) {\n        let {\n          close\n        } = _ref4;\n        try {\n          if (typeof e.data !== \"object\") return;\n          if (e.data.jsonrpc !== \"2.0\") return;\n          if (e.data.id !== id) return;\n          const resp = normalizePollingResponse(e.data.result);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              close();\n              break;\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`);\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(`Declined: No reason supplied`);\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onMessage error\", error);\n          throw error;\n        }\n      },\n      onClose() {\n        reject(`Declined: Externally Halted`);\n      }\n    });\n  });\n}\nconst noop$2 = () => {};\nfunction pop(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (service == null) return {\n    send: noop$2,\n    close: noop$2\n  };\n  const onClose = opts.onClose || noop$2;\n  const onMessage = opts.onMessage || noop$2;\n  const onReady = opts.onReady || noop$2;\n  const onResponse = opts.onResponse || noop$2;\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage\n  });\n  window.addEventListener(\"message\", handler);\n  const [$pop, unmount] = renderPop(serviceEndpoint(service));\n  const timer = setInterval(function () {\n    if ($pop && $pop.closed) {\n      close();\n    }\n  }, 500);\n  return {\n    send,\n    close\n  };\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler);\n      clearInterval(timer);\n      unmount();\n      onClose();\n    } catch (error) {\n      console.error(\"Popup Close Error\", error);\n    }\n  }\n  function send(msg) {\n    try {\n      $pop.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\");\n    } catch (error) {\n      console.error(\"Popup Send Error\", msg, error);\n    }\n  }\n}\nfunction execPopRPC(_ref) {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  return new Promise((resolve, reject) => {\n    const id = uid();\n    const {\n      redir,\n      includeOlderJsonRpcCall\n    } = opts;\n    pop(service, {\n      async onReady(_, _ref2) {\n        let {\n          send\n        } = _ref2;\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config\n          });\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config,\n            deprecated: {\n              message: \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\"\n            }\n          });\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params]\n            });\n          }\n        } catch (error) {\n          throw error;\n        }\n      },\n      onResponse(e, _ref3) {\n        let {\n          close\n        } = _ref3;\n        try {\n          if (typeof e.data !== \"object\") return;\n          const resp = normalizePollingResponse(e.data);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              !redir && close();\n              break;\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`);\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(`Declined: No reason supplied`);\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error);\n          throw error;\n        }\n      },\n      onMessage(e, _ref4) {\n        let {\n          close\n        } = _ref4;\n        try {\n          if (typeof e.data !== \"object\") return;\n          if (e.data.jsonrpc !== \"2.0\") return;\n          if (e.data.id !== id) return;\n          const resp = normalizePollingResponse(e.data.result);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              !redir && close();\n              break;\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`);\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(`Declined: No reason supplied`);\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error);\n          throw error;\n        }\n      },\n      onClose() {\n        reject(`Declined: Externally Halted`);\n      }\n    });\n  });\n}\nconst noop$1 = () => {};\nfunction tab(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (service == null) return {\n    send: noop$1,\n    close: noop$1\n  };\n  const onClose = opts.onClose || noop$1;\n  const onMessage = opts.onMessage || noop$1;\n  const onReady = opts.onReady || noop$1;\n  const onResponse = opts.onResponse || noop$1;\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage\n  });\n  window.addEventListener(\"message\", handler);\n  const [$tab, unmount] = renderTab(serviceEndpoint(service));\n  const timer = setInterval(function () {\n    if ($tab && $tab.closed) {\n      close();\n    }\n  }, 500);\n  return {\n    send,\n    close\n  };\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler);\n      clearInterval(timer);\n      unmount();\n      onClose();\n    } catch (error) {\n      console.error(\"Tab Close Error\", error);\n    }\n  }\n  function send(msg) {\n    try {\n      $tab.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\");\n    } catch (error) {\n      console.error(\"Tab Send Error\", msg, error);\n    }\n  }\n}\nfunction execTabRPC(_ref) {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  return new Promise((resolve, reject) => {\n    const id = uid();\n    const {\n      redir,\n      includeOlderJsonRpcCall\n    } = opts;\n    tab(service, {\n      async onReady(_, _ref2) {\n        let {\n          send\n        } = _ref2;\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config\n          });\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config,\n            deprecated: {\n              message: \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\"\n            }\n          });\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params]\n            });\n          }\n        } catch (error) {\n          throw error;\n        }\n      },\n      onResponse(e, _ref3) {\n        let {\n          close\n        } = _ref3;\n        try {\n          if (typeof e.data !== \"object\") return;\n          const resp = normalizePollingResponse(e.data);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              !redir && close();\n              break;\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`);\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(`Declined: No reason supplied`);\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error);\n          throw error;\n        }\n      },\n      onMessage(e, _ref4) {\n        let {\n          close\n        } = _ref4;\n        try {\n          if (typeof e.data !== \"object\") return;\n          if (e.data.jsonrpc !== \"2.0\") return;\n          if (e.data.id !== id) return;\n          const resp = normalizePollingResponse(e.data.result);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              !redir && close();\n              break;\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`);\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(`Declined: No reason supplied`);\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error);\n          throw error;\n        }\n      },\n      onClose() {\n        reject(`Declined: Externally Halted`);\n      }\n    });\n  });\n}\nconst noop = () => {};\nfunction extension(service) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (service == null) return {\n    send: noop,\n    close: noop\n  };\n  const onClose = opts.onClose || noop;\n  const onMessage = opts.onMessage || noop;\n  const onReady = opts.onReady || noop;\n  const onResponse = opts.onResponse || noop;\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage\n  });\n  window.addEventListener(\"message\", handler);\n  send({\n    service\n  });\n  return {\n    send,\n    close\n  };\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler);\n      onClose();\n    } catch (error) {\n      console.error(\"Ext Close Error\", error);\n    }\n  }\n  function send(msg) {\n    try {\n      window && window.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\");\n    } catch (error) {\n      console.error(\"Ext Send Error\", msg, error);\n    }\n  }\n}\nfunction execExtRPC(_ref) {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  return new Promise((resolve, reject) => {\n    extension(service, {\n      async onReady(_, _ref2) {\n        let {\n          send\n        } = _ref2;\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type\n            },\n            config\n          });\n        } catch (error) {\n          throw error;\n        }\n      },\n      onResponse(e, _ref3) {\n        let {\n          close\n        } = _ref3;\n        try {\n          if (typeof e.data !== \"object\") return;\n          const resp = normalizePollingResponse(e.data);\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data);\n              close();\n              break;\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`);\n              close();\n              break;\n            case \"REDIRECT\":\n              resolve(resp);\n              close();\n              break;\n            default:\n              reject(`Declined: No reason supplied`);\n              close();\n              break;\n          }\n        } catch (error) {\n          console.error(\"execExtRPC onResponse error\", error);\n          throw error;\n        }\n      },\n      onClose() {\n        reject(`Declined: Externally Halted`);\n      }\n    });\n  });\n}\nconst CORE_STRATEGIES = {\n  \"HTTP/RPC\": execHttpPost,\n  \"HTTP/POST\": execHttpPost,\n  \"IFRAME/RPC\": execIframeRPC,\n  \"POP/RPC\": execPopRPC,\n  \"TAB/RPC\": execTabRPC,\n  \"EXT/RPC\": execExtRPC\n};\nconst supportedPlugins = [\"ServicePlugin\"];\nconst supportedServicePlugins = [\"discovery-service\"];\nconst validateDiscoveryPlugin = servicePlugin => {\n  const {\n    services,\n    serviceStrategy\n  } = servicePlugin;\n  invariant(Array.isArray(services) && services.length, \"Array of Discovery Services is required\");\n  for (const ds of services) {\n    invariant(isRequired(ds.f_type) && ds.f_type === \"Service\", \"Service is required\");\n    invariant(isRequired(ds.type) && ds.type === \"authn\", `Service must be type authn. Received ${ds.type}`);\n    invariant(ds.method in CORE_STRATEGIES || serviceStrategy.method === ds.method, `Service method ${ds.method} is not supported`);\n  }\n  invariant(isRequired(serviceStrategy), \"Service strategy is required\");\n  invariant(isRequired(serviceStrategy.method) && isString(serviceStrategy.method), \"Service strategy method is required\");\n  invariant(isRequired(serviceStrategy.exec) && isFunc(serviceStrategy.exec), \"Service strategy exec function is required\");\n  return {\n    discoveryServices: services,\n    serviceStrategy\n  };\n};\nconst ServiceRegistry = () => {\n  let services = new Set();\n  let strategies = new Map(Object.entries(CORE_STRATEGIES));\n  const add = servicePlugin => {\n    invariant(supportedServicePlugins.includes(servicePlugin.type), `Service Plugin type ${servicePlugin.type} is not supported`);\n    if (servicePlugin.type === \"discovery-service\") {\n      const {\n        discoveryServices,\n        serviceStrategy\n      } = validateDiscoveryPlugin(servicePlugin);\n      setServices(discoveryServices);\n      if (!strategies.has(serviceStrategy.method)) {\n        strategies.set(serviceStrategy.method, serviceStrategy.exec);\n      } else {\n        log({\n          title: `Add Service Plugin`,\n          message: `Service strategy for ${serviceStrategy.method} already exists`,\n          level: LEVELS.warn\n        });\n      }\n    }\n  };\n  const setServices = discoveryServices => services = new Set([...discoveryServices]);\n  const getServices = () => [...services];\n  const getStrategy = method => strategies.get(method);\n  const getStrategies = () => [...strategies.keys()];\n  return Object.freeze({\n    add,\n    getServices,\n    getStrategy,\n    getStrategies\n  });\n};\nconst validatePlugins = plugins => {\n  let pluginsArray;\n  invariant(plugins, \"No plugins supplied\");\n  if (!Array.isArray(plugins)) {\n    pluginsArray = [plugins];\n  } else {\n    pluginsArray = [...plugins];\n  }\n  for (const p of pluginsArray) {\n    invariant(isRequired(p.name), \"Plugin name is required\");\n    invariant(isRequired(p.f_type), \"Plugin f_type is required\");\n    invariant(supportedPlugins.includes(p.f_type), `Plugin type ${p.f_type} is not supported`);\n  }\n  return pluginsArray;\n};\nconst PluginRegistry = () => {\n  const pluginsMap = new Map();\n  const getPlugins = () => pluginsMap;\n  const add = plugins => {\n    const pluginsArray = validatePlugins(plugins);\n    for (const p of pluginsArray) {\n      pluginsMap.set(p.name, p);\n      if (p.f_type === \"ServicePlugin\") {\n        serviceRegistry.add(p);\n      }\n    }\n  };\n  return Object.freeze({\n    add,\n    getPlugins\n  });\n};\nconst serviceRegistry = ServiceRegistry();\nconst pluginRegistry = PluginRegistry();\nconst execStrategy = async _ref => {\n  let {\n    service,\n    body,\n    config,\n    opts\n  } = _ref;\n  const strategy = serviceRegistry.getStrategy(service.method);\n  return strategy({\n    service,\n    body,\n    config,\n    opts\n  });\n};\nasync function execService(_ref2) {\n  let {\n    service,\n    msg = {},\n    config = {},\n    opts = {}\n  } = _ref2;\n  msg.data = service.data;\n  const execConfig = {\n    services: await configLens(/^service\\./),\n    app: await configLens(/^app\\.detail\\./),\n    client: {\n      ...config.client,\n      fclVersion: VERSION,\n      fclLibrary: \"https://github.com/onflow/fcl-js\",\n      hostname: window?.location?.hostname ?? null,\n      network: await getChainId()\n    }\n  };\n  try {\n    const res = await execStrategy({\n      service,\n      body: msg,\n      config: execConfig,\n      opts\n    });\n    if (res.status === \"REDIRECT\") {\n      invariant(service.type === res.data.type, \"Cannot shift recursive service type in execService\");\n      return await execService({\n        service: res.data,\n        msg,\n        config: execConfig,\n        opts\n      });\n    } else {\n      return res;\n    }\n  } catch (error) {\n    log({\n      title: `Error on execService ${service?.type}`,\n      message: error,\n      level: LEVELS.error\n    });\n    throw error;\n  }\n}\n\n// {\n//    \"f_type\": \"CompositeSignature\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"addr\": \"_____\",         // sans-prefix\n//    \"signature\": \"adfe1234\", // hex\n//    \"keyId\": 3,\n// }\nfunction normalizeCompositeSignature(resp) {\n  if (resp == null) return null;\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp;\n    default:\n      return {\n        ...COMPOSITE_SIGNATURE_PRAGMA,\n        addr: sansPrefix(resp.addr || resp.address),\n        signature: resp.signature || resp.sig,\n        keyId: resp.keyId\n      };\n  }\n}\nconst makeDiscoveryServices = async () => {\n  const extensionServices = window?.fcl_extensions || [];\n  return [...extensionServices, ...serviceRegistry.getServices()];\n};\nasync function getDiscoveryService(service) {\n  const discoveryAuthnInclude = await config.get(\"discovery.authn.include\", []);\n  const discoveryWalletMethod = await config.first([\"discovery.wallet.method\", \"discovery.wallet.method.default\"]);\n  const method = service?.method ? service.method : discoveryWalletMethod;\n  const endpoint = service?.endpoint ?? (await config.first([\"discovery.wallet\", \"challenge.handshake\"]));\n  invariant(endpoint, `\n    If no service is passed to \"authenticate,\" then \"discovery.wallet\" must be defined in fcl config.\n    See: \"https://docs.onflow.org/fcl/reference/api/#setting-configuration-values\"\n    `);\n  return {\n    ...service,\n    type: \"authn\",\n    endpoint,\n    method,\n    discoveryAuthnInclude\n  };\n}\nasync function getServices(_ref) {\n  let {\n    types\n  } = _ref;\n  const endpoint = await config.get(\"discovery.authn.endpoint\");\n  invariant(Boolean(endpoint), `\"discovery.authn.endpoint\" in config must be defined.`);\n  const include = await config.get(\"discovery.authn.include\", []);\n  const url = new URL(endpoint);\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      type: types,\n      fclVersion: VERSION,\n      include,\n      clientServices: await makeDiscoveryServices(),\n      supportedStrategies: serviceRegistry.getStrategies(),\n      userAgent: window?.navigator?.userAgent,\n      network: await getChainId()\n    })\n  }).then(d => d.json());\n}\nconst SERVICE_ACTOR_KEYS = {\n  AUTHN: \"authn\",\n  RESULTS: \"results\",\n  SNAPSHOT: \"SNAPSHOT\",\n  UPDATED: \"UPDATED\",\n  UPDATE_RESULTS: \"UPDATE_RESULTS\"\n};\nconst warn = (fact, msg) => {\n  if (fact) {\n    console.warn(`\n      %cFCL Warning\n      ============================\n      ${msg}\n      For more info, please see the docs: https://docs.onflow.org/fcl/\n      ============================\n      `, \"font-weight:bold;font-family:monospace;\");\n  }\n};\nconst fetchServicesFromDiscovery = async () => {\n  try {\n    const services = await getServices({\n      types: [SERVICE_ACTOR_KEYS.AUTHN]\n    });\n    send(SERVICE_ACTOR_KEYS.AUTHN, SERVICE_ACTOR_KEYS.UPDATE_RESULTS, {\n      results: services\n    });\n  } catch (error) {\n    log({\n      title: `${error.name} Error fetching Discovery API services.`,\n      message: error.message,\n      level: LEVELS.error\n    });\n  }\n};\nconst HANDLERS$3 = {\n  [INIT]: async ctx => {\n    warn(typeof window === \"undefined\", '\"fcl.discovery\" is only available in the browser.');\n    // If you call this before the window is loaded extensions will not be set yet\n    if (document.readyState === 'complete') {\n      fetchServicesFromDiscovery();\n    } else {\n      window.onload = async () => {\n        fetchServicesFromDiscovery();\n      };\n    }\n  },\n  [SERVICE_ACTOR_KEYS.UPDATE_RESULTS]: (ctx, _letter, data) => {\n    ctx.merge(data);\n    ctx.broadcast(SERVICE_ACTOR_KEYS.UPDATED, {\n      ...ctx.all()\n    });\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from);\n    ctx.send(letter.from, SERVICE_ACTOR_KEYS.UPDATED, {\n      ...ctx.all()\n    });\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => ctx.unsubscribe(letter.from),\n  [SERVICE_ACTOR_KEYS.SNAPSHOT]: async (ctx, letter) => letter.reply({\n    ...ctx.all()\n  })\n};\nconst spawnProviders = () => spawn(HANDLERS$3, SERVICE_ACTOR_KEYS.AUTHN);\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Service} Service\n */\n\n/**\n * @callback SubscriptionCallback\n * @returns {Service[]}\n */\n\n/**\n * @description\n * Discovery methods for interacting with Authn.\n * \n * @typedef {object} Authn\n * @property {Function} subscribe - Subscribe to Discovery authn services\n * @property {Function} snapshot - Get the current Discovery authn services spanshot\n * @property {Function} update - Trigger an update of authn services\n */\nconst authn = {\n  /**\n   * @description - Subscribe to Discovery authn services\n   * @param {Function} cb\n   * @returns {SubscriptionCallback}\n   */\n  subscribe: cb => subscriber(SERVICE_ACTOR_KEYS.AUTHN, spawnProviders, cb),\n  /**\n   * @description - Get the current Discovery authn services spanshot\n   * @returns {Service[]}\n   */\n  snapshot: () => snapshoter(SERVICE_ACTOR_KEYS.AUTHN, spawnProviders),\n  /**\n   * @description - Trigger an update of authn services\n   * @returns {void}\n   */\n  update: () => fetchServicesFromDiscovery()\n};\nconst discovery = {\n  authn\n};\n\n/**\n * @typedef {import(\"@onflow/typedefs\").CurrentUser} CurrentUser\n * @typedef {import(\"@onflow/typedefs\").CompositeSignature} CompositeSignature\n */\n\nconst isFn = d => typeof d === \"function\";\nconst NAME = \"CURRENT_USER\";\nconst UPDATED$1 = \"CURRENT_USER/UPDATED\";\nconst SNAPSHOT = \"SNAPSHOT\";\nconst SET_CURRENT_USER = \"SET_CURRENT_USER\";\nconst DEL_CURRENT_USER = \"DEL_CURRENT_USER\";\nconst DATA = `{\n  \"f_type\": \"User\",\n  \"f_vsn\": \"1.0.0\",\n  \"addr\":null,\n  \"cid\":null,\n  \"loggedIn\":null,\n  \"expiresAt\":null,\n  \"services\":[]\n}`;\nconst getStoredUser = async storage => {\n  const fallback = JSON.parse(DATA);\n  const stored = await storage.get(NAME);\n  if (stored != null && fallback[\"f_vsn\"] !== stored[\"f_vsn\"]) {\n    storage.removeItem(NAME);\n    return fallback;\n  }\n  return stored || fallback;\n};\nconst HANDLERS$2 = {\n  [INIT]: async ctx => {\n    if (typeof window === \"undefined\") {\n      console.warn(`\n        %cFCL Warning\n        ============================\n        \"currentUser\" is only available in the browser.\n        For more info, please see the docs: https://docs.onflow.org/fcl/\n        ============================\n        `, \"font-weight:bold;font-family:monospace;\");\n    }\n    ctx.merge(JSON.parse(DATA));\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"]);\n    if (storage.can) {\n      const user = await getStoredUser(storage);\n      if (notExpired(user)) ctx.merge(user);\n    }\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from);\n    ctx.send(letter.from, UPDATED$1, {\n      ...ctx.all()\n    });\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from);\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply({\n      ...ctx.all()\n    });\n  },\n  [SET_CURRENT_USER]: async (ctx, letter, data) => {\n    ctx.merge(data);\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"]);\n    if (storage.can) storage.put(NAME, ctx.all());\n    ctx.broadcast(UPDATED$1, {\n      ...ctx.all()\n    });\n  },\n  [DEL_CURRENT_USER]: async (ctx, letter) => {\n    ctx.merge(JSON.parse(DATA));\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"]);\n    if (storage.can) storage.put(NAME, ctx.all());\n    ctx.broadcast(UPDATED$1, {\n      ...ctx.all()\n    });\n  }\n};\nconst spawnCurrentUser = () => spawn(HANDLERS$2, NAME);\nfunction notExpired(user) {\n  return user.expiresAt == null || user.expiresAt === 0 || user.expiresAt > Date.now();\n}\nasync function getAccountProofData() {\n  let accountProofDataResolver = await config.get(\"fcl.accountProof.resolver\");\n  if (accountProofDataResolver == null) return;\n  if (!isFn(accountProofDataResolver)) {\n    log({\n      title: \"Account Proof Data Resolver must be a function\",\n      message: `Check fcl.accountProof.resolver configuration.\n                Expected: fcl.accountProof.resolver: async () => { ... }\n                Received: fcl.accountProof.resolver: ${typeof accountProofDataResolver}\n                `,\n      level: LEVELS.warn\n    });\n    return;\n  }\n  const accountProofData = await accountProofDataResolver();\n  if (accountProofData == null) return;\n  invariant(typeof accountProofData.appIdentifier === \"string\", \"appIdentifier must be a string\");\n  invariant(/^[0-9a-f]+$/i.test(accountProofData.nonce), \"Nonce must be a hex string\");\n  return accountProofData;\n}\nconst makeConfig = async _ref => {\n  let {\n    discoveryAuthnInclude\n  } = _ref;\n  return {\n    client: {\n      discoveryAuthnInclude,\n      clientServices: await makeDiscoveryServices(),\n      supportedStrategies: serviceRegistry.getStrategies()\n    }\n  };\n};\n\n/**\n * @description - Authenticate a user\n * @param {object} [opts] - Options\n * @param {object} [opts.service] - Optional service to use for authentication\n * @param {boolean} [opts.redir=false] - Optional flag to allow window to stay open after authentication\n * @returns {Promise<CurrentUser>} - User object\n */\nasync function authenticate$1() {\n  let {\n    service,\n    redir = false\n  } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  if (service && !service?.provider?.is_installed && service?.provider?.requires_install) {\n    window.location.href = service?.provider?.install_link;\n    return;\n  }\n  return new Promise(async (resolve, reject) => {\n    spawnCurrentUser();\n    const opts = {\n      redir\n    };\n    const user = await snapshot();\n    const discoveryService = await getDiscoveryService(service);\n    const refreshService = serviceOfType(user.services, \"authn-refresh\");\n    let accountProofData;\n    if (user.loggedIn) {\n      if (refreshService) {\n        try {\n          const response = await execService({\n            service: refreshService,\n            msg: accountProofData,\n            opts\n          });\n          send(NAME, SET_CURRENT_USER, await buildUser(response));\n        } catch (error) {\n          log({\n            title: `${error.name} Could not refresh wallet authentication.`,\n            message: error.message,\n            level: LEVELS.error\n          });\n        } finally {\n          return resolve(await snapshot());\n        }\n      } else {\n        return resolve(user);\n      }\n    }\n    try {\n      accountProofData = await getAccountProofData();\n    } catch (error) {\n      log({\n        title: `${error.name} On Authentication: Could not resolve account proof data.`,\n        message: error.message,\n        level: LEVELS.error\n      });\n      return reject(error);\n    }\n    try {\n      const response = await execService({\n        service: discoveryService,\n        msg: accountProofData,\n        config: await makeConfig(discoveryService),\n        opts\n      });\n      send(NAME, SET_CURRENT_USER, await buildUser(response));\n    } catch (error) {\n      log({\n        title: `${error} On Authentication`,\n        message: error,\n        level: LEVELS.error\n      });\n    } finally {\n      resolve(await snapshot());\n    }\n  });\n}\n\n/**\n * @description - Unauthenticate a user\n * @returns {void}\n */\nfunction unauthenticate$1() {\n  spawnCurrentUser();\n  send(NAME, DEL_CURRENT_USER);\n}\nconst normalizePreAuthzResponse = authz => ({\n  f_type: \"PreAuthzResponse\",\n  f_vsn: \"1.0.0\",\n  proposer: (authz || {}).proposer,\n  payer: (authz || {}).payer || [],\n  authorization: (authz || {}).authorization || []\n});\nfunction resolvePreAuthz(authz) {\n  const resp = normalizePreAuthzResponse(authz);\n  const axs = [];\n  if (resp.proposer != null) axs.push([\"PROPOSER\", resp.proposer]);\n  for (let az of resp.payer || []) axs.push([\"PAYER\", az]);\n  for (let az of resp.authorization || []) axs.push([\"AUTHORIZER\", az]);\n  var result = axs.map(_ref2 => {\n    let [role, az] = _ref2;\n    return {\n      tempId: [az.identity.address, az.identity.keyId].join(\"|\"),\n      addr: az.identity.address,\n      keyId: az.identity.keyId,\n      signingFunction(signable) {\n        return execService({\n          service: az,\n          msg: signable\n        });\n      },\n      role: {\n        proposer: role === \"PROPOSER\",\n        payer: role === \"PAYER\",\n        authorizer: role === \"AUTHORIZER\"\n      }\n    };\n  });\n  return result;\n}\n\n/**\n * @description\n * Produces the needed authorization details for the current user to submit transactions to Flow\n * It defines a signing function that connects to a user's wallet provider to produce signatures to submit transactions.\n * \n * @param {object} account - Account object\n * @returns {Promise<object>} - Account object with signing function\n */\nasync function authorization(account) {\n  spawnCurrentUser();\n  return {\n    ...account,\n    tempId: \"CURRENT_USER\",\n    async resolve(account, preSignable) {\n      const user = await authenticate$1({\n        redir: true\n      });\n      const authz = serviceOfType(user.services, \"authz\");\n      const preAuthz = serviceOfType(user.services, \"pre-authz\");\n      if (preAuthz) return resolvePreAuthz(await execService({\n        service: preAuthz,\n        msg: preSignable\n      }));\n      if (authz) {\n        let windowRef;\n        if (isMobile() && authz.method === \"WC/RPC\") {\n          windowRef = window.open(\"\", \"_blank\");\n        }\n        return {\n          ...account,\n          tempId: \"CURRENT_USER\",\n          resolve: null,\n          addr: sansPrefix(authz.identity.address),\n          keyId: authz.identity.keyId,\n          sequenceNum: null,\n          signature: null,\n          async signingFunction(signable) {\n            return normalizeCompositeSignature(await execService({\n              service: authz,\n              msg: signable,\n              opts: {\n                includeOlderJsonRpcCall: true,\n                windowRef\n              }\n            }));\n          }\n        };\n      }\n      throw new Error(\"No Authz or PreAuthz Service configured for CURRENT_USER\");\n    }\n  };\n}\n\n/**\n * @description\n * The callback passed to subscribe will be called when the user authenticates and un-authenticates, making it easy to update the UI accordingly.\n * \n * @param {Function} callback - Callback function\n * @returns {Function} - Unsubscribe function\n */\nfunction subscribe(callback) {\n  spawnCurrentUser();\n  const EXIT = \"@EXIT\";\n  const self = spawn(async ctx => {\n    ctx.send(NAME, SUBSCRIBE);\n    while (1) {\n      const letter = await ctx.receive();\n      if (letter.tag === EXIT) {\n        ctx.send(NAME, UNSUBSCRIBE);\n        return;\n      }\n      callback(letter.data);\n    }\n  });\n  return () => send(self, EXIT);\n}\n\n/**\n * @description - Gets the current user\n * @returns {Promise<CurrentUser>} - User object\n */\nfunction snapshot() {\n  spawnCurrentUser();\n  return send(NAME, SNAPSHOT, null, {\n    expectReply: true,\n    timeout: 0\n  });\n}\n\n/**\n * @description - Resolves the current user as an argument\n * @returns {Promise<Function>}\n */\nasync function resolveArgument() {\n  const {\n    addr\n  } = await authenticate$1();\n  return arg(withPrefix(addr), t$1.Address);\n}\nconst makeSignable = msg => {\n  invariant(/^[0-9a-f]+$/i.test(msg), \"Message must be a hex string\");\n  return {\n    message: msg\n  };\n};\n\n/**\n * @description - A method to use allowing the user to personally sign data via FCL Compatible Wallets/Services.\n * @param {string} msg - Message to sign\n * @returns {Promise<CompositeSignature[]>} - Array of CompositeSignatures\n */\nasync function signUserMessage(msg) {\n  spawnCurrentUser();\n  const user = await authenticate$1({\n    redir: true\n  });\n  const signingService = serviceOfType(user.services, \"user-signature\");\n  invariant(signingService, \"Current user must have authorized a signing service.\");\n  try {\n    const response = await execService({\n      service: signingService,\n      msg: makeSignable(msg)\n    });\n    if (Array.isArray(response)) {\n      return response.map(compSigs => normalizeCompositeSignature(compSigs));\n    } else {\n      return [normalizeCompositeSignature(response)];\n    }\n  } catch (error) {\n    return error;\n  }\n}\nlet currentUser = () => {\n  return {\n    authenticate: authenticate$1,\n    unauthenticate: unauthenticate$1,\n    authorization,\n    signUserMessage,\n    subscribe,\n    snapshot,\n    resolveArgument\n  };\n};\ncurrentUser.authenticate = authenticate$1;\ncurrentUser.unauthenticate = unauthenticate$1;\ncurrentUser.authorization = authorization;\ncurrentUser.signUserMessage = signUserMessage;\ncurrentUser.subscribe = subscribe;\ncurrentUser.snapshot = snapshot;\ncurrentUser.resolveArgument = resolveArgument;\n\n/**\n * @description\n * Allows you to submit transactions to the blockchain to potentially mutate the state.\n *\n *  @param {object} opts - Mutation Options and configuration\n *  @param {string} opts.cadence - Cadence Transaction used to mutate Flow\n *  @param {import(\"../fcl\").ArgsFn} [opts.args] - Arguments passed to cadence transaction\n *  @param {object} [opts.template] - Interaction Template for a transaction\n *  @param {number} [opts.limit] - Compute Limit for transaction\n *  @returns {Promise<string>} Transaction Id\n *\n * @example\n *    fcl.mutate({\n *      cadence: `\n *        transaction(a: Int, b: Int, c: Address) {\n *          prepare(acct: AuthAccount) {\n *            log(acct)\n *            log(a)\n *            log(b)\n *            log(c)\n *          }\n *        }\n *      `,\n *      args: (arg, t) => [\n *        arg(6, t.Int),\n *        arg(7, t.Int),\n *        arg(\"0xba1132bc08f82fe2\", t.Address),\n *      ],\n *    })\n *\n *\n *  Options:\n *    type Options = {\n *      template: InteractionTemplate | String // InteractionTemplate or url to one\n *      cadence: String!,\n *      args: (arg, t) => Array<Arg>,\n *      limit: Number,\n *      authz: AuthzFn, // will overload the trinity of signatory roles\n *      proposer: AuthzFn, // will overload the proposer signatory role\n *      payer: AuthzFn, // will overload the payer signatory role\n *      authorizations: [AuthzFn], // an array of authorization functions used as authorizations signatory roles\n *    }\n */\nasync function mutate() {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var txid;\n  try {\n    await preMutate(opts);\n    opts = await prepTemplateOpts(opts);\n\n    // Allow for a config to overwrite the authorization function.\n    // prettier-ignore\n    const authz = await sdk.config().get(\"fcl.authz\", currentUser().authorization);\n    txid = sdk.config().overload(opts.dependencies || {}, async () =>\n    // prettier-ignore\n    sdk.send([sdk.transaction(opts.cadence), sdk.args(normalizeArgs(opts.args || [])), opts.limit && isNumber(opts.limit) && sdk.limit(opts.limit),\n    // opts.proposer > opts.authz > authz\n    sdk.proposer(opts.proposer || opts.authz || authz),\n    // opts.payer > opts.authz > authz\n    sdk.payer(opts.payer || opts.authz || authz),\n    // opts.authorizations > [opts.authz > authz]\n    sdk.authorizations(opts.authorizations || [opts.authz || authz])]).then(sdk.decode));\n    return txid;\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * @description\n * Listens for messages from FCL\n * \n * @param {string} messageType - Message type\n * @param {Function} cb - Callback function\n * @returns {Function} - Function to remove event listener\n */\nconst onMessageFromFCL = function (messageType) {\n  let cb = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => {};\n  const buildData = data => {\n    if (data.deprecated) console.warn(\"DEPRECATION NOTICE\", data.deprecated.message);\n    delete data?.body?.interaction;\n    return data;\n  };\n  const internal = e => {\n    const {\n      data\n    } = e;\n    if (typeof data !== \"object\") return;\n    if (typeof data == null) return;\n    if (data.type !== messageType) return;\n    cb(buildData(data));\n  };\n  window.addEventListener(\"message\", internal);\n  return () => window.removeEventListener(\"message\", internal);\n};\n\n/**\n * @description\n * Sends message to FCL window\n * \n * @param {string} type - Message type\n * @param {object} msg - Message object\n * @returns {void}\n * \n * @example\n * sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n *    f_type: \"PollingResponse\",\n *    f_vsn: \"1.0.0\",\n *    status: \"APPROVED\",\n *    reason: null,\n *    data: data,\n *  })\n */\nconst sendMsgToFCL = function (type) {\n  let msg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (window.location !== window.parent.location) {\n    window.parent.postMessage({\n      ...msg,\n      type\n    }, \"*\");\n  } else if (window.opener) {\n    window.opener.postMessage({\n      ...msg,\n      type\n    }, \"*\");\n  } else {\n    throw new Error(\"Unable to communicate with parent FCL instance\");\n  }\n};\n\n/**\n * @description\n * Listens for \"FCL:VIEW:READY:RESPONSE\" and sends \"FCL:VIEW:READY\"\n * \n * @param {Function} cb - Callback function\n * @param {object} msg - Message object\n * @returns {void}\n */\nconst ready = function (cb) {\n  onMessageFromFCL(\"FCL:VIEW:READY:RESPONSE\", cb);\n  sendMsgToFCL(\"FCL:VIEW:READY\");\n};\n\n/**\n * @description\n * Sends \"FCL:VIEW:CLOSE\"\n * \n * @returns {void}\n */\nconst close = () => {\n  sendMsgToFCL(\"FCL:VIEW:CLOSE\");\n};\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"APPROVED\"\n * \n * @param {object} data - Data object\n * @returns {void}\n */\nconst approve = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"APPROVED\",\n    reason: null,\n    data: data\n  });\n};\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"DECLINED\"\n * \n * @param {string} reason - Reason for declining\n * @returns {void}\n */\nconst decline = reason => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"DECLINED\",\n    reason: reason,\n    data: null\n  });\n};\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"REDIRECT\"\n * \n * @param {object} data - Data object\n * @returns {void}\n */\nconst redirect = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"REDIRECT\",\n    reason: null,\n    data: data\n  });\n};\n\n/**\n * @description\n * Constructs a new CompositeSignature instance.\n *\n * @param {string} addr - Flow Address\n * @param {number} keyId - Key ID\n * @param {string} signature - Signature as a hex string\n */\nfunction CompositeSignature(addr, keyId, signature) {\n  this.f_type = COMPOSITE_SIGNATURE_PRAGMA.f_type;\n  this.f_vsn = COMPOSITE_SIGNATURE_PRAGMA.f_vsn;\n  this.addr = withPrefix(addr);\n  this.keyId = Number(keyId);\n  this.signature = signature;\n}\nconst rightPaddedHexBuffer = (value, pad) => Buffer.from(value.padEnd(pad * 2, \"0\"), \"hex\");\nconst leftPaddedHexBuffer = (value, pad) => Buffer.from(value.padStart(pad * 2, \"0\"), \"hex\");\nconst addressBuffer = addr => leftPaddedHexBuffer(addr, 8);\nconst nonceBuffer = nonce => Buffer.from(nonce, \"hex\");\nconst encodeAccountProof = function (_ref) {\n  let {\n    address,\n    nonce,\n    appIdentifier\n  } = _ref;\n  let includeDomainTag = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  invariant(address, \"Encode Message For Provable Authn Error: address must be defined\");\n  invariant(nonce, \"Encode Message For Provable Authn Error: nonce must be defined\");\n  invariant(appIdentifier, \"Encode Message For Provable Authn Error: appIdentifier must be defined\");\n  invariant(nonce.length >= 64, \"Encode Message For Provable Authn Error: nonce must be minimum of 32 bytes\");\n  const ACCOUNT_PROOF_DOMAIN_TAG = rightPaddedHexBuffer(Buffer.from(\"FCL-ACCOUNT-PROOF-V0.0\").toString(\"hex\"), 32);\n  if (includeDomainTag) {\n    return Buffer.concat([ACCOUNT_PROOF_DOMAIN_TAG, encode([appIdentifier, addressBuffer(sansPrefix(address)), nonceBuffer(nonce)])]).toString(\"hex\");\n  }\n  return encode([appIdentifier, addressBuffer(sansPrefix(address)), nonceBuffer(nonce)]).toString(\"hex\");\n};\nfunction injectExtService(service) {\n  if (service.type === \"authn\" && service.endpoint != null) {\n    if (!Array.isArray(window.fcl_extensions)) {\n      window.fcl_extensions = [];\n    }\n    window.fcl_extensions.push(service);\n  } else {\n    console.warn(\"Authn service is required\");\n  }\n}\nvar index$2 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  sendMsgToFCL: sendMsgToFCL,\n  ready: ready,\n  close: close,\n  approve: approve,\n  decline: decline,\n  redirect: redirect,\n  onMessageFromFCL: onMessageFromFCL,\n  encodeMessageFromSignable: encodeMessageFromSignable,\n  CompositeSignature: CompositeSignature,\n  encodeAccountProof: encodeAccountProof,\n  injectExtService: injectExtService\n});\nconst ACCOUNT_PROOF = \"ACCOUNT_PROOF\";\nconst USER_SIGNATURE = \"USER_SIGNATURE\";\nconst validateArgs = args => {\n  if (args.appIdentifier) {\n    const {\n      appIdentifier,\n      address,\n      nonce,\n      signatures\n    } = args;\n    invariant(isString(appIdentifier), \"verifyAccountProof({ appIdentifier }) -- appIdentifier must be a string\");\n    invariant(isString(address) && sansPrefix(address).length === 16, \"verifyAccountProof({ address }) -- address must be a valid address\");\n    invariant(/^[0-9a-f]+$/i.test(nonce), \"nonce must be a hex string\");\n    invariant(Array.isArray(signatures) && signatures.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"), \"Must include an Array of CompositeSignatures to verify\");\n    invariant(signatures.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]), \"User signatures to be verified must be from a single account address\");\n    return true;\n  } else {\n    const {\n      message,\n      address,\n      compSigs\n    } = args;\n    invariant(/^[0-9a-f]+$/i.test(message), \"Signed message must be a hex string\");\n    invariant(isString(address) && sansPrefix(address).length === 16, \"verifyUserSignatures({ address }) -- address must be a valid address\");\n    invariant(Array.isArray(compSigs) && compSigs.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"), \"Must include an Array of CompositeSignatures to verify\");\n    invariant(compSigs.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]), \"User signatures to be verified must be from a single account address\");\n    return true;\n  }\n};\n\n// TODO: pass in option for contract but we're connected to testnet\n// log address + network -> in sync?\nconst getVerifySignaturesScript = async (sig, opts) => {\n  const verifyFunction = sig === \"ACCOUNT_PROOF\" ? \"verifyAccountProofSignatures\" : \"verifyUserSignatures\";\n  let network = await getChainId();\n  let fclCryptoContract;\n  invariant(opts.fclCryptoContract || network === \"testnet\" || network === \"mainnet\", \"${verifyFunction}({ fclCryptoContract }) -- config.flow.network must be specified (testnet || mainnet) or contract address provided via opts.fclCryptoContract\");\n  if (opts.fclCryptoContract) {\n    fclCryptoContract = opts.fclCryptoContract;\n  } else {\n    fclCryptoContract = network === \"testnet\" ? \"0x74daa6f9c7ef24b1\" : \"0xb4b82a1c9d21d284\";\n  }\n  return `\n      import FCLCrypto from ${fclCryptoContract}\n\n      pub fun main(\n          address: Address, \n          message: String, \n          keyIndices: [Int], \n          signatures: [String]\n      ): Bool {\n        return FCLCrypto.${verifyFunction}(address: address, message: message, keyIndices: keyIndices, signatures: signatures)\n      }\n    `;\n};\n\n/**\n * @description\n * Verify a valid account proof signature or signatures for an account on Flow.\n *\n * @param {string} appIdentifier - A message string in hexadecimal format\n * @param {object} accountProofData - An object consisting of address, nonce, and signatures\n * @param {string} accountProofData.address - A Flow account address\n * @param {string} accountProofData.nonce - A random string in hexadecimal format (minimum 32 bytes in total, i.e 64 hex characters)\n * @param {object[]} accountProofData.signatures - An array of composite signatures to verify\n * @param {object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override Flow account address where the FCLCrypto contract is deployed\n * @returns {Promise<boolean>} - Returns true if the signature is valid, false otherwise\n *\n * @example\n *\n *  const accountProofData = {\n *   address: \"0x123\",\n *   nonce: \"F0123\"\n *   signatures: [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *  }\n *\n *  const isValid = await fcl.AppUtils.verifyAccountProof(\n *    \"AwesomeAppId\",\n *    accountProofData,\n *    {fclCryptoContract}\n *  )\n */\nasync function verifyAccountProof(appIdentifier, _ref) {\n  let {\n    address,\n    nonce,\n    signatures\n  } = _ref;\n  let opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  validateArgs({\n    appIdentifier,\n    address,\n    nonce,\n    signatures\n  });\n  const message = encodeAccountProof({\n    address,\n    nonce,\n    appIdentifier\n  }, false);\n  let signaturesArr = [];\n  let keyIndices = [];\n  for (const el of signatures) {\n    signaturesArr.push(el.signature);\n    keyIndices.push(el.keyId.toString());\n  }\n  return query({\n    cadence: await getVerifySignaturesScript(ACCOUNT_PROOF, opts),\n    args: (arg, t) => [arg(withPrefix(address), t.Address), arg(message, t.String), arg(keyIndices, t.Array(t.Int)), arg(signaturesArr, t.Array(t.String))]\n  });\n}\n\n/**\n * @description\n * Verify a valid signature/s for an account on Flow.\n *\n * @param {string} message - A message string in hexadecimal format\n * @param {Array} compSigs - An array of Composite Signatures\n * @param {string} compSigs[].addr - The account address\n * @param {number} compSigs[].keyId - The account keyId\n * @param {string} compSigs[].signature - The signature to verify\n * @param {object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override of Flow account address where the FCLCrypto contract is deployed\n * @returns {boolean} - Returns true if the signature is valid, false otherwise\n *\n * @example\n *\n *  const isValid = await fcl.AppUtils.verifyUserSignatures(\n *    Buffer.from('FOO').toString(\"hex\"),\n *    [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *    {fclCryptoContract}\n *  )\n */\nasync function verifyUserSignatures$1(message, compSigs) {\n  let opts = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  const address = withPrefix(compSigs[0].addr);\n  validateArgs({\n    message,\n    address,\n    compSigs\n  });\n  let signaturesArr = [];\n  let keyIndices = [];\n  for (const el of compSigs) {\n    signaturesArr.push(el.signature);\n    keyIndices.push(el.keyId.toString());\n  }\n  return query({\n    cadence: await getVerifySignaturesScript(USER_SIGNATURE, opts),\n    args: (arg, t) => [arg(address, t.Address), arg(message, t.String), arg(keyIndices, t.Array(t.Int)), arg(signaturesArr, t.Array(t.String))]\n  });\n}\nvar index$1 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  verifyAccountProof: verifyAccountProof,\n  verifyUserSignatures: verifyUserSignatures$1\n});\n\n/**\n * Verify a valid signature/s for an account on Flow.\n *\n * @deprecated since version '1.0.0-alpha.0', use AppUtils.verifyUserSignatures instead\n *\n */\nconst verifyUserSignatures = log.deprecate({\n  pkg: \"FCL\",\n  subject: \"fcl.verifyUserSignatures()\",\n  message: \"Please use fcl.AppUtils.verifyUserSignatures()\",\n  callback: function verifyUserSignatures(message, compSigs) {\n    return verifyUserSignatures$1(message, compSigs);\n  }\n});\nconst serialize = async function () {\n  let args = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const resolveFunction = await config$1.first([\"sdk.resolve\"], opts.resolve || resolve);\n  if (Array.isArray(args)) args = await pipe(interaction(), args);\n  return JSON.stringify(createSignableVoucher(await resolveFunction(args)), null, 2);\n};\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Transaction} Transaction\n */\n\n/**\n * @typedef {import(\"@onflow/typedefs\").TransactionStatus} TransactionStatus\n */\n\nconst RATE$1 = 2500;\nconst POLL = \"POLL\";\nconst fetchTxStatus = async transactionId => {\n  return send$1([getTransactionStatus(transactionId)]).then(decode);\n};\nconst isExpired = tx => tx.status === 5;\nconst isSealed = tx => tx.status >= 4;\nconst isExecuted = tx => tx.status >= 3;\nconst isFinalized = tx => tx.status >= 2;\nconst isPending = tx => tx.status >= 1;\nconst isUnknown = tx => tx.status >= 0;\nconst isDiff = (cur, next) => {\n  return JSON.stringify(cur) !== JSON.stringify(next);\n};\nconst HANDLERS$1 = {\n  [INIT]: async ctx => {\n    ctx.sendSelf(POLL);\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from);\n    ctx.send(letter.from, UPDATED$2, ctx.all());\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from);\n  },\n  [SNAPSHOT$1]: async (ctx, letter) => {\n    letter.reply(ctx.all());\n  },\n  [POLL]: async ctx => {\n    let tx;\n    try {\n      tx = await fetchTxStatus(ctx.self());\n    } catch (e) {\n      return ctx.fatalError(e);\n    }\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE$1);\n    if (isDiff(ctx.all(), tx)) ctx.broadcast(UPDATED$2, tx);\n    ctx.merge(tx);\n  }\n};\nconst scoped = transactionId => {\n  if (typeof transactionId === \"object\") transactionId = transactionId.transactionId;\n  if (transactionId == null) throw new Error(\"transactionId required\");\n  return transactionId;\n};\nconst spawnTransaction = transactionId => {\n  return spawn(HANDLERS$1, scoped(transactionId));\n};\n\n/**\n * @callback SubscriptionCallback\n * @param {TransactionStatus} txStatus\n * @returns {void}\n */\n\n/**\n * Provides methods for interacting with a transaction\n * \n * @param {string} transactionId - The transaction ID\n * @returns {{\n *    snapshot: function(): Promise<TransactionStatus>,\n *    subscribe: function(SubscriptionCallback): function(): void,\n *    onceFinalized: function(): Promise<TransactionStatus>,\n *    onceExecuted: function(): Promise<TransactionStatus>,\n *    onceSealed: function(): Promise<TransactionStatus>\n * }}\n */\nfunction transaction(transactionId) {\n  function snapshot() {\n    return snapshoter(transactionId, spawnTransaction);\n  }\n  function subscribe(callback) {\n    return subscriber(scoped(transactionId), spawnTransaction, callback);\n  }\n  function once(predicate) {\n    return function innerOnce() {\n      let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      const suppress = opts.suppress || false;\n      return new Promise((resolve, reject) => {\n        const unsub = subscribe((txStatus, error) => {\n          if ((error || txStatus.statusCode) && !suppress) {\n            reject(error || txStatus.errorMessage);\n            unsub();\n          } else if (predicate(txStatus)) {\n            resolve(txStatus);\n            unsub();\n          }\n        });\n      });\n    };\n  }\n  return {\n    snapshot,\n    subscribe,\n    onceFinalized: once(isFinalized),\n    onceExecuted: once(isExecuted),\n    onceSealed: once(isSealed)\n  };\n}\ntransaction.isUnknown = isUnknown;\ntransaction.isPending = isPending;\ntransaction.isFinalized = isFinalized;\ntransaction.isExecuted = isExecuted;\ntransaction.isSealed = isSealed;\ntransaction.isExpired = isExpired;\nconst RATE = 10000;\nconst UPDATED = \"UPDATED\";\nconst TICK = \"TICK\";\nconst HIGH_WATER_MARK = \"hwm\";\nconst scheduleTick = async ctx => {\n  return setTimeout(() => ctx.sendSelf(TICK), await config$1().get(\"fcl.eventPollRate\", RATE));\n};\nconst HANDLERS = {\n  [TICK]: async ctx => {\n    if (!ctx.hasSubs()) return;\n    let hwm = ctx.get(HIGH_WATER_MARK);\n    if (hwm == null) {\n      ctx.put(HIGH_WATER_MARK, await block());\n      ctx.put(TICK, await scheduleTick(ctx));\n    } else {\n      let next = await block();\n      ctx.put(HIGH_WATER_MARK, next);\n      if (hwm.height < next.height) {\n        const data = await send$1([getEventsAtBlockHeightRange(ctx.self(), hwm.height + 1, next.height)]).then(decode);\n        for (let d of data) ctx.broadcast(UPDATED, d.data);\n      }\n      ctx.put(TICK, await scheduleTick(ctx));\n    }\n  },\n  [SUBSCRIBE]: async (ctx, letter) => {\n    if (!ctx.hasSubs()) {\n      ctx.put(TICK, await scheduleTick(ctx));\n    }\n    ctx.subscribe(letter.from);\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from);\n    if (!ctx.hasSubs()) {\n      clearTimeout(ctx.get(TICK));\n      ctx.delete(TICK);\n      ctx.delete(HIGH_WATER_MARK);\n    }\n  }\n};\nconst spawnEvents = key => spawn(HANDLERS, key);\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Event} Event\n */\n\n/**\n * @typedef {object} SubscribeObject\n * @property {Function} subscribe - The subscribe function.\n */\n\n/**\n * @callback SubscriptionCallback\n * @returns {Event}\n */\n\n/**\n * @description - Subscribe to events\n * @param {string} key - A valid event name\n * @returns {SubscribeObject}\n * \n * @example\n * import * as fcl from \"@onflow/fcl\"\n * fcl.events(eventName).subscribe((event) => console.log(event))\n */\nfunction events(key) {\n  return {\n    /**\n     * @description - Subscribe to events\n     * @param {Function} callback - The callback function\n     * @returns {SubscriptionCallback}\n     */\n    subscribe: callback => subscriber(key, spawnEvents, callback)\n  };\n}\nvar sha3 = {};\nvar sponge = {};\nvar permute = {};\nvar chi = {};\nvar copy = function copy(I, i) {\n  return function (O, o) {\n    var oi = o * 2;\n    var ii = i * 2;\n    O[oi] = I[ii];\n    O[oi + 1] = I[ii + 1];\n  };\n};\nvar copy_1 = copy;\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _copy = _interopRequireDefault(copy_1);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var chi = function chi(_ref) {\n    var A = _ref.A,\n      C = _ref.C;\n    for (var y = 0; y < 25; y += 5) {\n      for (var x = 0; x < 5; x++) {\n        (0, _copy[\"default\"])(A, y + x)(C, x);\n      }\n      for (var _x = 0; _x < 5; _x++) {\n        var xy = (y + _x) * 2;\n        var x1 = (_x + 1) % 5 * 2;\n        var x2 = (_x + 2) % 5 * 2;\n        A[xy] ^= ~C[x1] & C[x2];\n        A[xy + 1] ^= ~C[x1 + 1] & C[x2 + 1];\n      }\n    }\n  };\n  var _default = chi;\n  exports[\"default\"] = _default;\n})(chi);\nvar iota = {};\nvar roundConstants = {};\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var ROUND_CONSTANTS = new Uint32Array([0, 1, 0, 32898, 2147483648, 32906, 2147483648, 2147516416, 0, 32907, 0, 2147483649, 2147483648, 2147516545, 2147483648, 32777, 0, 138, 0, 136, 0, 2147516425, 0, 2147483658, 0, 2147516555, 2147483648, 139, 2147483648, 32905, 2147483648, 32771, 2147483648, 32770, 2147483648, 128, 0, 32778, 2147483648, 2147483658, 2147483648, 2147516545, 2147483648, 32896, 0, 2147483649, 2147483648, 2147516424]);\n  var _default = ROUND_CONSTANTS;\n  exports[\"default\"] = _default;\n})(roundConstants);\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _roundConstants = _interopRequireDefault(roundConstants);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var iota = function iota(_ref) {\n    var A = _ref.A,\n      roundIndex = _ref.roundIndex;\n    var i = roundIndex * 2;\n    A[0] ^= _roundConstants[\"default\"][i];\n    A[1] ^= _roundConstants[\"default\"][i + 1];\n  };\n  var _default = iota;\n  exports[\"default\"] = _default;\n})(iota);\nvar rhoPi = {};\nvar piShuffles = {};\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var PI_SHUFFLES = [10, 7, 11, 17, 18, 3, 5, 16, 8, 21, 24, 4, 15, 23, 19, 13, 12, 2, 20, 14, 22, 9, 6, 1];\n  var _default = PI_SHUFFLES;\n  exports[\"default\"] = _default;\n})(piShuffles);\nvar rhoOffsets = {};\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var RHO_OFFSETS = [1, 3, 6, 10, 15, 21, 28, 36, 45, 55, 2, 14, 27, 41, 56, 8, 25, 43, 62, 18, 39, 61, 20, 44];\n  var _default = RHO_OFFSETS;\n  exports[\"default\"] = _default;\n})(rhoOffsets);\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _piShuffles = _interopRequireDefault(piShuffles);\n  var _rhoOffsets = _interopRequireDefault(rhoOffsets);\n  var _copy = _interopRequireDefault(copy_1);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var rhoPi = function rhoPi(_ref) {\n    var A = _ref.A,\n      C = _ref.C,\n      W = _ref.W;\n    (0, _copy[\"default\"])(A, 1)(W, 0);\n    var H = 0;\n    var L = 0;\n    var Wi = 0;\n    var ri = 32;\n    for (var i = 0; i < 24; i++) {\n      var j = _piShuffles[\"default\"][i];\n      var r = _rhoOffsets[\"default\"][i];\n      (0, _copy[\"default\"])(A, j)(C, 0);\n      H = W[0];\n      L = W[1];\n      ri = 32 - r;\n      Wi = r < 32 ? 0 : 1;\n      W[Wi] = H << r | L >>> ri;\n      W[(Wi + 1) % 2] = L << r | H >>> ri;\n      (0, _copy[\"default\"])(W, 0)(A, j);\n      (0, _copy[\"default\"])(C, 0)(W, 0);\n    }\n  };\n  var _default = rhoPi;\n  exports[\"default\"] = _default;\n})(rhoPi);\nvar theta = {};\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _copy = _interopRequireDefault(copy_1);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var theta = function theta(_ref) {\n    var A = _ref.A,\n      C = _ref.C,\n      D = _ref.D,\n      W = _ref.W;\n    var H = 0;\n    var L = 0;\n    for (var x = 0; x < 5; x++) {\n      var x20 = x * 2;\n      var x21 = (x + 5) * 2;\n      var x22 = (x + 10) * 2;\n      var x23 = (x + 15) * 2;\n      var x24 = (x + 20) * 2;\n      C[x20] = A[x20] ^ A[x21] ^ A[x22] ^ A[x23] ^ A[x24];\n      C[x20 + 1] = A[x20 + 1] ^ A[x21 + 1] ^ A[x22 + 1] ^ A[x23 + 1] ^ A[x24 + 1];\n    }\n    for (var _x = 0; _x < 5; _x++) {\n      (0, _copy[\"default\"])(C, (_x + 1) % 5)(W, 0);\n      H = W[0];\n      L = W[1];\n      W[0] = H << 1 | L >>> 31;\n      W[1] = L << 1 | H >>> 31;\n      D[_x * 2] = C[(_x + 4) % 5 * 2] ^ W[0];\n      D[_x * 2 + 1] = C[(_x + 4) % 5 * 2 + 1] ^ W[1];\n      for (var y = 0; y < 25; y += 5) {\n        A[(y + _x) * 2] ^= D[_x * 2];\n        A[(y + _x) * 2 + 1] ^= D[_x * 2 + 1];\n      }\n    }\n  };\n  var _default = theta;\n  exports[\"default\"] = _default;\n})(theta);\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _chi = _interopRequireDefault(chi);\n  var _iota = _interopRequireDefault(iota);\n  var _rhoPi = _interopRequireDefault(rhoPi);\n  var _theta = _interopRequireDefault(theta);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var permute = function permute() {\n    var C = new Uint32Array(10);\n    var D = new Uint32Array(10);\n    var W = new Uint32Array(2);\n    return function (A) {\n      for (var roundIndex = 0; roundIndex < 24; roundIndex++) {\n        (0, _theta[\"default\"])({\n          A: A,\n          C: C,\n          D: D,\n          W: W\n        });\n        (0, _rhoPi[\"default\"])({\n          A: A,\n          C: C,\n          W: W\n        });\n        (0, _chi[\"default\"])({\n          A: A,\n          C: C\n        });\n        (0, _iota[\"default\"])({\n          A: A,\n          roundIndex: roundIndex\n        });\n      }\n      C.fill(0);\n      D.fill(0);\n      W.fill(0);\n    };\n  };\n  var _default = permute;\n  exports[\"default\"] = _default;\n})(permute);\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = void 0;\n  var _buffer = require$$0;\n  var _permute = _interopRequireDefault(permute);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var xorWords = function xorWords(I, O) {\n    for (var i = 0; i < I.length; i += 8) {\n      var o = i / 4;\n      O[o] ^= I[i + 7] << 24 | I[i + 6] << 16 | I[i + 5] << 8 | I[i + 4];\n      O[o + 1] ^= I[i + 3] << 24 | I[i + 2] << 16 | I[i + 1] << 8 | I[i];\n    }\n    return O;\n  };\n  var readWords = function readWords(I, O) {\n    for (var o = 0; o < O.length; o += 8) {\n      var i = o / 4;\n      O[o] = I[i + 1];\n      O[o + 1] = I[i + 1] >>> 8;\n      O[o + 2] = I[i + 1] >>> 16;\n      O[o + 3] = I[i + 1] >>> 24;\n      O[o + 4] = I[i];\n      O[o + 5] = I[i] >>> 8;\n      O[o + 6] = I[i] >>> 16;\n      O[o + 7] = I[i] >>> 24;\n    }\n    return O;\n  };\n  var Sponge = function Sponge(_ref) {\n    var _this = this;\n    var capacity = _ref.capacity,\n      padding = _ref.padding;\n    var keccak = (0, _permute[\"default\"])();\n    var stateSize = 200;\n    var blockSize = capacity / 8;\n    var queueSize = stateSize - capacity / 4;\n    var queueOffset = 0;\n    var state = new Uint32Array(stateSize / 4);\n    var queue = _buffer.Buffer.allocUnsafe(queueSize);\n    this.absorb = function (buffer) {\n      for (var i = 0; i < buffer.length; i++) {\n        queue[queueOffset] = buffer[i];\n        queueOffset += 1;\n        if (queueOffset >= queueSize) {\n          xorWords(queue, state);\n          keccak(state);\n          queueOffset = 0;\n        }\n      }\n      return _this;\n    };\n    this.squeeze = function () {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var output = {\n        buffer: options.buffer || _buffer.Buffer.allocUnsafe(blockSize),\n        padding: options.padding || padding,\n        queue: _buffer.Buffer.allocUnsafe(queue.length),\n        state: new Uint32Array(state.length)\n      };\n      queue.copy(output.queue);\n      for (var i = 0; i < state.length; i++) {\n        output.state[i] = state[i];\n      }\n      output.queue.fill(0, queueOffset);\n      output.queue[queueOffset] |= output.padding;\n      output.queue[queueSize - 1] |= 128;\n      xorWords(output.queue, output.state);\n      for (var offset = 0; offset < output.buffer.length; offset += queueSize) {\n        keccak(output.state);\n        readWords(output.state, output.buffer.slice(offset, offset + queueSize));\n      }\n      return output.buffer;\n    };\n    this.reset = function () {\n      queue.fill(0);\n      state.fill(0);\n      queueOffset = 0;\n      return _this;\n    };\n    return this;\n  };\n  var _default = Sponge;\n  exports[\"default\"] = _default;\n})(sponge);\n(function (exports) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports[\"default\"] = exports.SHAKE = exports.SHA3Hash = exports.SHA3 = exports.Keccak = void 0;\n  var _buffer = require$$0;\n  var _sponge = _interopRequireDefault(sponge);\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      \"default\": obj\n    };\n  }\n  var createHash = function createHash(_ref) {\n    var allowedSizes = _ref.allowedSizes,\n      defaultSize = _ref.defaultSize,\n      padding = _ref.padding;\n    return function Hash() {\n      var _this = this;\n      var size = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultSize;\n      if (!this || this.constructor !== Hash) {\n        return new Hash(size);\n      }\n      if (allowedSizes && !allowedSizes.includes(size)) {\n        throw new Error(\"Unsupported hash length\");\n      }\n      var sponge = new _sponge[\"default\"]({\n        capacity: size\n      });\n      this.update = function (input) {\n        var encoding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"utf8\";\n        if (_buffer.Buffer.isBuffer(input)) {\n          sponge.absorb(input);\n          return _this;\n        }\n        if (typeof input === \"string\") {\n          return _this.update(_buffer.Buffer.from(input, encoding));\n        }\n        throw new TypeError(\"Not a string or buffer\");\n      };\n      this.digest = function () {\n        var formatOrOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"binary\";\n        var options = typeof formatOrOptions === \"string\" ? {\n          format: formatOrOptions\n        } : formatOrOptions;\n        var buffer = sponge.squeeze({\n          buffer: options.buffer,\n          padding: options.padding || padding\n        });\n        if (options.format && options.format !== \"binary\") {\n          return buffer.toString(options.format);\n        }\n        return buffer;\n      };\n      this.reset = function () {\n        sponge.reset();\n        return _this;\n      };\n      return this;\n    };\n  };\n  var Keccak = createHash({\n    allowedSizes: [224, 256, 384, 512],\n    defaultSize: 512,\n    padding: 1\n  });\n  exports.Keccak = Keccak;\n  var SHA3 = createHash({\n    allowedSizes: [224, 256, 384, 512],\n    defaultSize: 512,\n    padding: 6\n  });\n  exports.SHA3 = SHA3;\n  var SHAKE = createHash({\n    allowedSizes: [128, 256],\n    defaultSize: 256,\n    padding: 31\n  });\n  exports.SHAKE = SHAKE;\n  var SHA3Hash = Keccak;\n  exports.SHA3Hash = SHA3Hash;\n  SHA3.SHA3Hash = SHA3Hash;\n  var _default = SHA3;\n  exports[\"default\"] = _default;\n})(sha3);\nasync function genHash(utf8String) {\n  const sha = new sha3.SHA3(256);\n  sha.update(Buffer.from(utf8String, \"utf8\"));\n  return sha.digest(\"hex\");\n}\n\n/**\n * @description Generates Interaction Template ID for a given Interaction Template\n *  \n * @param {object} params\n * @param {object} params.template - Interaction Template\n * @returns {Promise<string>} - Interaction Template ID\n */\nasync function generateTemplateId(_ref) {\n  let {\n    template\n  } = _ref;\n  invariant$1(template != undefined, \"generateTemplateId({ template }) -- template must be defined\");\n  invariant$1(typeof template === \"object\", \"generateTemplateId({ template }) -- template must be an object\");\n  invariant$1(typeof template.f_type === \"InteractionTemplate\", \"generateTemplateId({ template }) -- template object must be an InteractionTemplate\");\n  template = normalizeInteractionTemplate(template);\n  switch (template.f_version) {\n    case \"1.0.0\":\n      const templateData = template.data;\n      const messages = await Promise.all(Object.keys(templateData.messages).map(async messageKey => [await genHash(messageKey), await Promise.all(Object.keys(templateData.messages?.[messageKey]?.i18n).map(async i18nkeylanguage => [await genHash(i18nkeylanguage), await genHash(templateData.messages?.[messageKey]?.i18n?.[i18nkeylanguage])]))]));\n      const dependencies = await Promise.all(Object.keys(templateData?.dependencies).map(async dependencyAddressPlaceholder => [await genHash(dependencyAddressPlaceholder), await Promise.all(Object.keys(templateData?.dependencies?.[dependencyAddressPlaceholder]).map(async dependencyContract => [await genHash(dependencyContract), await Promise.all(Object.keys(templateData?.dependencies?.[dependencyAddressPlaceholder]?.[dependencyContract]).map(async dependencyContractNetwork => [await genHash(dependencyContractNetwork), [await genHash(templateData?.dependencies?.[dependencyAddressPlaceholder]?.[dependencyContract]?.[dependencyContractNetwork].address), await genHash(templateData?.dependencies?.[dependencyAddressPlaceholder]?.[dependencyContract]?.[dependencyContractNetwork].contract), await genHash(templateData?.dependencies?.[dependencyAddressPlaceholder]?.[dependencyContract]?.[dependencyContractNetwork].fq_address), await genHash(templateData?.dependencies?.[dependencyAddressPlaceholder]?.[dependencyContract]?.[dependencyContractNetwork].pin), await genHash(String(templateData?.dependencies?.[dependencyAddressPlaceholder]?.[dependencyContract]?.[dependencyContractNetwork].pin_block_height))]]))]))]));\n      const _arguments = await Promise.all(Object.keys(templateData?.[\"arguments\"]).map(async argumentLabel => [await genHash(argumentLabel), [await genHash(String(templateData?.[\"arguments\"]?.[argumentLabel].index)), await genHash(templateData?.[\"arguments\"]?.[argumentLabel].type), await genHash(templateData?.[\"arguments\"]?.[argumentLabel].balance || \"\"), await Promise.all(Object.keys(templateData?.[\"arguments\"]?.[argumentLabel].messages).map(async argumentMessageKey => [await genHash(argumentMessageKey), await Promise.all(Object.keys(templateData?.[\"arguments\"]?.[argumentLabel].messages?.[argumentMessageKey].i18n).map(async i18nkeylanguage => [await genHash(i18nkeylanguage), await genHash(templateData?.[\"arguments\"]?.[argumentLabel].messages?.[argumentMessageKey].i18n?.[i18nkeylanguage])]))]))]]));\n      const encodedHex = encode([await genHash(\"InteractionTemplate\"), await genHash(\"1.0.0\"), await genHash(templateData?.type), await genHash(templateData?.interface), messages, await genHash(templateData?.cadence), dependencies, _arguments]).toString(\"hex\");\n      return genHash(encodedHex);\n    default:\n      throw new Error(\"generateTemplateId Error: Unsupported template version\");\n  }\n}\n\n/**\n * @description Returns whether a set of auditors have audited a given Interaction Template\n * \n * @param {object} params\n * @param {object} params.template - Interaction Template\n * @param {Array<string>} params.auditors - Array of auditors\n * @param {object} opts\n * @param {string} opts.flowInteractionAuditContract - Flow Interaction Template Audit contract address\n * @returns {Promise<object>} - Object of auditor addresses and audit status\n */\nasync function getInteractionTemplateAudits(_ref) {\n  let {\n    template,\n    auditors\n  } = _ref;\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  invariant$1(template != undefined, \"getInteractionTemplateAudits({ template }) -- template must be defined\");\n  template = normalizeInteractionTemplate(template);\n  invariant$1(template.f_type === \"InteractionTemplate\", \"getInteractionTemplateAudits({ template }) -- template must be an InteractionTemplate\");\n\n  // Recompute ID to be sure it matches\n  let recomputedTemplateID = await generateTemplateId({\n    template\n  });\n  if (recomputedTemplateID !== template.id) {\n    log({\n      title: \"getInteractionTemplateAudits Debug Error\",\n      message: `Could not recompute and match template ID\n                computed: ${recomputedTemplateID}\n                template: ${template.id}\n            `,\n      level: LEVELS.debug\n    });\n    throw new Error(\"getInteractionTemplateAudits Error: Could not recompute and match template ID\");\n  }\n  switch (template.f_version) {\n    case \"1.0.0\":\n      const _auditors = auditors || (await config$1().get(\"flow.auditors\"));\n      invariant$1(_auditors, \"getInteractionTemplateAudits Error: Required configuration for 'fcl.auditors' is not set\");\n      invariant$1(Array.isArray(_auditors), \"getInteractionTemplateAudits Error: Required configuration for 'fcl.auditors' is not an array\");\n      let FlowInteractionAuditContract = opts.flowInteractionAuditContract;\n      if (!FlowInteractionAuditContract) {\n        const fclNetwork = await getChainId();\n        invariant$1(fclNetwork === \"mainnet\" || fclNetwork === \"testnet\", \"getInteractionTemplateAudits Error: Unable to determine address for FlowInteractionTemplateAudit contract. Set configuration for 'fcl.network' to 'mainnet' or 'testnet'\");\n        if (fclNetwork === \"mainnet\") {\n          FlowInteractionAuditContract = \"0xfd100e39d50a13e6\";\n        } else {\n          FlowInteractionAuditContract = \"0xf78bfc12d0a786dc\";\n        }\n      }\n      const audits = await query({\n        cadence: `\n        import FlowInteractionTemplateAudit from ${FlowInteractionAuditContract}\n        pub fun main(templateId: String, auditors: [Address]): {Address:Bool} {\n          return FlowInteractionTemplateAudit.getHasTemplateBeenAuditedByAuditors(templateId: templateId, auditors: auditors)\n        }\n        `,\n        args: (arg, t) => [arg(recomputedTemplateID, t.String), arg(_auditors, t.Array(t.Address))]\n      });\n      return audits;\n    default:\n      throw new Error(\"getInteractionTemplateAudits Error: Unsupported template version\");\n  }\n}\nfunction generateImport(_ref) {\n  let {\n    contractName,\n    address\n  } = _ref;\n  return {\n    contractName,\n    address,\n    contract: \"\"\n  };\n}\nfunction findImports(cadence) {\n  let imports = [];\n  let importsReg = /import ((\\w|,| )+)* from 0x\\w+/g;\n  let fileImports = cadence.match(importsReg) || [];\n  for (const fileImport of fileImports) {\n    const importLineReg = /import ((\\w+|, |)*) from (0x\\w+)/g;\n    const importLine = importLineReg.exec(fileImport);\n    const contractsReg = /((?:\\w+)+),?/g;\n    const contracts = importLine[1].match(contractsReg) || [];\n    for (const contract of contracts) {\n      imports.push(generateImport({\n        address: importLine[3],\n        contractName: contract.replace(/,/g, \"\")\n      }));\n    }\n  }\n  return imports;\n}\n\n/**\n * @description Produces a dependency pin for a contract at a given block height\n * @param {object} params\n * @param {string} params.address - The address of the account containing the contract\n * @param {string} params.contractName - The name of the contract\n * @param {number} params.blockHeight - The block height to produce the dependency pin for\n * @param {object} opts - Options to pass to the interaction\n * @returns {Promise<string>} - The dependency pin\n */\nasync function generateDependencyPin(_ref) {\n  let {\n    address,\n    contractName,\n    blockHeight\n  } = _ref;\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  invariant$1(address != undefined, \"generateDependencyPin({ address }) -- address must be defined\");\n  invariant$1(contractName != undefined, \"generateDependencyPin({ contractName }) -- contractName must be defined\");\n  invariant$1(blockHeight != undefined, \"generateDependencyPin({ blockHeight }) -- blockHeight must be defined\");\n  invariant$1(typeof address === \"string\", \"generateDependencyPin({ address }) -- address must be a string\");\n  invariant$1(typeof contractName === \"string\", \"generateDependencyPin({ contractName }) -- contractName must be a string\");\n  invariant$1(typeof blockHeight === \"number\", \"generateDependencyPin({ blockHeight }) -- blockHeight must be a number\");\n  let horizon = [generateImport({\n    contractName,\n    address\n  })];\n  for (const horizonImport of horizon) {\n    let account = await send$1([getAccount(await config$1().get(horizonImport.address, horizonImport.address)), atBlockHeight(blockHeight)], opts).then(decode);\n    horizonImport.contract = account.contracts?.[horizonImport.contractName];\n    if (!horizonImport.contract) {\n      console.error(\"Did not find expected contract\", horizonImport, account);\n      throw new Error(\"Did not find expected contract\");\n    }\n    let contractImports = findImports(horizonImport.contract);\n    horizon.push(...contractImports);\n  }\n  let contractHashes = horizon.map(iport => genHash(iport.contract));\n  let contractHashesJoined = contractHashes.join(\"\");\n  return genHash(contractHashesJoined);\n}\n\n/**\n * @description Produces a dependency pin for a contract at latest sealed block\n * @param {object} params\n * @param {string} params.address - The address of the account containing the contract\n * @param {string} params.contractName - The name of the contract\n * @param {object} opts - Options to pass to the interaction\n * @returns {Promise<string>} - The dependency pin\n */\nasync function generateDependencyPinAtLatestSealedBlock(_ref2) {\n  let {\n    address,\n    contractName\n  } = _ref2;\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let latestSealedBlock = await block({\n    sealed: true\n  }, opts);\n  let latestSealedBlockHeight = latestSealedBlock?.height;\n  return generateDependencyPin({\n    address,\n    contractName,\n    blockHeight: latestSealedBlockHeight\n  }, opts);\n}\nfunction normalizeInteractionTemplateInterface(templateInterface) {\n  if (templateInterface == null) return null;\n  switch (templateInterface[\"f_version\"]) {\n    case \"1.0.0\":\n      return templateInterface;\n    default:\n      throw new Error(\"normalizeInteractionTemplateInterface Error: Invalid InteractionTemplateInterface\");\n  }\n}\n\n/**\n * @description Generates Interaction Template Interface ID for a given Interaction Template Interface\n * \n * @param {object} params\n * @param {object} params.templateInterface - Interaction Template Interface\n * @returns {Promise<string>} - Interaction Template Interface ID\n */\nasync function generateTemplateInterfaceId(_ref) {\n  let {\n    templateInterface\n  } = _ref;\n  invariant$1(templateInterface != undefined, \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface must be defined\");\n  invariant$1(typeof templateInterface === \"object\", \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface must be an object\");\n  invariant$1(typeof templateInterface.f_type === \"InteractionTemplateInterface\", \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface object must be an InteractionTemplate\");\n  templateInterface = normalizeInteractionTemplateInterface(templateInterface);\n  switch (templateInterface.f_version) {\n    case \"1.0.0\":\n      const interfaceData = templateInterface.data;\n      const encodedHex = encode([await genHash(\"InteractionTemplateInterface\"), await genHash(\"1.0.0\"), await genHash(interfaceData.flip), await Promise.all(Object.keys(interfaceData.arguments).map(async argumentLabel => [await genHash(argumentLabel), await genHash(String(interfaceData.arguments[argumentLabel].index)), await genHash(interfaceData.arguments[argumentLabel].type)]))]).toString(\"hex\");\n      return genHash(encodedHex);\n    default:\n      throw new Error(\"generateTemplateInterfaceId Error: Unsupported templateInterface version\");\n  }\n}\n\n/**\n * @description Checks if an Interaction Template's pins match those generated at a block height\n * \n * @param {object} params\n * @param {object} params.template - Interaction Template to check pins for\n * @param {number} params.blockHeight - Block height to check pins at\n * @param {string} params.network - Network to check pins on\n * @param {object} opts\n * @returns {Promise<boolean>} - Whether or not the pins match\n */\nasync function verifyDependencyPinsSame(_ref) {\n  let {\n    template,\n    blockHeight,\n    network\n  } = _ref;\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  invariant$1(template != undefined, \"generateDependencyPin({ template }) -- template must be defined\");\n  invariant$1(typeof template === \"object\", \"generateDependencyPin({ template }) -- template must be an object\");\n  invariant$1(template.f_type === \"InteractionTemplate\", \"generateDependencyPin({ template }) -- template must be an InteractionTemplate\");\n  template = normalizeInteractionTemplate(template);\n  invariant$1(network != undefined, \"generateDependencyPin({ network }) network must be defined\");\n  invariant$1(blockHeight != undefined, \"generateDependencyPin({ blockHeight }) blockHeight must be defined\");\n  invariant$1(typeof blockHeight === \"number\", \"generateDependencyPin({ blockHeight }) blockHeight must be a number\");\n  switch (template.f_version) {\n    case \"1.0.0\":\n      let templateDependenciesPlaceholderKeys = Object.keys(template.data.dependencies);\n      for (let templateDependencyPlaceholderKey of templateDependenciesPlaceholderKeys) {\n        let templateDependencyPlaceholder = template.data.dependencies[templateDependencyPlaceholderKey];\n        let templateDependencyPlaceholderContractNames = Object.keys(templateDependencyPlaceholder);\n        for (let templateDependencyPlaceholderContractName of templateDependencyPlaceholderContractNames) {\n          let templateDependencyPlaceholderContractNetworks = template.data.dependencies[templateDependencyPlaceholderKey][templateDependencyPlaceholderContractName];\n          let templateDependency = templateDependencyPlaceholderContractNetworks[network];\n          if (typeof templateDependency === \"undefined\") continue;\n          let pin = await generateDependencyPin({\n            address: templateDependency.address,\n            contractName: templateDependency.contract,\n            blockHeight\n          }, opts);\n          if (pin !== templateDependency.pin) {\n            log({\n              title: \"verifyDependencyPinsSame Debug Error\",\n              message: `Could not recompute and match dependency pin.\n                                address: ${templateDependency.address} | contract: ${templateDependency.contract}\n                                computed: ${pin}\n                                template: ${templateDependency.pin}\n                            `,\n              level: LEVELS.debug\n            });\n            return false;\n          }\n        }\n      }\n      return true;\n    default:\n      throw new Error(\"verifyDependencyPinsSame Error: Unsupported template version\");\n  }\n}\n\n/**\n * @description Checks if an Interaction Template's pins match those generated at the latest block height\n * \n * @param {object} params\n * @param {object} params.template - Interaction Template to check pins for\n * @param {string} params.network - Network to check pins on\n * @param {object} opts\n * @returns {Promise<boolean>} - Whether or not the pins match\n */\nasync function verifyDependencyPinsSameAtLatestSealedBlock(_ref2) {\n  let {\n    template,\n    network\n  } = _ref2;\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let latestSealedBlock = await block({\n    sealed: true\n  });\n  let latestSealedBlockHeight = latestSealedBlock?.height;\n  return verifyDependencyPinsSame({\n    template,\n    network,\n    blockHeight: latestSealedBlockHeight\n  }, opts);\n}\n\n/**\n * @description Get Interaction Template argument message\n * \n * @param {object} params\n * @param {string} params.localization [localization=\"en-US\"] - Localization code\n * @param {string} params.messageKey - Message key\n * @param {object} params.template - Interaction Template\n * @returns {string} - Message\n */\nfunction getTemplateMessage(_ref) {\n  let {\n    localization = \"en-US\",\n    messageKey,\n    template\n  } = _ref;\n  invariant$1(messageKey, \"getTemplateMessage({ messageKey }) -- messageKey must be defined\");\n  invariant$1(typeof messageKey === \"string\", \"getTemplateMessage({ messageKey }) -- messageKey must be a string\");\n  invariant$1(localization, \"getTemplateMessage({ localization }) -- localization must be defined\");\n  invariant$1(typeof localization === \"string\", \"getTemplateMessage({ localization }) -- localization must be a string\");\n  invariant$1(template != undefined, \"getTemplateMessage({ template }) -- template must be defined\");\n  invariant$1(typeof template === \"object\", \"getTemplateMessage({ template }) -- template must be an object\");\n  invariant$1(typeof template.f_type === \"InteractionTemplate\", \"getTemplateMessage({ template }) -- template object must be an InteractionTemplate\");\n  const messages = template?.data?.messages;\n  return messages?.[messageKey]?.i18n?.[localization];\n}\n\n/**\n * @description Gets Interaction Template argument message by message key, argument label, and localization\n * \n * @param {object} opts\n * @param {string} opts.localization [localization=\"en-US\"] - Localization to get message for\n * @param {string} opts.argumentLabel - Argument label to get message for\n * @param {string} opts.messageKey - Message key to get message for\n * @param {object} opts.template - Interaction Template to get message from\n * @returns {string} - Message\n */\nfunction getTemplateArgumentMessage(_ref) {\n  let {\n    localization = \"en-US\",\n    argumentLabel,\n    messageKey,\n    template\n  } = _ref;\n  invariant$1(messageKey, \"getTemplateArgumentMessage({ messageKey }) -- messageKey must be defined\");\n  invariant$1(typeof messageKey === \"string\", \"getTemplateArgumentMessage({ messageKey }) -- messageKey must be a string\");\n  invariant$1(argumentLabel, \"getTemplateArgumentMessage({ argumentLabel }) -- argumentLabel must be defined\");\n  invariant$1(typeof messageKey === \"string\", \"getTemplateArgumentMessage({ argumentLabel }) -- argumentLabel must be a string\");\n  invariant$1(localization, \"getTemplateArgumentMessage({ localization }) -- localization must be defined\");\n  invariant$1(typeof localization === \"string\", \"getTemplateArgumentMessage({ localization }) -- localization must be a string\");\n  invariant$1(template != undefined, \"getTemplateArgumentMessage({ template }) -- template must be defined\");\n  invariant$1(typeof template === \"object\", \"getTemplateArgumentMessage({ template }) -- template must be an object\");\n  invariant$1(typeof template.f_type === \"InteractionTemplate\", \"getTemplateArgumentMessage({ template }) -- template object must be an InteractionTemplate\");\n  const args = template?.data?.arguments;\n  return args?.[argumentLabel]?.messages?.[messageKey]?.i18n?.[localization];\n}\nvar index = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  getInteractionTemplateAudits: getInteractionTemplateAudits,\n  generateDependencyPin: generateDependencyPin,\n  generateDependencyPinAtLatestSealedBlock: generateDependencyPinAtLatestSealedBlock,\n  generateTemplateId: generateTemplateId,\n  generateTemplateInterfaceId: generateTemplateInterfaceId,\n  verifyDependencyPinsSame: verifyDependencyPinsSame,\n  verifyDependencyPinsSameAtLatestSealedBlock: verifyDependencyPinsSameAtLatestSealedBlock,\n  deriveCadenceByNetwork: deriveCadenceByNetwork,\n  getTemplateMessage: getTemplateMessage,\n  getTemplateArgumentMessage: getTemplateArgumentMessage\n});\nconst authenticate = function () {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return currentUser().authenticate(opts);\n};\nconst unauthenticate = () => currentUser().unauthenticate();\nconst reauthenticate = function () {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  currentUser().unauthenticate();\n  return currentUser().authenticate(opts);\n};\nconst signUp = function () {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return currentUser().authenticate(opts);\n};\nconst logIn = function () {\n  let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return currentUser().authenticate(opts);\n};\nconst authz = currentUser().authorization;\n/**\n * @type {Types}\n */\nconst t = t$1;\n\n/**\n * @typedef {object} Types\n * @property {any} Identity - Represents the Identity type.\n * @property {any} UInt - Represents the UInt type.\n * @property {any} Int - Represents the Int type.\n * @property {any} UInt8 - Represents the UInt8 type.\n * @property {any} Int8 - Represents the Int8 type.\n * @property {any} UInt16 - Represents the UInt16 type.\n * @property {any} Int16 - Represents the Int16 type.\n * @property {any} UInt32 - Represents the UInt32 type.\n * @property {any} Int32 - Represents the Int32 type.\n * @property {any} UInt64 - Represents the UInt64 type.\n * @property {any} Int64 - Represents the Int64 type.\n * @property {any} UInt128 - Represents the UInt128 type.\n * @property {any} Int128 - Represents the Int128 type.\n * @property {any} UInt256 - Represents the UInt256 type.\n * @property {any} Int256 - Represents the Int256 type.\n * @property {any} Word8 - Represents the Word8 type.\n * @property {any} Word16 - Represents the Word16 type.\n * @property {any} Word32 - Represents the Word32 type.\n * @property {any} Word64 - Represents the Word64 type.\n * @property {any} UFix64 - Represents the UFix64 type.\n * @property {any} Fix64 - Represents the Fix64 type.\n * @property {any} String - Represents the String type.\n * @property {any} Character - Represents the Character type.\n * @property {any} Bool - Represents the Bool type.\n * @property {any} Address - Represents the Address type.\n * @property {any} Void - Represents the Void type.\n * @property {any} Optional - Represents the Optional type.\n * @property {any} Reference - Represents the Reference type.\n * @property {any} Array - Represents the Array type.\n * @property {any} Dictionary - Represents the Dictionary type.\n * @property {any} Event - Represents the Event type.\n * @property {any} Resource - Represents the Resource type.\n * @property {any} Struct - Represents the Struct type.\n * @property {any} Enum - Represents the Enum type.\n * @property {any} Path - Represents the Path type.\n */\n\n/**\n * @callback ArgsFn\n * @param {ArgFn} arg - Argument function to define a single argument\n * @param {Types} t - Cadence Types object used to define the type\n * @returns {any[]}\n */\n\n/**\n * @callback ArgFn\n * @param {any} value - the value of the argument\n * @param {any} type - the cadence type of the value\n * @returns {any}\n */\n\nexport { index$1 as AppUtils, index as InteractionTemplateUtils, VERSION, index$2 as WalletUtils, authenticate, authz, currentUser, discovery, events, getChainId, logIn, mutate, pluginRegistry, query, reauthenticate, serialize, signUp, t, transaction as tx, unauthenticate, verifyUserSignatures };","map":{"version":3,"names":["getChainIdFromAccessNode","response","sdk","send","getNetworkParameters","then","decode","chainId","setChainIdDefault","network","config","put","getChainId","get","log","deprecate","pkg","subject","message","transition","invariant","watchForChainIdChanges","subscribe","configSubscriber","nextAccessNode","prevAccessNode","bind","isAndroid","navigator","test","userAgent","isSmallIOS","isLargeIOS","isIOS","isMobile","isServerSide","window","SESSION_STORAGE","can","key","JSON","parse","sessionStorage","getItem","value","setItem","stringify","configLens","regex","Object","fromEntries","entries","where","map","_ref","replace","VERSION","is","type","d","isRequired","isObject","isString","isFunc","isNumber","normalizeArgs","ax","arg","t$1","httpDocumentResolver","url","res","fetchTransport","e","Error","document","ok","json","DOCUMENT_RESOLVERS","Map","retrieve","_ref2","documentResolversFromConfig","keys","resolverFromConfig","resolverProtocol","set","urlParts","exec","protocol","resolver","normalizeInteractionTemplate","template","deriveCadenceByNetwork","invariant$1","undefined","f_type","f_version","networkDependencies","data","dependencies","dependencyPlaceholder","dependencyNetworkContracts","values","length","dependencyContract","dependencyContractForNetwork","address","reduce","cadence","placeholder","RegExp","deriveDependencies","derivedDependencies","dependencyPlaceholderKeys","dependencyPlaceholderKey","dependencyPlaceholderContractsKeys","dependencyPlaceholderContract","dependency","withPrefix","prepTemplateOpts","opts","pre","preMutate","preQuery","query","arguments","overload","script","args","limit","fetchServices","servicesURL","code","URL","searchParams","append","resp","fetch","method","headers","Array","isArray","services","authorizations","service","push","keyId","provider","id","mergeServices","sx1","sx2","SERVICE_PRAGMA","f_vsn","IDENTITY_PRAGMA","USER_PRAGMA","POLLING_RESPONSE_PRAGMA","COMPOSITE_SIGNATURE_PRAGMA","normalizeAuthn","uid","endpoint","authn","pid","addr","name","icon","normalizeAuthz","identity","params","normalizePreAuthz","normalizeFrame","old","normalizeBackChannelRpc","normalizeOpenId","normalizeUserSignature","normalizeLocalView","normalizeAccountProof","normalizeAuthnRefresh","serviceNormalizers","authz","frame","normalizeService","normalized","error","console","deriveCompositeId","rlp","encode","toString","normalizeData","paddr","findService","find","buildUser","hks","cid","loggedIn","expiresAt","expires","serviceOfType","serviceEndpoint","location","origin","fetchService","body","normalizePollingResponse","status","reason","compositeSignature","updates","authorizationUpdates","local","OPTIONS","serviceMethod","poll","canContinue","visibilityState","Promise","r","setTimeout","FRAME","FRAME_STYLES","renderFrame","src","getElementById","$frame","createElement","allow","frameBorder","style","cssText","unmount","remove","contentWindow","POP","popup","previousUrl$1","popupWindow","windowName","win","w","h","y","top","outerHeight","screenY","x","outerWidth","screenX","open","renderPop","closed","focus","close","tab$1","previousUrl","renderTab","VIEWS","execLocal","execHttpPost","fclVersion","_","serviceResponse","catch","CLOSE_EVENT","READY_EVENT","RESPONSE_EVENT","toLowerCase","IGNORE","Set","was","want","warn","buildMessageHandler","onReady","onResponse","onMessage","has","noop$3","onClose","handler","addEventListener","removeEventListener","msg","postMessage","execIframeRPC","resolve","reject","includeOlderJsonRpcCall","deprecated","jsonrpc","_ref3","_ref4","result","noop$2","pop","$pop","timer","setInterval","clearInterval","execPopRPC","redir","noop$1","tab","$tab","execTabRPC","noop","extension","execExtRPC","CORE_STRATEGIES","supportedPlugins","supportedServicePlugins","validateDiscoveryPlugin","servicePlugin","serviceStrategy","ds","discoveryServices","ServiceRegistry","strategies","add","includes","setServices","title","level","LEVELS","getServices","getStrategy","getStrategies","freeze","validatePlugins","plugins","pluginsArray","p","PluginRegistry","pluginsMap","getPlugins","serviceRegistry","pluginRegistry","execStrategy","strategy","execService","execConfig","app","client","fclLibrary","hostname","normalizeCompositeSignature","sansPrefix","signature","sig","makeDiscoveryServices","extensionServices","fcl_extensions","getDiscoveryService","discoveryAuthnInclude","discoveryWalletMethod","first","types","Boolean","include","clientServices","supportedStrategies","SERVICE_ACTOR_KEYS","AUTHN","RESULTS","SNAPSHOT","UPDATED","UPDATE_RESULTS","fact","fetchServicesFromDiscovery","results","HANDLERS$3","INIT","ctx","readyState","onload","_letter","merge","broadcast","all","SUBSCRIBE","letter","from","UNSUBSCRIBE","unsubscribe","reply","spawnProviders","spawn","cb","subscriber","snapshot","snapshoter","update","discovery","isFn","NAME","UPDATED$1","SET_CURRENT_USER","DEL_CURRENT_USER","DATA","getStoredUser","storage","fallback","stored","removeItem","HANDLERS$2","user","notExpired","spawnCurrentUser","Date","now","getAccountProofData","accountProofDataResolver","accountProofData","appIdentifier","nonce","makeConfig","authenticate$1","is_installed","requires_install","href","install_link","discoveryService","refreshService","unauthenticate$1","normalizePreAuthzResponse","proposer","payer","authorization","resolvePreAuthz","axs","az","role","tempId","join","signingFunction","signable","authorizer","account","preSignable","preAuthz","windowRef","sequenceNum","callback","EXIT","self","receive","tag","expectReply","timeout","resolveArgument","Address","makeSignable","signUserMessage","signingService","compSigs","currentUser","authenticate","unauthenticate","mutate","txid","transaction","onMessageFromFCL","messageType","buildData","interaction","internal","sendMsgToFCL","parent","opener","ready","approve","decline","redirect","CompositeSignature","Number","rightPaddedHexBuffer","pad","Buffer","padEnd","leftPaddedHexBuffer","padStart","addressBuffer","nonceBuffer","encodeAccountProof","includeDomainTag","ACCOUNT_PROOF_DOMAIN_TAG","concat","injectExtService","ACCOUNT_PROOF","USER_SIGNATURE","validateArgs","signatures","every","i","arr","cs","getVerifySignaturesScript","verifyFunction","fclCryptoContract","verifyAccountProof","signaturesArr","keyIndices","el","t","String","Int","verifyUserSignatures$1","verifyUserSignatures","serialize","resolveFunction","config$1","pipe","createSignableVoucher","RATE$1","POLL","fetchTxStatus","transactionId","send$1","getTransactionStatus","isExpired","tx","isSealed","isExecuted","isFinalized","isPending","isUnknown","isDiff","cur","next","HANDLERS$1","sendSelf","UPDATED$2","SNAPSHOT$1","fatalError","scoped","spawnTransaction","once","predicate","innerOnce","suppress","unsub","txStatus","statusCode","errorMessage","onceFinalized","onceExecuted","onceSealed","RATE","TICK","HIGH_WATER_MARK","scheduleTick","HANDLERS","hasSubs","hwm","block","height","getEventsAtBlockHeightRange","clearTimeout","delete","spawnEvents","events","copy","I","O","o","oi","ii","copy_1","defineProperty","exports","_copy","_interopRequireDefault","obj","__esModule","chi","A","C","_x","xy","x1","x2","_default","ROUND_CONSTANTS","Uint32Array","_roundConstants","roundConstants","iota","roundIndex","PI_SHUFFLES","RHO_OFFSETS","_piShuffles","piShuffles","_rhoOffsets","rhoOffsets","rhoPi","W","H","L","Wi","ri","j","theta","D","x20","x21","x22","x23","x24","_chi","_iota","_rhoPi","_theta","permute","fill","_buffer","require$$0","_permute","xorWords","readWords","Sponge","_this","capacity","padding","keccak","stateSize","blockSize","queueSize","queueOffset","state","queue","allocUnsafe","absorb","buffer","squeeze","options","output","offset","slice","reset","SHAKE","SHA3Hash","SHA3","Keccak","_sponge","sponge","createHash","allowedSizes","defaultSize","Hash","size","constructor","input","encoding","isBuffer","TypeError","digest","formatOrOptions","format","genHash","utf8String","sha","sha3","generateTemplateId","templateData","messages","messageKey","i18n","i18nkeylanguage","dependencyAddressPlaceholder","dependencyContractNetwork","contract","fq_address","pin","pin_block_height","_arguments","argumentLabel","index","balance","argumentMessageKey","encodedHex","interface","getInteractionTemplateAudits","auditors","recomputedTemplateID","debug","_auditors","FlowInteractionAuditContract","flowInteractionAuditContract","fclNetwork","audits","generateImport","contractName","findImports","imports","importsReg","fileImports","match","fileImport","importLineReg","importLine","contractsReg","contracts","generateDependencyPin","blockHeight","horizon","horizonImport","getAccount","atBlockHeight","contractImports","contractHashes","iport","contractHashesJoined","generateDependencyPinAtLatestSealedBlock","latestSealedBlock","sealed","latestSealedBlockHeight","normalizeInteractionTemplateInterface","templateInterface","generateTemplateInterfaceId","interfaceData","flip","verifyDependencyPinsSame","templateDependenciesPlaceholderKeys","templateDependencyPlaceholderKey","templateDependencyPlaceholder","templateDependencyPlaceholderContractNames","templateDependencyPlaceholderContractName","templateDependencyPlaceholderContractNetworks","templateDependency","verifyDependencyPinsSameAtLatestSealedBlock","getTemplateMessage","localization","getTemplateArgumentMessage","reauthenticate","signUp","logIn"],"sources":["/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/utils/get-chain-id.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/utils/chain-id-watcher.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/utils/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/default-config.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/VERSION.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/exec/utils/is.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/exec/utils/normalize-args.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/document/document.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/interaction-template/interaction-template.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/interaction-template-utils/derive-cadence-by-network.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/exec/utils/derive-dependencies.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/exec/utils/prep-template-opts.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/exec/utils/pre.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/exec/query.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/fetch-services.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/merge-services.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/__vsn.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/authn.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/authz.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/pre-authz.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/frame.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/back-channel-rpc.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/open-id.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/user-signature.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/local-view.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/account-proof.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/authn-refresh.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/service.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/build-user.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/service-of-type.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/utils/service-endpoint.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/utils/fetch-service.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/polling-response.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/utils/poll.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/utils/render-frame.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/utils/render-pop.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/utils/render-tab.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/exec-local.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/http-post.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/utils/buildMessageHandler.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/utils/frame.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/iframe-rpc.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/utils/pop.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/pop-rpc.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/utils/tab.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/tab-rpc.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/utils/extension.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/strategies/ext-rpc.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/plugins.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/exec-service/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/service/composite-signature.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/discovery/utils.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/discovery/services.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/discovery/services/authn.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/discovery/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/current-user/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/exec/mutate.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/wallet-utils/on-message-from-fcl.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/wallet-utils/send-msg-to-fcl.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/wallet-utils/CompositeSignature.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/wallet-utils/encode-account-proof.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/wallet-utils/inject-ext-service.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/app-utils/verify-signatures.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/exec/verify.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/serialize/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/transaction/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/events/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/node_modules/sha3/sponge/permute/copy/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/node_modules/sha3/sponge/permute/chi/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/node_modules/sha3/sponge/permute/iota/round-constants/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/node_modules/sha3/sponge/permute/iota/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/node_modules/sha3/sponge/permute/rho-pi/pi-shuffles/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/node_modules/sha3/sponge/permute/rho-pi/rho-offsets/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/node_modules/sha3/sponge/permute/rho-pi/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/node_modules/sha3/sponge/permute/theta/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/node_modules/sha3/sponge/permute/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/node_modules/sha3/sponge/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/node_modules/sha3/index.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/interaction-template-utils/utils/hash.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/interaction-template-utils/generate-template-id.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/interaction-template-utils/get-interaction-template-audits.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/interaction-template-utils/utils/generate-import.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/interaction-template-utils/utils/find-imports.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/interaction-template-utils/generate-dependency-pin.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/normalizers/interaction-template/interaction-template-interface.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/interaction-template-utils/generate-template-interface-id.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/interaction-template-utils/verify-dependency-pin-same-at-block.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/interaction-template-utils/get-template-message.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/interaction-template-utils/get-template-argument-message.js","/Users/oqpo/Documents/GitHub/darkblock-flow/node_modules/@onflow/fcl/src/fcl.js"],"sourcesContent":["import * as sdk from \"@onflow/sdk\"\nimport {config} from \"@onflow/config\"\nimport {log} from \"@onflow/util-logger\"\nimport {invariant} from \"@onflow/util-invariant\"\n\nasync function getChainIdFromAccessNode() {\n  const response = await sdk.send([sdk.getNetworkParameters()]).then(sdk.decode)\n  return response.chainId\n}\n\n/**\n * Sets the default chain id to the chain id of the access node\n *\n * @returns {string} The chain id of the access node\n *\n * @example\n * // returns \"testnet\"\n * setChainIdDefault()\n */\nexport async function setChainIdDefault() {\n  const network = await getChainIdFromAccessNode()\n  config.put(\"flow.network.default\", network)\n  return network\n}\n\n/**\n * @description\n * Gets the chain ID if its set, otherwise gets the chain ID from the access node\n *\n * @returns {string} The chain ID of the access node\n * @throws {Error} If the chain ID is not found\n *\n * @example\n * // returns \"testnet\"\n * getChainId()\n */\nexport async function getChainId() {\n  let network = await config.get(\"flow.network.default\")\n\n  if (!network) {\n    network = await setChainIdDefault()\n\n    if (!network) {\n      network = await config.get(\"flow.network\")\n\n      if (network) {\n        log.deprecate({\n          pkg: \"FCL\",\n          subject:\n            'Using the \"flow.network\" configuration key for specifying the flow network',\n          message: \"Configuring flow.network is no longer required\",\n          transition:\n            \"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/TRANSITIONS.md#0002-deprecate-flow.network-config-key\",\n        })\n      } else {\n        network = await config.get(\"env\")\n\n        if (network)\n          log.deprecate({\n            pkg: \"FCL\",\n            subject:\n              'Using the \"env\" configuration key for specifying the flow network',\n            message:\n              \"Configuring to specify flow network is no longer required\",\n            transition:\n              \"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/TRANSITIONS.md#0001-deprecate-env-config-key\",\n          })\n      }\n    }\n  }\n\n  invariant(\n    network,\n    \"Error getting chainId from access node. Please configure flow.network instead\"\n  )\n\n  return network\n}\n","import {config} from \"@onflow/config\"\nimport {setChainIdDefault} from \"./get-chain-id\"\n\n/**\n * @description\n * Watches the config for changes to access node and updates the chain id accordingly\n *\n * @returns {Function} A function that unsubscribes the listener\n *\n */\nexport function watchForChainIdChanges() {\n  return config.subscribe(\n    function configSubscriber(config) {\n      const nextAccessNode = config?.[\"accessNode.api\"]\n      if (this.prevAccessNode !== nextAccessNode) {\n        setChainIdDefault()\n      }\n      this.prevAccessNode = nextAccessNode\n    }.bind({})\n  )\n}\n","export {getChainId} from \"./get-chain-id\"\nexport {watchForChainIdChanges} from \"./chain-id-watcher\"\n\nexport function isAndroid() {\n  return (\n    typeof navigator !== \"undefined\" && /android/i.test(navigator.userAgent)\n  )\n}\n\nexport function isSmallIOS() {\n  return (\n    typeof navigator !== \"undefined\" && /iPhone|iPod/.test(navigator.userAgent)\n  )\n}\n\nexport function isLargeIOS() {\n  return typeof navigator !== \"undefined\" && /iPad/.test(navigator.userAgent)\n}\n\nexport function isIOS() {\n  return isSmallIOS() || isLargeIOS()\n}\n\nexport function isMobile() {\n  return isAndroid() || isIOS()\n}\n","import {config} from \"@onflow/config\"\nimport {setChainIdDefault, watchForChainIdChanges} from \"./utils\"\n\nconst isServerSide = () => typeof window === \"undefined\"\n\nconst SESSION_STORAGE = {\n  can: !isServerSide(),\n  get: async key => JSON.parse(sessionStorage.getItem(key)),\n  put: async (key, value) => sessionStorage.setItem(key, JSON.stringify(value)),\n}\n\nconfig({\n  \"discovery.wallet.method.default\": \"IFRAME/RPC\",\n  \"fcl.storage.default\": SESSION_STORAGE,\n})\n\n// Set chain id default on access node change\nwatchForChainIdChanges()\n\nexport async function configLens(regex) {\n  return Object.fromEntries(\n    Object.entries(await config().where(regex)).map(([key, value]) => [\n      key.replace(regex, \"\"),\n      value,\n    ])\n  )\n}\n","export const VERSION = PACKAGE_CURRENT_VERSION || \"TESTVERSION\"\n","const is = type => d => typeof d === type\n\nexport const isRequired = d => d != null\nexport const isObject = is(\"object\")\nexport const isString = is(\"string\")\nexport const isFunc = is(\"function\")\nexport const isNumber = is(\"number\")\n","import {isFunc} from \"./is\"\nimport * as sdk from \"@onflow/sdk\"\nimport * as t from \"@onflow/types\"\n\nexport function normalizeArgs(ax) {\n  if (isFunc(ax)) return ax(sdk.arg, t)\n  return []\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport fetchTransport from \"cross-fetch\"\nimport {config} from \"@onflow/config\"\n\nasync function httpDocumentResolver({url}) {\n  invariant(\n    typeof url !== \"undefined\",\n    \"retrieve({ url }) -- url must be defined\"\n  )\n\n  let res\n  try {\n    res = await fetchTransport(url)\n  } catch (e) {\n    throw new Error(\"httpDocumentResolver Error: Failed to retrieve document.\")\n  }\n\n  let document = res.ok ? await res.json() : null\n\n  return document\n}\n\nconst DOCUMENT_RESOLVERS = new Map([\n  [\"http\", httpDocumentResolver],\n  [\"https\", httpDocumentResolver],\n])\n\nexport async function retrieve({url}) {\n  invariant(\n    typeof url !== \"undefined\",\n    \"retrieve({ url }) -- url must be defined\"\n  )\n  invariant(\n    typeof url === \"string\",\n    \"retrieve({ url }) -- url must be a string\"\n  )\n\n  const documentResolversFromConfig = await config().where(\n    /^document\\.resolver\\./\n  )\n  Object.keys(documentResolversFromConfig).map(key => {\n    const resolverFromConfig = documentResolversFromConfig[key]\n    const resolverProtocol = key.replace(/^document\\.resolver\\./, \"\")\n    DOCUMENT_RESOLVERS.set(resolverProtocol, resolverFromConfig)\n  })\n\n  const urlParts = /^(.*):\\/\\/([A-Za-z0-9\\-\\.]+)(:[0-9]+)?(.*)$/.exec(url)\n  invariant(urlParts, \"Failed to parse URL\")\n  const protocol = urlParts[1]\n  invariant(urlParts, \"Failed to parse URL protocol\")\n\n  const resolver = DOCUMENT_RESOLVERS.get(protocol)\n  invariant(resolver, `No resolver found for protcol=${protocol}`)\n\n  let document = await resolver({url})\n\n  return document\n}\n","export function normalizeInteractionTemplate(template) {\n  if (template == null) return null\n\n  switch (template[\"f_version\"]) {\n    case \"1.0.0\":\n      return template\n\n    default:\n      throw new Error(\n        \"normalizeInteractionTemplate Error: Invalid InteractionTemplate\"\n      )\n  }\n}\n","import {invariant} from \"@onflow/sdk\"\nimport {normalizeInteractionTemplate} from \"../normalizers/interaction-template/interaction-template\"\n\n/**\n * @description Fills import addresses in Cadence for network\n * \n * @param {object} params\n * @param {string} params.network - Network to derive Cadence for\n * @param {object} params.template - Interaction Template to derive Cadence from\n * @returns {string} - Cadence\n */\nexport function deriveCadenceByNetwork({network, template}) {\n  invariant(\n    network != undefined,\n    \"deriveCadenceByNetwork({ network }) -- network must be defined\"\n  )\n  invariant(\n    typeof network === \"string\",\n    \"deriveCadenceByNetwork({ network }) -- network must be a string\"\n  )\n\n  invariant(\n    template != undefined,\n    \"generateDependencyPin({ template }) -- template must be defined\"\n  )\n  invariant(\n    typeof template === \"object\",\n    \"generateDependencyPin({ template }) -- template must be an object\"\n  )\n  invariant(\n    template.f_type === \"InteractionTemplate\",\n    \"generateDependencyPin({ template }) -- template must be an InteractionTemplate\"\n  )\n\n  template = normalizeInteractionTemplate(template)\n\n  switch (template.f_version) {\n    case \"1.0.0\":\n      let networkDependencies = Object.keys(template?.data?.dependencies).map(\n        dependencyPlaceholder => {\n          let dependencyNetworkContracts = Object.values(\n            template?.data?.dependencies?.[dependencyPlaceholder]\n          )\n\n          invariant(\n            dependencyNetworkContracts,\n            `deriveCadenceByNetwork -- Could not find contracts for dependency placeholder: ${dependencyPlaceholder}`\n          )\n\n          invariant(\n            dependencyNetworkContracts.length === 0,\n            `deriveCadenceByNetwork -- Could not find contracts for dependency placeholder: ${dependencyPlaceholder}`\n          )\n\n          let dependencyContract = dependencyNetworkContracts[0]\n          let dependencyContractForNetwork = dependencyContract?.[network]\n\n          invariant(\n            dependencyContractForNetwork,\n            `deriveCadenceByNetwork -- Could not find ${network} network information for dependency: ${dependencyPlaceholder}`\n          )\n\n          return [dependencyPlaceholder, dependencyContractForNetwork.address]\n        }\n      )\n\n      return networkDependencies.reduce((cadence, [placeholder, address]) => {\n        const regex = new RegExp(\"(\\\\b\" + placeholder + \"\\\\b)\", \"g\")\n        return cadence.replace(regex, address)\n      }, template.data.cadence)\n\n    default:\n      throw new Error(\n        \"deriveCadenceByNetwork Error: Unsupported template version\"\n      )\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport {withPrefix} from \"@onflow/util-address\"\nimport {getChainId} from \"../../utils\"\n\nexport async function deriveDependencies({template}) {\n  const network = await getChainId()\n\n  invariant(\n    network,\n    \"FCL configureDependencies Error: Missing configuration value for 'flow.network'\"\n  )\n\n  const derivedDependencies = {}\n\n  switch (template[\"f_version\"]) {\n    case \"1.0.0\":\n      const dependencyPlaceholderKeys = Object.keys(\n        template?.data?.dependencies\n      )\n      for (let dependencyPlaceholderKey of dependencyPlaceholderKeys) {\n        let dependencyPlaceholder =\n          template?.data?.dependencies[dependencyPlaceholderKey]\n\n        const dependencyPlaceholderContractsKeys = Object.keys(\n          dependencyPlaceholder\n        )\n        invariant(\n          dependencyPlaceholderContractsKeys.length > 0,\n          `FCL configureDependencies Error: No contracts found in template for placeholder=${dependencyPlaceholderKey}`\n        )\n        const dependencyPlaceholderContract =\n          dependencyPlaceholder[dependencyPlaceholderContractsKeys[0]]\n        const dependency = dependencyPlaceholderContract[network]\n\n        invariant(\n          dependency,\n          `FCL configureDependencies Error: No dependency information for placeholder=${dependencyPlaceholderKey} contract=${dependencyPlaceholderContractsKeys[0]} network=${network}`\n        )\n        invariant(\n          dependency?.address,\n          `FCL configureDependencies Error: No address information for placeholder=${dependencyPlaceholderKey} contract=${dependencyPlaceholderContractsKeys[0]} network=${network}`\n        )\n\n        derivedDependencies[dependencyPlaceholderKey] = withPrefix(\n          dependency?.address\n        )\n      }\n\n      return derivedDependencies\n\n    default:\n      throw new Error(\n        \"FCL configureDependencies Error: Unsupported template version\"\n      )\n  }\n}\n","import {retrieve} from \"../../document/document.js\"\nimport {normalizeInteractionTemplate} from \"../../normalizers/interaction-template/interaction-template\"\nimport {deriveCadenceByNetwork} from \"../../interaction-template-utils/derive-cadence-by-network.js\"\nimport {deriveDependencies} from \"./derive-dependencies\"\nimport {isString} from \"./is\"\nimport {getChainId} from \"../../utils\"\n\nexport async function prepTemplateOpts(opts) {\n  if (isString(opts?.template)) {\n    opts.template = await retrieve({url: opts?.template})\n  }\n\n  let dependencies = {}\n  if (opts?.template) {\n    opts.template = normalizeInteractionTemplate(opts?.template)\n    dependencies = await deriveDependencies({template: opts.template})\n  }\n\n  const cadence =\n    opts.cadence ||\n    deriveCadenceByNetwork({\n      template: opts.template,\n      network: await getChainId(),\n    })\n\n  opts.cadence = cadence\n  opts.dependencies = dependencies\n\n  return opts\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport * as sdk from \"@onflow/sdk\"\nimport {isRequired, isObject, isString} from \"./is\"\n\nasync function pre(type, opts) {\n  // prettier-ignore\n  invariant(isRequired(opts), `${type}(opts) -- opts is required`)\n  // prettier-ignore\n  invariant(isObject(opts), `${type}(opts) -- opts must be an object`)\n  // prettier-ignore\n  invariant(!(opts.cadence && opts.template), `${type}({ template, cadence }) -- cannot pass both cadence and template`)\n  // prettier-ignore\n  invariant(isRequired(opts.cadence || opts?.template), `${type}({ cadence }) -- cadence is required`)\n  // // prettier-ignore\n  invariant(\n    isString(opts.cadence) || opts?.template,\n    `${type}({ cadence }) -- cadence must be a string`\n  )\n  // prettier-ignore\n  invariant(\n    opts.cadence || (await sdk.config().get(\"flow.network\")),\n    `${type}(opts) -- Required value for \"flow.network\" not defined in config. See: ${\"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"}`\n  )\n  // prettier-ignore\n  invariant(\n    await sdk.config().get(\"accessNode.api\"),\n    `${type}(opts) -- Required value for \"accessNode.api\" not defined in config. See: ${\"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"}`\n  )\n}\n\nexport async function preMutate(opts) {\n  return pre(\"mutate\", opts)\n}\n\nexport async function preQuery(opts) {\n  return pre(\"query\", opts)\n}\n","import * as sdk from \"@onflow/sdk\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\nimport {prepTemplateOpts} from \"./utils/prep-template-opts.js\"\nimport {preQuery} from \"./utils/pre.js\"\n\n/**\n * @description\n * Allows you to submit scripts to query the blockchain.\n *\n *  @param {object} opts - Query Options and configuration\n *  @param {string} opts.cadence - Cadence Script used to query Flow\n *  @param {import(\"../fcl\").ArgsFn} [opts.args] - Arguments passed to cadence script\n *  @param {object} [opts.template] - Interaction Template for a script\n *  @param {number} [opts.limit]   - Compute Limit for Query\n *  @returns {Promise}\n *\n *  @example\n *    const cadence = `\n *      cadence: `\n *        pub fun main(a: Int, b: Int, c: Address): Int {\n *          log(c)\n *          return a + b\n *        }\n *    `.trim()\n *\n *    const args = (arg, t) => [\n *      arg(5, t.Int),\n *      arg(7, t.Int),\n *      arg(\"0xb2db43ad6bc345fec9\", t.Address),\n *    ]\n *\n *    await query({ cadence, args })\n */\nexport async function query(opts = {}) {\n  await preQuery(opts)\n  opts = await prepTemplateOpts(opts)\n\n  return sdk.config().overload(opts.dependencies || {}, async () =>\n    // prettier-ignore\n    sdk.send([\n      sdk.script(opts.cadence),\n      sdk.args(normalizeArgs(opts.args || [])),\n      opts.limit && typeof opts.limit === \"number\" && sdk.limit(opts.limit)\n    ]).then(sdk.decode)\n  )\n}\n","export async function fetchServices(servicesURL, code) {\n  if (servicesURL == null || code == null) return []\n\n  const url = new URL(servicesURL)\n  url.searchParams.append(\"code\", code)\n\n  const resp = await fetch(url, {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  }).then(d => d.json())\n\n  if (Array.isArray(resp)) return resp\n\n  // Backwards compatibility for First-Gen Wallet Providers\n  const services = []\n\n  // Convert authorizations into authz services\n  if (Array.isArray(resp.authorizations)) {\n    for (let service of resp.authorizations) {\n      services.push({\n        type: \"authz\",\n        keyId: resp.keyId,\n        ...service,\n      })\n    }\n  }\n\n  // Convert Provider info into an authn service\n  if (resp.provider != null) {\n    services.push({\n      type: \"authn\",\n      id: \"wallet-provider#authn\",\n      ...resp.provider,\n    })\n  }\n\n  return services\n}\n","import {withPrefix} from \"@onflow/util-address\"\n\nexport function mergeServices(sx1 = [], sx2 = []) {\n  // TODO: Make this smarter\n  return [...sx1, ...sx2]\n}\n","export const SERVICE_PRAGMA = {\n  f_type: \"Service\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const IDENTITY_PRAGMA = {\n  f_type: \"Identity\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const PROVIDER_PRAGMA = {\n  f_type: \"Provider\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const USER_PRAGMA = {\n  f_type: \"USER\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const POLLING_RESPONSE_PRAGMA = {\n  f_type: \"PollingResponse\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const COMPOSITE_SIGNATURE_PRAGMA = {\n  f_type: \"CompositeSignature\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const OPEN_ID_PRAGMA = {\n  f_type: \"OpenId\",\n  f_vsn: \"1.0.0\",\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"identity\": {\n//     \"address\": \"0x____\"\n//   },\n//   \"provider\": {\n//     \"address\": \"0x____\",\n//     \"name\": \"Best Wallet\",\n//     \"description\": \"The Best Wallet\"\n//     \"icon\": \"https://\",\n//   }\n// }\nexport function normalizeAuthn(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.authn,\n        id: service.pid,\n        provider: {\n          address: withPrefix(service.addr),\n          name: service.name,\n          icon: service.icon,\n        },\n      }\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeAuthz(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId,\n        },\n        params: service.params,\n        data: service.data,\n      }\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"pre-authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of pre-authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizePreAuthz(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId,\n        },\n        params: service.params,\n        data: service.data,\n      }\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"frame\",\n//    \"endpoint\": \"https://rawr\",\n//    \"data\": {},   // Sent to frame when ready\n//    \"params\": {}, // include in query params on frame\n// }\nexport function normalizeFrame(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        old: service,\n        ...SERVICE_PRAGMA,\n        type: \"frame\",\n        endpoint: service.endpoint,\n        params: service.params || {},\n        data: service.data || {},\n      }\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"back-channel-rpc\",\n//    \"endpoint\": \"https://rawr\",\n//    \"method\": \"HTTP/GET\", // HTTP/GET | HTTP/POST\n//    \"data\": {},           // included in body of rpc\n//    \"params\": {},         // included as query params on endpoint url\n// }\nexport function normalizeBackChannelRpc(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: \"back-channel-rpc\",\n        endpoint: service.endpoint,\n        method: service.method,\n        params: service.params || {},\n        data: service.data || {},\n      }\n  }\n}\n","import {SERVICE_PRAGMA, OPEN_ID_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"open-id\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"method: \"data\",\n//   \"data\": {\n//      \"profile\": {\n//        \"name\": \"Bob\",\n//        \"family_name\": \"Builder\",\n//        \"given_name\": \"Robert\",\n//        \"middle_name\": \"the\",\n//        \"nickname\": \"Bob the Builder\",\n//        \"perferred_username\": \"bob\",\n//        \"profile\": \"https://www.bobthebuilder.com/\",\n//        \"picture\": \"https://avatars.onflow.org/avatar/bob\",\n//        \"gender\": \"...\",\n//        \"birthday\": \"2001-01-18\",\n//        \"zoneinfo\": \"America/Vancouver\",\n//        \"locale\": \"en-us\",\n//        \"updated_at\": \"1614970797388\"\n//      },\n//      \"email\": {\n//        \"email\": \"bob@bob.bob\",\n//        \"email_verified\": true\n//      },\n//      \"address\": {\n//        \"address\": \"One Apple Park Way, Cupertino, CA 95014, USA\"\n//      },\n//      \"phone\": {\n//        \"phone_number\": \"+1 (xxx) yyy-zzzz\",\n//        \"phone_number_verified\": true\n//      },\n//      \"social\": {\n//        \"twitter\": \"@_qvvg\",\n//        \"twitter_verified\": true\n//      },\n//   }\n// }\nexport function normalizeOpenId(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"user-signature\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"IFRAME/RPC\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of user-signature request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeUserSignature(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(\"Invalid user-signature service\")\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    type: \"local-view\",\n//    method: \"VIEW/IFRAME\",\n//    endpoint: \"https://woot.org/authz/local\",\n//    data: {},\n//    params: {},\n// }\nexport function normalizeLocalView(resp) {\n  if (resp == null) return null\n  if (resp.method == null) {\n    resp = {...resp, type: \"local-view\", method: \"VIEW/IFRAME\"}\n  }\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: resp.type || \"local-view\",\n        method: resp.method,\n        endpoint: resp.endpoint,\n        data: resp.data || {},\n        params: resp.params || {},\n      }\n  }\n}\n","// {\n//   \"f_type\": \"Service\",                    // Its a service!\n//   \"f_vsn\": \"1.0.0\",                       // Follows the v1.0.0 spec for the service\n//   \"type\": \"account-proof\",                // the type of service it is\n//   \"method\": \"DATA\",                       // Its data!\n//   \"uid\": \"awesome-wallet#account-proof\",  // A unique identifier for the service\n//   \"data\": {\n//     \"f_type\": \"account-proof\",\n//     \"f_vsn\": \"1.0.0\",\n//     \"nonce\": \"0A1BC2FF\",                  // Nonce signed by the current account-proof (minimum 32 bytes in total, i.e 64 hex characters)\n//     \"address\": \"0xUSER\",                  // The user's address (8 bytes, i.e 16 hex characters)\n//     \"signature\": CompositeSignature,      // address (sans-prefix), keyId, signature (hex)\n// }\n\nexport function normalizeAccountProof(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(`FCL Normalizer Error: Invalid account-proof service`)\n  }\n}\n","// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn-refresh\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\",  // \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeAuthnRefresh(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(\"Invalid authn-refresh service\")\n  }\n}\n","import {normalizeAuthn} from \"./authn\"\nimport {normalizeAuthz} from \"./authz\"\nimport {normalizePreAuthz} from \"./pre-authz\"\nimport {normalizeFrame} from \"./frame\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeOpenId} from \"./open-id\"\nimport {normalizeUserSignature} from \"./user-signature\"\nimport {normalizeLocalView} from \"./local-view\"\nimport {normalizeAccountProof} from \"./account-proof\"\nimport {normalizeAuthnRefresh} from \"./authn-refresh\"\n\nexport function normalizeServices(services, data) {\n  return services.map(service => normalizeService(service, data))\n}\n\nconst serviceNormalizers = {\n  \"back-channel-rpc\": normalizeBackChannelRpc,\n  \"pre-authz\": normalizePreAuthz,\n  authz: normalizeAuthz,\n  authn: normalizeAuthn,\n  frame: normalizeFrame,\n  \"open-id\": normalizeOpenId,\n  \"user-signature\": normalizeUserSignature,\n  \"local-view\": normalizeLocalView,\n  \"account-proof\": normalizeAccountProof,\n  \"authn-refresh\": normalizeAuthnRefresh,\n}\n\nexport function normalizeService(service, data) {\n  try {\n    var normalized = serviceNormalizers[service.type](service, data)\n    return normalized\n  } catch (error) {\n    console.error(\n      `Unrecognized FCL Service Type [${service.type}]`,\n      service,\n      error\n    )\n    return service\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport * as rlp from \"@onflow/rlp\"\nimport {fetchServices} from \"./fetch-services\"\nimport {mergeServices} from \"./merge-services\"\nimport {USER_PRAGMA} from \"../normalizers/service/__vsn\"\nimport {normalizeService} from \"../normalizers/service/service\"\n\nfunction deriveCompositeId(authn) {\n  return rlp\n    .encode([\n      authn.provider.address || authn.provider.name || \"UNSPECIFIED\",\n      authn.id,\n    ])\n    .toString(\"hex\")\n}\n\nfunction normalizeData(data) {\n  data.addr = data.addr ? withPrefix(data.addr) : null\n  data.paddr = data.paddr ? withPrefix(data.paddr) : null\n  return data\n}\n\nfunction findService(type, services) {\n  return services.find(d => d.type === type)\n}\n\nexport async function buildUser(data) {\n  data = normalizeData(data)\n\n  var services = mergeServices(\n    data.services || [],\n    await fetchServices(data.hks, data.code)\n  ).map(service => normalizeService(service, data))\n\n  const authn = findService(\"authn\", services)\n\n  return {\n    ...USER_PRAGMA,\n    addr: withPrefix(data.addr),\n    cid: deriveCompositeId(authn),\n    loggedIn: true,\n    services: services,\n    expiresAt: data.expires,\n  }\n}\n","export function serviceOfType(services = [], type) {\n  return services.find(service => service.type === type)\n}\n","export function serviceEndpoint(service) {\n  const url = new URL(service.endpoint)\n  if (window?.location?.origin) {\n    url.searchParams.append(\"l6n\", window.location.origin)\n  }\n  if (service.params != null) {\n    for (let [key, value] of Object.entries(service.params || {})) {\n      url.searchParams.append(key, value)\n    }\n  }\n  return url\n}\n","import {serviceEndpoint} from \"./service-endpoint\"\n\nexport function fetchService(service, opts = {}) {\n  const method = opts.method || \"POST\"\n  const body =\n    method === \"GET\"\n      ? undefined\n      : JSON.stringify(opts.data || service.data || {})\n\n  return fetch(serviceEndpoint(service), {\n    method: method,\n    headers: {\n      ...(service.headers || {}),\n      ...(opts.headers || {}),\n      \"Content-Type\": \"application/json\",\n    },\n    body: body,\n  }).then(d => d.json())\n}\n","import {POLLING_RESPONSE_PRAGMA} from \"./__vsn\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeFrame} from \"./frame\"\n\n// {\n//    \"f_type\": \"PollingResponse\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"status\": \"PENDING\", // PENDING | APPROVED | DECLINED | REDIRECT\n//    \"reason\": null,      // Reason for Declining Transaction\n//    \"data\": null,        // Return value for APPROVED\n//    \"updates\": BackChannelRpc,\n//    \"local\": Frame,\n// }\nexport function normalizePollingResponse(resp) {\n  if (resp == null) return null\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...POLLING_RESPONSE_PRAGMA,\n        status: resp.status ?? \"APPROVED\",\n        reason: resp.reason ?? null,\n        data: resp.compositeSignature || resp.data || {...resp} || {},\n        updates: normalizeBackChannelRpc(resp.authorizationUpdates),\n        local: normalizeFrame((resp.local || [])[0]),\n      }\n  }\n}\n","import {normalizePollingResponse} from \"../../../../normalizers/service/polling-response\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {fetchService} from \"./fetch-service\"\n\nconst OPTIONS = {\n  \"HTTP/GET\": \"GET\",\n  \"HTTP/POST\": \"POST\",\n}\n\nconst serviceMethod = service => {\n  invariant(\n    OPTIONS[service.method],\n    \"Invalid Service Method for type back-channel-rpc\",\n    {service}\n  )\n  return OPTIONS[service.method]\n}\n\nconst serviceBody = service => {\n  if (service.method === \"HTTP/GET\") return undefined\n  if (service.method === \"HTTP/POST\" && service.data != null)\n    return JSON.stringify(service.data)\n  return undefined\n}\n\nexport async function poll(service, canContinue = () => true) {\n  invariant(service, \"Missing Polling Service\", {service})\n  if (!canContinue()) throw new Error(\"Externally Halted\")\n\n  let resp\n  try {\n    if (\n      typeof document !== \"undefined\" &&\n      document.visibilityState === \"hidden\"\n    ) {\n      await new Promise(r => setTimeout(r, 500))\n      return poll(service, canContinue)\n    }\n\n    resp = await fetchService(service, {\n      method: serviceMethod(service),\n    }).then(normalizePollingResponse)\n  } catch (error) {\n    throw error\n  }\n\n  switch (resp.status) {\n    case \"APPROVED\":\n      return resp.data\n    case \"DECLINED\":\n      throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n    default:\n      await new Promise(r => setTimeout(r, 500))\n      return poll(resp.updates, canContinue)\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\n\nconst FRAME = \"FCL_IFRAME\"\n\nconst FRAME_STYLES = `\n  position:fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  height: 100%;\n  width: 100vw;\n  display:block;\n  background:rgba(0,0,0,0.25);\n  z-index: 2147483647;\n  box-sizing: border-box;\n  color-scheme: light;\n`\n\nexport function renderFrame(src) {\n  invariant(\n    !document.getElementById(FRAME),\n    \"Attempt at triggering multiple Frames\",\n    {src}\n  )\n\n  const $frame = document.createElement(\"iframe\")\n  $frame.src = src\n  $frame.id = FRAME\n  $frame.allow = \"usb *; hid *\"\n  $frame.frameBorder = \"0\"\n  $frame.style.cssText = FRAME_STYLES\n  document.body.append($frame)\n\n  const unmount = () => {\n    if (document.getElementById(FRAME)) {\n      document.getElementById(FRAME).remove()\n    }\n  }\n\n  return [$frame.contentWindow, unmount]\n}\n","const POP = \"FCL_POP\"\n\nlet popup = null\nlet previousUrl = null\n\nfunction popupWindow(url, windowName, win, w, h) {\n  const y = win.top.outerHeight / 2 + win.top.screenY - h / 2\n  const x = win.top.outerWidth / 2 + win.top.screenX - w / 2\n  const popup = win.open(\n    url,\n    windowName,\n    `toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${w}, height=${h}, top=${y}, left=${x}`\n  )\n  if (!popup)\n    throw new Error(\"Popup failed to open (was it blocked by a popup blocker?)\")\n  return popup\n}\n\nexport function renderPop(src) {\n  if (popup == null || popup?.closed) {\n    popup = popupWindow(src, POP, window, 640, 770)\n  } else if (previousUrl !== src) {\n    popup.location.replace(src)\n    popup.focus()\n  } else {\n    popup.focus()\n  }\n\n  previousUrl = src\n\n  const unmount = () => {\n    if (popup && !popup.closed) {\n      popup.close()\n    }\n    popup = null\n  }\n\n  return [popup, unmount]\n}\n","const TAB = \"FCL_TAB\"\n\nlet tab = null\nlet previousUrl = null\n\nexport function renderTab(src) {\n  if (tab == null || tab?.closed) {\n    tab = window.open(src, \"_blank\")\n    if (!tab)\n      throw new Error(\"Tab failed to open (was it blocked by the browser?)\")\n  } else if (previousUrl !== src) {\n    tab.location.replace(src)\n    tab.focus()\n  } else {\n    tab.focus()\n  }\n\n  previousUrl = src\n\n  const unmount = () => {\n    if (tab && !tab.closed) {\n      tab.close()\n    }\n    tab = null\n  }\n\n  return [tab, unmount]\n}\n","import {renderFrame} from \"./strategies/utils/render-frame\"\nimport {renderPop} from \"./strategies/utils/render-pop\"\nimport {renderTab} from \"./strategies/utils/render-tab\"\nimport {serviceEndpoint} from \"./strategies/utils/service-endpoint\"\n\nconst VIEWS = {\n  \"VIEW/IFRAME\": renderFrame,\n  \"VIEW/POP\": renderPop,\n  \"VIEW/TAB\": renderTab,\n}\n\nexport async function execLocal(service, opts = {}) {\n  try {\n    return VIEWS[service.method](serviceEndpoint(service), opts)\n  } catch (error) {\n    console.error(\"execLocal({service, opts = {}})\", error, {service, opts})\n    throw error\n  }\n}\n","import {fetchService} from \"./utils/fetch-service\"\nimport {normalizePollingResponse} from \"../../../normalizers/service/polling-response\"\nimport {normalizeLocalView} from \"../../../normalizers/service/local-view\"\nimport {poll} from \"./utils/poll\"\nimport {execLocal} from \"../exec-local\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport async function execHttpPost({service, body, config, opts}) {\n  const resp = await fetchService(service, {\n    data: {\n      fclVersion: VERSION,\n      service: {\n        params: service.params,\n        data: service.data,\n        type: service.type,\n      },\n      config,\n      ...body,\n    },\n  }).then(normalizePollingResponse)\n\n  if (resp.status === \"APPROVED\") {\n    return resp.data\n  } else if (resp.status === \"DECLINED\") {\n    throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n  } else if (resp.status === \"REDIRECT\") {\n    return resp\n  } else if (resp.status === \"PENDING\") {\n    var canContinue = true\n    const [_, unmount] = await execLocal(normalizeLocalView(resp.local))\n\n    const close = () => {\n      try {\n        unmount()\n        canContinue = false\n      } catch (error) {\n        console.error(\"Frame Close Error\", error)\n      }\n    }\n\n    return poll(resp.updates, () => canContinue)\n      .then(serviceResponse => {\n        close()\n        return serviceResponse\n      })\n      .catch(error => {\n        console.error(error)\n        close()\n        throw error\n      })\n  } else {\n    console.error(`Auto Decline: Invalid Response`, {service, resp})\n    throw new Error(`Auto Decline: Invalid Response`)\n  }\n}\n","const CLOSE_EVENT = \"FCL:VIEW:CLOSE\"\nconst READY_EVENT = \"FCL:VIEW:READY\"\nconst RESPONSE_EVENT = \"FCL:VIEW:RESPONSE\"\n\nconst _ = e => typeof e === \"string\" && e.toLowerCase()\n\nconst IGNORE = new Set([\n  \"monetizationstart\",\n  \"monetizationpending\",\n  \"monetizationprogress\",\n  \"monetizationstop\",\n])\n\nconst deprecate = (was, want) =>\n  console.warn(\n    \"DEPRECATION NOTICE\",\n    `Received ${was}, please use ${want} for this and future versions of FCL`\n  )\n\nexport const buildMessageHandler =\n  ({close, send, onReady, onResponse, onMessage}) =>\n  e => {\n    try {\n      if (typeof e.data !== \"object\") return\n      if (IGNORE.has(e.data.type)) return\n      if (_(e.data.type) === _(CLOSE_EVENT)) close()\n      if (_(e.data.type) === _(READY_EVENT)) onReady(e, {send, close})\n      if (_(e.data.type) === _(RESPONSE_EVENT)) onResponse(e, {send, close})\n      onMessage(e, {send, close})\n\n      // Backwards Compatible\n      if (_(e.data.type) === _(\"FCL:FRAME:READY\")) {\n        deprecate(e.data.type, READY_EVENT)\n        onReady(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT)\n        onResponse(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:CLOSE\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n      //\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT)\n        onResponse(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL::AUTHZ_READY\")) {\n        deprecate(e.data.type, READY_EVENT)\n        onReady(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n      if (_(e.data.type) === _(\"FCL::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n    } catch (error) {\n      console.error(\"Frame Callback Error\", error)\n      close()\n    }\n  }\n","import {renderFrame} from \"./render-frame\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function frame(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage,\n  })\n  window.addEventListener(\"message\", handler)\n\n  const [$frame, unmount] = renderFrame(serviceEndpoint(service))\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Frame Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $frame.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Frame Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {frame} from \"./utils/frame\"\nimport {normalizePollingResponse} from \"../../../normalizers/service/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execIframeRPC({service, body, config, opts}) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const includeOlderJsonRpcCall = opts.includeOlderJsonRpcCall\n\n    frame(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            fclVersion: VERSION,\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n              deprecated: {\n                message:\n                  \"jsonrpc is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n              },\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {renderPop} from \"./render-pop\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function pop(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage,\n  })\n  window.addEventListener(\"message\", handler)\n\n  const [$pop, unmount] = renderPop(serviceEndpoint(service))\n\n  const timer = setInterval(function () {\n    if ($pop && $pop.closed) {\n      close()\n    }\n  }, 500)\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler)\n      clearInterval(timer)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Popup Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $pop.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Popup Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {pop} from \"./utils/pop\"\nimport {normalizePollingResponse} from \"../../../normalizers/service/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execPopRPC({service, body, config, opts}) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const {redir, includeOlderJsonRpcCall} = opts\n\n    pop(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {renderTab} from \"./render-tab\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function tab(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage,\n  })\n  window.addEventListener(\"message\", handler)\n\n  const [$tab, unmount] = renderTab(serviceEndpoint(service))\n  const timer = setInterval(function () {\n    if ($tab && $tab.closed) {\n      close()\n    }\n  }, 500)\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler)\n      clearInterval(timer)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Tab Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $tab.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Tab Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {tab} from \"./utils/tab\"\nimport {normalizePollingResponse} from \"../../../normalizers/service/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execTabRPC({service, body, config, opts}) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const {redir, includeOlderJsonRpcCall} = opts\n\n    tab(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function extension(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  const handler = buildMessageHandler({\n    close,\n    send,\n    onReady,\n    onResponse,\n    onMessage,\n  })\n  window.addEventListener(\"message\", handler)\n\n  send({service})\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", handler)\n      onClose()\n    } catch (error) {\n      console.error(\"Ext Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      window && window.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Ext Send Error\", msg, error)\n    }\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport {extension} from \"./utils/extension\"\nimport {normalizePollingResponse} from \"../../../normalizers/service/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execExtRPC({service, body, config, opts}) {\n  return new Promise((resolve, reject) => {\n    extension(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execExtRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {execHttpPost} from \"./strategies/http-post\"\nimport {execIframeRPC} from \"./strategies/iframe-rpc\"\nimport {execPopRPC} from \"./strategies/pop-rpc\"\nimport {execTabRPC} from \"./strategies/tab-rpc\"\nimport {execExtRPC} from \"./strategies/ext-rpc\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {LEVELS, log} from \"@onflow/util-logger\"\nimport {isRequired, isString, isObject, isFunc} from \"../../exec/utils/is\"\n\nconst CORE_STRATEGIES = {\n  \"HTTP/RPC\": execHttpPost,\n  \"HTTP/POST\": execHttpPost,\n  \"IFRAME/RPC\": execIframeRPC,\n  \"POP/RPC\": execPopRPC,\n  \"TAB/RPC\": execTabRPC,\n  \"EXT/RPC\": execExtRPC,\n}\n\nconst supportedPlugins = [\"ServicePlugin\"]\nconst supportedServicePlugins = [\"discovery-service\"]\n\nconst validateDiscoveryPlugin = servicePlugin => {\n  const {services, serviceStrategy} = servicePlugin\n  invariant(\n    Array.isArray(services) && services.length,\n    \"Array of Discovery Services is required\"\n  )\n\n  for (const ds of services) {\n    invariant(\n      isRequired(ds.f_type) && ds.f_type === \"Service\",\n      \"Service is required\"\n    )\n    invariant(\n      isRequired(ds.type) && ds.type === \"authn\",\n      `Service must be type authn. Received ${ds.type}`\n    )\n    invariant(\n      ds.method in CORE_STRATEGIES || serviceStrategy.method === ds.method,\n      `Service method ${ds.method} is not supported`\n    )\n  }\n\n  invariant(isRequired(serviceStrategy), \"Service strategy is required\")\n  invariant(\n    isRequired(serviceStrategy.method) && isString(serviceStrategy.method),\n    \"Service strategy method is required\"\n  )\n  invariant(\n    isRequired(serviceStrategy.exec) && isFunc(serviceStrategy.exec),\n    \"Service strategy exec function is required\"\n  )\n\n  return {discoveryServices: services, serviceStrategy}\n}\n\nconst ServiceRegistry = () => {\n  let services = new Set()\n  let strategies = new Map(Object.entries(CORE_STRATEGIES))\n\n  const add = servicePlugin => {\n    invariant(\n      supportedServicePlugins.includes(servicePlugin.type),\n      `Service Plugin type ${servicePlugin.type} is not supported`\n    )\n    if (servicePlugin.type === \"discovery-service\") {\n      const {discoveryServices, serviceStrategy} =\n        validateDiscoveryPlugin(servicePlugin)\n      setServices(discoveryServices)\n      if (!strategies.has(serviceStrategy.method)) {\n        strategies.set(serviceStrategy.method, serviceStrategy.exec)\n      } else {\n        log({\n          title: `Add Service Plugin`,\n          message: `Service strategy for ${serviceStrategy.method} already exists`,\n          level: LEVELS.warn,\n        })\n      }\n    }\n  }\n\n  const setServices = discoveryServices =>\n    (services = new Set([...discoveryServices]))\n\n  const getServices = () => [...services]\n\n  const getStrategy = method => strategies.get(method)\n\n  const getStrategies = () => [...strategies.keys()]\n\n  return Object.freeze({\n    add,\n    getServices,\n    getStrategy,\n    getStrategies,\n  })\n}\n\nconst validatePlugins = plugins => {\n  let pluginsArray\n  invariant(plugins, \"No plugins supplied\")\n\n  if (!Array.isArray(plugins)) {\n    pluginsArray = [plugins]\n  } else {\n    pluginsArray = [...plugins]\n  }\n  for (const p of pluginsArray) {\n    invariant(isRequired(p.name), \"Plugin name is required\")\n    invariant(isRequired(p.f_type), \"Plugin f_type is required\")\n    invariant(\n      supportedPlugins.includes(p.f_type),\n      `Plugin type ${p.f_type} is not supported`\n    )\n  }\n\n  return pluginsArray\n}\n\nconst PluginRegistry = () => {\n  const pluginsMap = new Map()\n\n  const getPlugins = () => pluginsMap\n\n  const add = plugins => {\n    const pluginsArray = validatePlugins(plugins)\n    for (const p of pluginsArray) {\n      pluginsMap.set(p.name, p)\n      if (p.f_type === \"ServicePlugin\") {\n        serviceRegistry.add(p)\n      }\n    }\n  }\n\n  return Object.freeze({\n    add,\n    getPlugins,\n  })\n}\n\nexport const serviceRegistry = ServiceRegistry()\nexport const pluginRegistry = PluginRegistry()\n","import {invariant} from \"@onflow/util-invariant\"\nimport {log, LEVELS} from \"@onflow/util-logger\"\nimport {serviceRegistry} from \"./plugins\"\nimport {getChainId} from \"../../utils\"\nimport {VERSION} from \"../../VERSION\"\nimport {configLens} from \"../../default-config\"\n\nconst execStrategy = async ({service, body, config, opts}) => {\n  const strategy = serviceRegistry.getStrategy(service.method)\n  return strategy({service, body, config, opts})\n}\n\nexport async function execService({service, msg = {}, config = {}, opts = {}}) {\n  msg.data = service.data\n  const execConfig = {\n    services: await configLens(/^service\\./),\n    app: await configLens(/^app\\.detail\\./),\n    client: {\n      ...config.client,\n      fclVersion: VERSION,\n      fclLibrary: \"https://github.com/onflow/fcl-js\",\n      hostname: window?.location?.hostname ?? null,\n      network: await getChainId(),\n    },\n  }\n\n  try {\n    const res = await execStrategy({\n      service,\n      body: msg,\n      config: execConfig,\n      opts,\n    })\n    if (res.status === \"REDIRECT\") {\n      invariant(\n        service.type === res.data.type,\n        \"Cannot shift recursive service type in execService\"\n      )\n      return await execService({\n        service: res.data,\n        msg,\n        config: execConfig,\n        opts,\n      })\n    } else {\n      return res\n    }\n  } catch (error) {\n    log({\n      title: `Error on execService ${service?.type}`,\n      message: error,\n      level: LEVELS.error,\n    })\n    throw error\n  }\n}\n","import {COMPOSITE_SIGNATURE_PRAGMA} from \"./__vsn\"\nimport {sansPrefix} from \"@onflow/util-address\"\n\n// {\n//    \"f_type\": \"CompositeSignature\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"addr\": \"_____\",         // sans-prefix\n//    \"signature\": \"adfe1234\", // hex\n//    \"keyId\": 3,\n// }\nexport function normalizeCompositeSignature(resp) {\n  if (resp == null) return null\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...COMPOSITE_SIGNATURE_PRAGMA,\n        addr: sansPrefix(resp.addr || resp.address),\n        signature: resp.signature || resp.sig,\n        keyId: resp.keyId,\n      }\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {serviceRegistry} from \"../current-user/exec-service/plugins\"\n\nexport const makeDiscoveryServices = async () => {\n  const extensionServices = window?.fcl_extensions || []\n  return [...extensionServices, ...serviceRegistry.getServices()]\n}\n\nexport async function getDiscoveryService(service) {\n  const discoveryAuthnInclude = await config.get(\"discovery.authn.include\", [])\n  const discoveryWalletMethod = await config.first([\n    \"discovery.wallet.method\",\n    \"discovery.wallet.method.default\",\n  ])\n  const method = service?.method ? service.method : discoveryWalletMethod\n  const endpoint =\n    service?.endpoint ??\n    (await config.first([\"discovery.wallet\", \"challenge.handshake\"]))\n\n  invariant(\n    endpoint,\n    `\n    If no service is passed to \"authenticate,\" then \"discovery.wallet\" must be defined in fcl config.\n    See: \"https://docs.onflow.org/fcl/reference/api/#setting-configuration-values\"\n    `\n  )\n\n  return {\n    ...service,\n    type: \"authn\",\n    endpoint,\n    method,\n    discoveryAuthnInclude,\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {serviceRegistry} from \"../current-user/exec-service/plugins\"\nimport {getChainId} from \"../utils\"\nimport {VERSION} from \"../VERSION\"\nimport {makeDiscoveryServices} from \"./utils\"\n\nexport async function getServices({types}) {\n  const endpoint = await config.get(\"discovery.authn.endpoint\")\n  invariant(\n    Boolean(endpoint),\n    `\"discovery.authn.endpoint\" in config must be defined.`\n  )\n\n  const include = await config.get(\"discovery.authn.include\", [])\n  const url = new URL(endpoint)\n\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      type: types,\n      fclVersion: VERSION,\n      include,\n      clientServices: await makeDiscoveryServices(),\n      supportedStrategies: serviceRegistry.getStrategies(),\n      userAgent: window?.navigator?.userAgent,\n      network: await getChainId(),\n    }),\n  }).then(d => d.json())\n}\n","import {\n  spawn,\n  subscriber,\n  snapshoter,\n  INIT,\n  SUBSCRIBE,\n  UNSUBSCRIBE,\n  send,\n} from \"@onflow/util-actor\"\nimport {getServices} from \"../services\"\nimport {LEVELS, log} from \"@onflow/util-logger\"\n\nexport const SERVICE_ACTOR_KEYS = {\n  AUTHN: \"authn\",\n  RESULTS: \"results\",\n  SNAPSHOT: \"SNAPSHOT\",\n  UPDATED: \"UPDATED\",\n  UPDATE_RESULTS: \"UPDATE_RESULTS\",\n}\n\nconst warn = (fact, msg) => {\n  if (fact) {\n    console.warn(\n      `\n      %cFCL Warning\n      ============================\n      ${msg}\n      For more info, please see the docs: https://docs.onflow.org/fcl/\n      ============================\n      `,\n      \"font-weight:bold;font-family:monospace;\"\n    )\n  }\n}\n\nconst fetchServicesFromDiscovery = async () => {\n  try {\n    const services = await getServices({types: [SERVICE_ACTOR_KEYS.AUTHN]})\n    send(SERVICE_ACTOR_KEYS.AUTHN, SERVICE_ACTOR_KEYS.UPDATE_RESULTS, {\n      results: services,\n    })\n  } catch (error) {\n    log({\n      title: `${error.name} Error fetching Discovery API services.`,\n      message: error.message,\n      level: LEVELS.error,\n    })\n  }\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    warn(\n      typeof window === \"undefined\",\n      '\"fcl.discovery\" is only available in the browser.'\n    )\n    // If you call this before the window is loaded extensions will not be set yet\n    if (document.readyState === 'complete') {\n      fetchServicesFromDiscovery()\n    } else {\n      window.onload = async () => {\n        fetchServicesFromDiscovery()\n      }\n    }\n  },\n  [SERVICE_ACTOR_KEYS.UPDATE_RESULTS]: (ctx, _letter, data) => {\n    ctx.merge(data)\n    ctx.broadcast(SERVICE_ACTOR_KEYS.UPDATED, {...ctx.all()})\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, SERVICE_ACTOR_KEYS.UPDATED, {...ctx.all()})\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => ctx.unsubscribe(letter.from),\n  [SERVICE_ACTOR_KEYS.SNAPSHOT]: async (ctx, letter) =>\n    letter.reply({...ctx.all()}),\n}\n\nconst spawnProviders = () => spawn(HANDLERS, SERVICE_ACTOR_KEYS.AUTHN)\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Service} Service\n */\n\n/**\n * @callback SubscriptionCallback\n * @returns {Service[]}\n */\n\n/**\n * @description\n * Discovery methods for interacting with Authn.\n * \n * @typedef {object} Authn\n * @property {Function} subscribe - Subscribe to Discovery authn services\n * @property {Function} snapshot - Get the current Discovery authn services spanshot\n * @property {Function} update - Trigger an update of authn services\n */\nconst authn = {\n  /**\n   * @description - Subscribe to Discovery authn services\n   * @param {Function} cb\n   * @returns {SubscriptionCallback}\n   */\n  subscribe: cb => subscriber(SERVICE_ACTOR_KEYS.AUTHN, spawnProviders, cb),\n  /**\n   * @description - Get the current Discovery authn services spanshot\n   * @returns {Service[]}\n   */\n  snapshot: () => snapshoter(SERVICE_ACTOR_KEYS.AUTHN, spawnProviders),\n  /**\n   * @description - Trigger an update of authn services\n   * @returns {void}\n   */\n  update: () => fetchServicesFromDiscovery(),\n}\n\nexport default authn\n","import authn from \"./services/authn\"\nexport {getDiscoveryService, makeDiscoveryServices} from \"./utils\"\n\nconst discovery = {\n  authn,\n}\n\nexport {discovery}\n","import \"../default-config\"\nimport * as t from \"@onflow/types\"\nimport {account, arg} from \"@onflow/sdk\"\nimport {config} from \"@onflow/config\"\nimport {spawn, send, INIT, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {withPrefix, sansPrefix} from \"@onflow/util-address\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {log, LEVELS} from \"@onflow/util-logger\"\nimport {buildUser} from \"./build-user\"\nimport {serviceOfType} from \"./service-of-type\"\nimport {execService} from \"./exec-service\"\nimport {normalizeCompositeSignature} from \"../normalizers/service/composite-signature\"\nimport {getDiscoveryService, makeDiscoveryServices} from \"../discovery\"\nimport {serviceRegistry} from \"./exec-service/plugins\"\nimport {isMobile} from \"../utils\"\n\n/**\n * @typedef {import(\"@onflow/typedefs\").CurrentUser} CurrentUser\n * @typedef {import(\"@onflow/typedefs\").CompositeSignature} CompositeSignature\n */\n\nexport const isFn = d => typeof d === \"function\"\n\nconst NAME = \"CURRENT_USER\"\nconst UPDATED = \"CURRENT_USER/UPDATED\"\nconst SNAPSHOT = \"SNAPSHOT\"\nconst SET_CURRENT_USER = \"SET_CURRENT_USER\"\nconst DEL_CURRENT_USER = \"DEL_CURRENT_USER\"\n\nconst DATA = `{\n  \"f_type\": \"User\",\n  \"f_vsn\": \"1.0.0\",\n  \"addr\":null,\n  \"cid\":null,\n  \"loggedIn\":null,\n  \"expiresAt\":null,\n  \"services\":[]\n}`\n\nconst getStoredUser = async storage => {\n  const fallback = JSON.parse(DATA)\n  const stored = await storage.get(NAME)\n  if (stored != null && fallback[\"f_vsn\"] !== stored[\"f_vsn\"]) {\n    storage.removeItem(NAME)\n    return fallback\n  }\n  return stored || fallback\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    if (typeof window === \"undefined\") {\n      console.warn(\n        `\n        %cFCL Warning\n        ============================\n        \"currentUser\" is only available in the browser.\n        For more info, please see the docs: https://docs.onflow.org/fcl/\n        ============================\n        `,\n        \"font-weight:bold;font-family:monospace;\"\n      )\n    }\n\n    ctx.merge(JSON.parse(DATA))\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) {\n      const user = await getStoredUser(storage)\n      if (notExpired(user)) ctx.merge(user)\n    }\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, {...ctx.all()})\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply({...ctx.all()})\n  },\n  [SET_CURRENT_USER]: async (ctx, letter, data) => {\n    ctx.merge(data)\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) storage.put(NAME, ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n  [DEL_CURRENT_USER]: async (ctx, letter) => {\n    ctx.merge(JSON.parse(DATA))\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) storage.put(NAME, ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n}\n\nconst spawnCurrentUser = () => spawn(HANDLERS, NAME)\n\nfunction notExpired(user) {\n  return (\n    user.expiresAt == null ||\n    user.expiresAt === 0 ||\n    user.expiresAt > Date.now()\n  )\n}\n\nasync function getAccountProofData() {\n  let accountProofDataResolver = await config.get(\"fcl.accountProof.resolver\")\n  if (accountProofDataResolver == null) return\n  if (!isFn(accountProofDataResolver)) {\n    log({\n      title: \"Account Proof Data Resolver must be a function\",\n      message: `Check fcl.accountProof.resolver configuration.\n                Expected: fcl.accountProof.resolver: async () => { ... }\n                Received: fcl.accountProof.resolver: ${typeof accountProofDataResolver}\n                `,\n      level: LEVELS.warn,\n    })\n    return\n  }\n\n  const accountProofData = await accountProofDataResolver()\n  if (accountProofData == null) return\n\n  invariant(\n    typeof accountProofData.appIdentifier === \"string\",\n    \"appIdentifier must be a string\"\n  )\n  invariant(\n    /^[0-9a-f]+$/i.test(accountProofData.nonce),\n    \"Nonce must be a hex string\"\n  )\n\n  return accountProofData\n}\n\nconst makeConfig = async ({discoveryAuthnInclude}) => {\n  return {\n    client: {\n      discoveryAuthnInclude,\n      clientServices: await makeDiscoveryServices(),\n      supportedStrategies: serviceRegistry.getStrategies(),\n    },\n  }\n}\n\n/**\n * @description - Authenticate a user\n * @param {object} [opts] - Options\n * @param {object} [opts.service] - Optional service to use for authentication\n * @param {boolean} [opts.redir=false] - Optional flag to allow window to stay open after authentication\n * @returns {Promise<CurrentUser>} - User object\n */\nasync function authenticate({service, redir = false} = {}) {\n  if (\n    service &&\n    !service?.provider?.is_installed &&\n    service?.provider?.requires_install\n  ) {\n    window.location.href = service?.provider?.install_link\n    return\n  }\n\n  return new Promise(async (resolve, reject) => {\n    spawnCurrentUser()\n    const opts = {redir}\n    const user = await snapshot()\n    const discoveryService = await getDiscoveryService(service)\n    const refreshService = serviceOfType(user.services, \"authn-refresh\")\n    let accountProofData\n\n    if (user.loggedIn) {\n      if (refreshService) {\n        try {\n          const response = await execService({\n            service: refreshService,\n            msg: accountProofData,\n            opts,\n          })\n          send(NAME, SET_CURRENT_USER, await buildUser(response))\n        } catch (error) {\n          log({\n            title: `${error.name} Could not refresh wallet authentication.`,\n            message: error.message,\n            level: LEVELS.error,\n          })\n        } finally {\n          return resolve(await snapshot())\n        }\n      } else {\n        return resolve(user)\n      }\n    }\n\n    try {\n      accountProofData = await getAccountProofData()\n    } catch (error) {\n      log({\n        title: `${error.name} On Authentication: Could not resolve account proof data.`,\n        message: error.message,\n        level: LEVELS.error,\n      })\n      return reject(error)\n    }\n\n    try {\n      const response = await execService({\n        service: discoveryService,\n        msg: accountProofData,\n        config: await makeConfig(discoveryService),\n        opts,\n      })\n      send(NAME, SET_CURRENT_USER, await buildUser(response))\n    } catch (error) {\n      log({\n        title: `${error} On Authentication`,\n        message: error,\n        level: LEVELS.error,\n      })\n    } finally {\n      resolve(await snapshot())\n    }\n  })\n}\n\n/**\n * @description - Unauthenticate a user\n * @returns {void}\n */\nfunction unauthenticate() {\n  spawnCurrentUser()\n  send(NAME, DEL_CURRENT_USER)\n}\n\nconst normalizePreAuthzResponse = authz => ({\n  f_type: \"PreAuthzResponse\",\n  f_vsn: \"1.0.0\",\n  proposer: (authz || {}).proposer,\n  payer: (authz || {}).payer || [],\n  authorization: (authz || {}).authorization || [],\n})\n\nfunction resolvePreAuthz(authz) {\n  const resp = normalizePreAuthzResponse(authz)\n  const axs = []\n\n  if (resp.proposer != null) axs.push([\"PROPOSER\", resp.proposer])\n  for (let az of resp.payer || []) axs.push([\"PAYER\", az])\n  for (let az of resp.authorization || []) axs.push([\"AUTHORIZER\", az])\n\n  var result = axs.map(([role, az]) => ({\n    tempId: [az.identity.address, az.identity.keyId].join(\"|\"),\n    addr: az.identity.address,\n    keyId: az.identity.keyId,\n    signingFunction(signable) {\n      return execService({service: az, msg: signable})\n    },\n    role: {\n      proposer: role === \"PROPOSER\",\n      payer: role === \"PAYER\",\n      authorizer: role === \"AUTHORIZER\",\n    },\n  }))\n  return result\n}\n\n/**\n * @description\n * Produces the needed authorization details for the current user to submit transactions to Flow\n * It defines a signing function that connects to a user's wallet provider to produce signatures to submit transactions.\n * \n * @param {object} account - Account object\n * @returns {Promise<object>} - Account object with signing function\n */\nasync function authorization(account) {\n  spawnCurrentUser()\n\n  return {\n    ...account,\n    tempId: \"CURRENT_USER\",\n    async resolve(account, preSignable) {\n      const user = await authenticate({redir: true})\n      const authz = serviceOfType(user.services, \"authz\")\n      const preAuthz = serviceOfType(user.services, \"pre-authz\")\n\n      if (preAuthz)\n        return resolvePreAuthz(\n          await execService({\n            service: preAuthz,\n            msg: preSignable,\n          })\n        )\n      if (authz) {\n        let windowRef\n        if (isMobile() && authz.method === \"WC/RPC\") {\n          windowRef = window.open(\"\", \"_blank\")\n        }\n        return {\n          ...account,\n          tempId: \"CURRENT_USER\",\n          resolve: null,\n          addr: sansPrefix(authz.identity.address),\n          keyId: authz.identity.keyId,\n          sequenceNum: null,\n          signature: null,\n          async signingFunction(signable) {\n            return normalizeCompositeSignature(\n              await execService({\n                service: authz,\n                msg: signable,\n                opts: {\n                  includeOlderJsonRpcCall: true,\n                  windowRef,\n                },\n              })\n            )\n          },\n        }\n      }\n      throw new Error(\n        \"No Authz or PreAuthz Service configured for CURRENT_USER\"\n      )\n    },\n  }\n}\n\n/**\n * @description\n * The callback passed to subscribe will be called when the user authenticates and un-authenticates, making it easy to update the UI accordingly.\n * \n * @param {Function} callback - Callback function\n * @returns {Function} - Unsubscribe function\n */\nfunction subscribe(callback) {\n  spawnCurrentUser()\n  const EXIT = \"@EXIT\"\n  const self = spawn(async ctx => {\n    ctx.send(NAME, SUBSCRIBE)\n    while (1) {\n      const letter = await ctx.receive()\n      if (letter.tag === EXIT) {\n        ctx.send(NAME, UNSUBSCRIBE)\n        return\n      }\n      callback(letter.data)\n    }\n  })\n  return () => send(self, EXIT)\n}\n\n/**\n * @description - Gets the current user\n * @returns {Promise<CurrentUser>} - User object\n */\nfunction snapshot() {\n  spawnCurrentUser()\n  return send(NAME, SNAPSHOT, null, {expectReply: true, timeout: 0})\n}\n\nasync function info() {\n  spawnCurrentUser()\n  const {addr} = await snapshot()\n  if (addr == null) throw new Error(\"No Flow Address for Current User\")\n  return account(addr)\n}\n\n/**\n * @description - Resolves the current user as an argument\n * @returns {Promise<Function>}\n */\nasync function resolveArgument() {\n  const {addr} = await authenticate()\n  return arg(withPrefix(addr), t.Address)\n}\n\nconst makeSignable = msg => {\n  invariant(/^[0-9a-f]+$/i.test(msg), \"Message must be a hex string\")\n\n  return {\n    message: msg,\n  }\n}\n\n/**\n * @description - A method to use allowing the user to personally sign data via FCL Compatible Wallets/Services.\n * @param {string} msg - Message to sign\n * @returns {Promise<CompositeSignature[]>} - Array of CompositeSignatures\n */\nasync function signUserMessage(msg) {\n  spawnCurrentUser()\n  const user = await authenticate({redir: true})\n\n  const signingService = serviceOfType(user.services, \"user-signature\")\n\n  invariant(\n    signingService,\n    \"Current user must have authorized a signing service.\"\n  )\n\n  try {\n    const response = await execService({\n      service: signingService,\n      msg: makeSignable(msg),\n    })\n    if (Array.isArray(response)) {\n      return response.map(compSigs => normalizeCompositeSignature(compSigs))\n    } else {\n      return [normalizeCompositeSignature(response)]\n    }\n  } catch (error) {\n    return error\n  }\n}\n\nlet currentUser = () => {\n  return {\n    authenticate,\n    unauthenticate,\n    authorization,\n    signUserMessage,\n    subscribe,\n    snapshot,\n    resolveArgument,\n  }\n}\n\ncurrentUser.authenticate = authenticate\ncurrentUser.unauthenticate = unauthenticate\ncurrentUser.authorization = authorization\ncurrentUser.signUserMessage = signUserMessage\ncurrentUser.subscribe = subscribe\ncurrentUser.snapshot = snapshot\ncurrentUser.resolveArgument = resolveArgument\n\nexport {currentUser}\n","import * as sdk from \"@onflow/sdk\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\nimport {currentUser} from \"../current-user\"\nimport {prepTemplateOpts} from \"./utils/prep-template-opts.js\"\nimport {preMutate} from \"./utils/pre.js\"\nimport {isNumber} from \"./utils/is\"\n\n/**\n * @description\n * Allows you to submit transactions to the blockchain to potentially mutate the state.\n *\n *  @param {object} opts - Mutation Options and configuration\n *  @param {string} opts.cadence - Cadence Transaction used to mutate Flow\n *  @param {import(\"../fcl\").ArgsFn} [opts.args] - Arguments passed to cadence transaction\n *  @param {object} [opts.template] - Interaction Template for a transaction\n *  @param {number} [opts.limit] - Compute Limit for transaction\n *  @returns {Promise<string>} Transaction Id\n *\n * @example\n *    fcl.mutate({\n *      cadence: `\n *        transaction(a: Int, b: Int, c: Address) {\n *          prepare(acct: AuthAccount) {\n *            log(acct)\n *            log(a)\n *            log(b)\n *            log(c)\n *          }\n *        }\n *      `,\n *      args: (arg, t) => [\n *        arg(6, t.Int),\n *        arg(7, t.Int),\n *        arg(\"0xba1132bc08f82fe2\", t.Address),\n *      ],\n *    })\n *\n *\n *  Options:\n *    type Options = {\n *      template: InteractionTemplate | String // InteractionTemplate or url to one\n *      cadence: String!,\n *      args: (arg, t) => Array<Arg>,\n *      limit: Number,\n *      authz: AuthzFn, // will overload the trinity of signatory roles\n *      proposer: AuthzFn, // will overload the proposer signatory role\n *      payer: AuthzFn, // will overload the payer signatory role\n *      authorizations: [AuthzFn], // an array of authorization functions used as authorizations signatory roles\n *    }\n */\nexport async function mutate(opts = {}) {\n  var txid\n  try {\n    await preMutate(opts)\n    opts = await prepTemplateOpts(opts)\n\n    // Allow for a config to overwrite the authorization function.\n    // prettier-ignore\n    const authz = await sdk.config().get(\"fcl.authz\", currentUser().authorization)\n\n    txid = sdk.config().overload(opts.dependencies || {}, async () =>\n      // prettier-ignore\n      sdk.send([\n        sdk.transaction(opts.cadence),\n\n        sdk.args(normalizeArgs(opts.args || [])),\n\n        opts.limit && isNumber(opts.limit) && sdk.limit(opts.limit),\n\n        // opts.proposer > opts.authz > authz\n        sdk.proposer(opts.proposer || opts.authz || authz),\n\n        // opts.payer > opts.authz > authz\n        sdk.payer(opts.payer || opts.authz || authz),\n\n        // opts.authorizations > [opts.authz > authz]\n        sdk.authorizations(opts.authorizations || [opts.authz || authz]),\n      ]).then(sdk.decode)\n    )\n\n    return txid\n  } catch (error) {\n    throw error\n  }\n}\n","/**\n * @description\n * Listens for messages from FCL\n * \n * @param {string} messageType - Message type\n * @param {Function} cb - Callback function\n * @returns {Function} - Function to remove event listener\n */\nexport const onMessageFromFCL = (messageType, cb = () => {}) => {\n  const buildData = data => {\n    if (data.deprecated)\n      console.warn(\"DEPRECATION NOTICE\", data.deprecated.message)\n    delete data?.body?.interaction\n\n    return data\n  }\n\n  const internal = e => {\n    const {data} = e\n    if (typeof data !== \"object\") return\n    if (typeof data == null) return\n    if (data.type !== messageType) return\n\n    cb(buildData(data))\n  }\n\n  window.addEventListener(\"message\", internal)\n  return () => window.removeEventListener(\"message\", internal)\n}\n","import {onMessageFromFCL} from \"./on-message-from-fcl\"\n\n/**\n * @description\n * Sends message to FCL window\n * \n * @param {string} type - Message type\n * @param {object} msg - Message object\n * @returns {void}\n * \n * @example\n * sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n *    f_type: \"PollingResponse\",\n *    f_vsn: \"1.0.0\",\n *    status: \"APPROVED\",\n *    reason: null,\n *    data: data,\n *  })\n */\nexport const sendMsgToFCL = (type, msg = {}) => {\n  if (window.location !== window.parent.location) {\n    window.parent.postMessage({...msg, type}, \"*\")\n  } else if (window.opener) {\n    window.opener.postMessage({...msg, type}, \"*\")\n  } else {\n    throw new Error(\"Unable to communicate with parent FCL instance\")\n  }\n}\n\n/**\n * @description\n * Listens for \"FCL:VIEW:READY:RESPONSE\" and sends \"FCL:VIEW:READY\"\n * \n * @param {Function} cb - Callback function\n * @param {object} msg - Message object\n * @returns {void}\n */\nexport const ready = (cb, msg = {}) => {\n  onMessageFromFCL(\"FCL:VIEW:READY:RESPONSE\", cb)\n  sendMsgToFCL(\"FCL:VIEW:READY\")\n}\n\n/**\n * @description\n * Sends \"FCL:VIEW:CLOSE\"\n * \n * @returns {void}\n */\nexport const close = () => {\n  sendMsgToFCL(\"FCL:VIEW:CLOSE\")\n}\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"APPROVED\"\n * \n * @param {object} data - Data object\n * @returns {void}\n */\nexport const approve = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"APPROVED\",\n    reason: null,\n    data: data,\n  })\n}\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"DECLINED\"\n * \n * @param {string} reason - Reason for declining\n * @returns {void}\n */\nexport const decline = reason => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"DECLINED\",\n    reason: reason,\n    data: null,\n  })\n}\n\n/**\n * @description\n * Sends \"FCL:VIEW:RESPONSE\" with status \"REDIRECT\"\n * \n * @param {object} data - Data object\n * @returns {void}\n */\nexport const redirect = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"REDIRECT\",\n    reason: null,\n    data: data,\n  })\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {COMPOSITE_SIGNATURE_PRAGMA} from \"../normalizers/service/__vsn\"\n\n/**\n * @description\n * Constructs a new CompositeSignature instance.\n *\n * @param {string} addr - Flow Address\n * @param {number} keyId - Key ID\n * @param {string} signature - Signature as a hex string\n */\nexport function CompositeSignature(addr, keyId, signature) {\n  this.f_type = COMPOSITE_SIGNATURE_PRAGMA.f_type\n  this.f_vsn = COMPOSITE_SIGNATURE_PRAGMA.f_vsn\n  this.addr = withPrefix(addr)\n  this.keyId = Number(keyId)\n  this.signature = signature\n}\n","import {sansPrefix} from \"@onflow/util-address\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {Buffer, encode as rlpEncode} from \"@onflow/rlp\"\n\nconst rightPaddedHexBuffer = (value, pad) =>\n  Buffer.from(value.padEnd(pad * 2, \"0\"), \"hex\")\n\nconst leftPaddedHexBuffer = (value, pad) =>\n  Buffer.from(value.padStart(pad * 2, \"0\"), \"hex\")\n\nconst addressBuffer = addr => leftPaddedHexBuffer(addr, 8)\n\nconst nonceBuffer = nonce => Buffer.from(nonce, \"hex\")\n\nexport const encodeAccountProof = (\n  {address, nonce, appIdentifier},\n  includeDomainTag = true\n) => {\n  invariant(\n    address,\n    \"Encode Message For Provable Authn Error: address must be defined\"\n  )\n  invariant(\n    nonce,\n    \"Encode Message For Provable Authn Error: nonce must be defined\"\n  )\n  invariant(\n    appIdentifier,\n    \"Encode Message For Provable Authn Error: appIdentifier must be defined\"\n  )\n\n  invariant(\n    nonce.length >= 64,\n    \"Encode Message For Provable Authn Error: nonce must be minimum of 32 bytes\"\n  )\n\n  const ACCOUNT_PROOF_DOMAIN_TAG = rightPaddedHexBuffer(\n    Buffer.from(\"FCL-ACCOUNT-PROOF-V0.0\").toString(\"hex\"),\n    32\n  )\n\n  if (includeDomainTag) {\n    return Buffer.concat([\n      ACCOUNT_PROOF_DOMAIN_TAG,\n      rlpEncode([\n        appIdentifier,\n        addressBuffer(sansPrefix(address)),\n        nonceBuffer(nonce),\n      ]),\n    ]).toString(\"hex\")\n  }\n\n  return rlpEncode([\n    appIdentifier,\n    addressBuffer(sansPrefix(address)),\n    nonceBuffer(nonce),\n  ]).toString(\"hex\")\n}\n","export function injectExtService(service) {\n  if (service.type === \"authn\" && service.endpoint != null) {\n    if (!Array.isArray(window.fcl_extensions)) {\n      window.fcl_extensions = []\n    }\n    window.fcl_extensions.push(service)\n  } else {\n    console.warn(\"Authn service is required\")\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport {withPrefix, sansPrefix} from \"@onflow/util-address\"\nimport {query} from \"../exec/query\"\nimport {encodeAccountProof} from \"../wallet-utils\"\nimport {isString} from \"../exec/utils/is\"\nimport {getChainId} from \"../utils\"\n\nconst ACCOUNT_PROOF = \"ACCOUNT_PROOF\"\nconst USER_SIGNATURE = \"USER_SIGNATURE\"\n\nexport const validateArgs = args => {\n  if (args.appIdentifier) {\n    const {appIdentifier, address, nonce, signatures} = args\n    invariant(\n      isString(appIdentifier),\n      \"verifyAccountProof({ appIdentifier }) -- appIdentifier must be a string\"\n    )\n    invariant(\n      isString(address) && sansPrefix(address).length === 16,\n      \"verifyAccountProof({ address }) -- address must be a valid address\"\n    )\n    invariant(/^[0-9a-f]+$/i.test(nonce), \"nonce must be a hex string\")\n    invariant(\n      Array.isArray(signatures) &&\n        signatures.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"),\n      \"Must include an Array of CompositeSignatures to verify\"\n    )\n    invariant(\n      signatures.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]),\n      \"User signatures to be verified must be from a single account address\"\n    )\n    return true\n  } else {\n    const {message, address, compSigs} = args\n    invariant(\n      /^[0-9a-f]+$/i.test(message),\n      \"Signed message must be a hex string\"\n    )\n    invariant(\n      isString(address) && sansPrefix(address).length === 16,\n      \"verifyUserSignatures({ address }) -- address must be a valid address\"\n    )\n    invariant(\n      Array.isArray(compSigs) &&\n        compSigs.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"),\n      \"Must include an Array of CompositeSignatures to verify\"\n    )\n    invariant(\n      compSigs.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]),\n      \"User signatures to be verified must be from a single account address\"\n    )\n    return true\n  }\n}\n\n// TODO: pass in option for contract but we're connected to testnet\n// log address + network -> in sync?\nconst getVerifySignaturesScript = async (sig, opts) => {\n  const verifyFunction =\n    sig === \"ACCOUNT_PROOF\"\n      ? \"verifyAccountProofSignatures\"\n      : \"verifyUserSignatures\"\n\n  let network = await getChainId()\n\n  let fclCryptoContract\n\n  invariant(\n    opts.fclCryptoContract || network === \"testnet\" || network === \"mainnet\",\n    \"${verifyFunction}({ fclCryptoContract }) -- config.flow.network must be specified (testnet || mainnet) or contract address provided via opts.fclCryptoContract\"\n  )\n\n  if (opts.fclCryptoContract) {\n    fclCryptoContract = opts.fclCryptoContract\n  } else {\n    fclCryptoContract =\n      network === \"testnet\" ? \"0x74daa6f9c7ef24b1\" : \"0xb4b82a1c9d21d284\"\n  }\n\n  return `\n      import FCLCrypto from ${fclCryptoContract}\n\n      pub fun main(\n          address: Address, \n          message: String, \n          keyIndices: [Int], \n          signatures: [String]\n      ): Bool {\n        return FCLCrypto.${verifyFunction}(address: address, message: message, keyIndices: keyIndices, signatures: signatures)\n      }\n    `\n}\n\n/**\n * @description\n * Verify a valid account proof signature or signatures for an account on Flow.\n *\n * @param {string} appIdentifier - A message string in hexadecimal format\n * @param {object} accountProofData - An object consisting of address, nonce, and signatures\n * @param {string} accountProofData.address - A Flow account address\n * @param {string} accountProofData.nonce - A random string in hexadecimal format (minimum 32 bytes in total, i.e 64 hex characters)\n * @param {object[]} accountProofData.signatures - An array of composite signatures to verify\n * @param {object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override Flow account address where the FCLCrypto contract is deployed\n * @returns {Promise<boolean>} - Returns true if the signature is valid, false otherwise\n *\n * @example\n *\n *  const accountProofData = {\n *   address: \"0x123\",\n *   nonce: \"F0123\"\n *   signatures: [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *  }\n *\n *  const isValid = await fcl.AppUtils.verifyAccountProof(\n *    \"AwesomeAppId\",\n *    accountProofData,\n *    {fclCryptoContract}\n *  )\n */\nexport async function verifyAccountProof(\n  appIdentifier,\n  {address, nonce, signatures},\n  opts = {}\n) {\n  validateArgs({appIdentifier, address, nonce, signatures})\n  const message = encodeAccountProof({address, nonce, appIdentifier}, false)\n\n  let signaturesArr = []\n  let keyIndices = []\n\n  for (const el of signatures) {\n    signaturesArr.push(el.signature)\n    keyIndices.push(el.keyId.toString())\n  }\n\n  return query({\n    cadence: await getVerifySignaturesScript(ACCOUNT_PROOF, opts),\n    args: (arg, t) => [\n      arg(withPrefix(address), t.Address),\n      arg(message, t.String),\n      arg(keyIndices, t.Array(t.Int)),\n      arg(signaturesArr, t.Array(t.String)),\n    ],\n  })\n}\n\n/**\n * @description\n * Verify a valid signature/s for an account on Flow.\n *\n * @param {string} message - A message string in hexadecimal format\n * @param {Array} compSigs - An array of Composite Signatures\n * @param {string} compSigs[].addr - The account address\n * @param {number} compSigs[].keyId - The account keyId\n * @param {string} compSigs[].signature - The signature to verify\n * @param {object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override of Flow account address where the FCLCrypto contract is deployed\n * @returns {boolean} - Returns true if the signature is valid, false otherwise\n *\n * @example\n *\n *  const isValid = await fcl.AppUtils.verifyUserSignatures(\n *    Buffer.from('FOO').toString(\"hex\"),\n *    [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *    {fclCryptoContract}\n *  )\n */\nexport async function verifyUserSignatures(message, compSigs, opts = {}) {\n  const address = withPrefix(compSigs[0].addr)\n  validateArgs({message, address, compSigs})\n\n  let signaturesArr = []\n  let keyIndices = []\n\n  for (const el of compSigs) {\n    signaturesArr.push(el.signature)\n    keyIndices.push(el.keyId.toString())\n  }\n\n  return query({\n    cadence: await getVerifySignaturesScript(USER_SIGNATURE, opts),\n    args: (arg, t) => [\n      arg(address, t.Address),\n      arg(message, t.String),\n      arg(keyIndices, t.Array(t.Int)),\n      arg(signaturesArr, t.Array(t.String)),\n    ],\n  })\n}\n","import {log} from \"@onflow/util-logger\"\nimport {verifyUserSignatures as verify} from \"../app-utils\"\n\n/**\n * Verify a valid signature/s for an account on Flow.\n *\n * @deprecated since version '1.0.0-alpha.0', use AppUtils.verifyUserSignatures instead\n *\n */\nexport const verifyUserSignatures = log.deprecate({\n  pkg: \"FCL\",\n  subject: \"fcl.verifyUserSignatures()\",\n  message: \"Please use fcl.AppUtils.verifyUserSignatures()\",\n  callback: function verifyUserSignatures(message, compSigs) {\n    return verify(message, compSigs)\n  },\n})\n","import {interaction, pipe} from \"@onflow/sdk\"\nimport {resolve as defaultResolve} from \"@onflow/sdk\"\nimport {config, createSignableVoucher} from \"@onflow/sdk\"\n\nexport const serialize = async (args = [], opts = {}) => {\n  const resolveFunction = await config.first(\n    [\"sdk.resolve\"],\n    opts.resolve || defaultResolve\n  )\n\n  if (Array.isArray(args)) args = await pipe(interaction(), args)\n\n  return JSON.stringify(\n    createSignableVoucher(await resolveFunction(args)),\n    null,\n    2\n  )\n}\n","import \"../default-config\"\nimport {\n  spawn,\n  send,\n  subscriber,\n  snapshoter,\n  UPDATED,\n  SNAPSHOT,\n  INIT,\n  SUBSCRIBE,\n  UNSUBSCRIBE,\n  ERROR,\n} from \"@onflow/util-actor\"\nimport {send as fclSend, decode, getTransactionStatus} from \"@onflow/sdk\"\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Transaction} Transaction\n */\n\n/**\n * @typedef {import(\"@onflow/typedefs\").TransactionStatus} TransactionStatus\n */\n\nconst RATE = 2500\nconst POLL = \"POLL\"\n\nconst fetchTxStatus = async transactionId => {\n  return fclSend([getTransactionStatus(transactionId)]).then(decode)\n}\n\nconst isExpired = tx => tx.status === 5\nconst isSealed = tx => tx.status >= 4\nconst isExecuted = tx => tx.status >= 3\nconst isFinalized = tx => tx.status >= 2\nconst isPending = tx => tx.status >= 1\nconst isUnknown = tx => tx.status >= 0\n\nconst isDiff = (cur, next) => {\n  return JSON.stringify(cur) !== JSON.stringify(next)\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    ctx.sendSelf(POLL)\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, ctx.all())\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply(ctx.all())\n  },\n  [POLL]: async ctx => {\n    let tx\n    try {\n      tx = await fetchTxStatus(ctx.self())\n    } catch (e) {\n      return ctx.fatalError(e)\n    }\n\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    if (isDiff(ctx.all(), tx)) ctx.broadcast(UPDATED, tx)\n    ctx.merge(tx)\n  },\n}\n\nconst scoped = transactionId => {\n  if (typeof transactionId === \"object\")\n    transactionId = transactionId.transactionId\n  if (transactionId == null) throw new Error(\"transactionId required\")\n  return transactionId\n}\n\nconst spawnTransaction = transactionId => {\n  return spawn(HANDLERS, scoped(transactionId))\n}\n\n/**\n * @callback SubscriptionCallback\n * @param {TransactionStatus} txStatus\n * @returns {void}\n */\n\n/**\n * Provides methods for interacting with a transaction\n * \n * @param {string} transactionId - The transaction ID\n * @returns {{\n *    snapshot: function(): Promise<TransactionStatus>,\n *    subscribe: function(SubscriptionCallback): function(): void,\n *    onceFinalized: function(): Promise<TransactionStatus>,\n *    onceExecuted: function(): Promise<TransactionStatus>,\n *    onceSealed: function(): Promise<TransactionStatus>\n * }}\n */\nexport function transaction(transactionId) {\n  function snapshot() {\n    return snapshoter(transactionId, spawnTransaction)\n  }\n\n  function subscribe(callback) {\n    return subscriber(scoped(transactionId), spawnTransaction, callback)\n  }\n\n  function once(predicate) {\n    return function innerOnce(opts = {}) {\n      const suppress = opts.suppress || false\n      return new Promise((resolve, reject) => {\n        const unsub = subscribe((txStatus, error) => {\n          if ((error || txStatus.statusCode) && !suppress) {\n            reject(error || txStatus.errorMessage)\n            unsub()\n          } else if (predicate(txStatus)) {\n            resolve(txStatus)\n            unsub()\n          }\n        })\n      })\n    }\n  }\n\n  return {\n    snapshot,\n    subscribe,\n    onceFinalized: once(isFinalized),\n    onceExecuted: once(isExecuted),\n    onceSealed: once(isSealed),\n  }\n}\n\ntransaction.isUnknown = isUnknown\ntransaction.isPending = isPending\ntransaction.isFinalized = isFinalized\ntransaction.isExecuted = isExecuted\ntransaction.isSealed = isSealed\ntransaction.isExpired = isExpired\n","import {spawn, subscriber, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {\n  config,\n  block,\n  getEventsAtBlockHeightRange,\n  send,\n  decode,\n} from \"@onflow/sdk\"\n\nconst RATE = 10000\nconst UPDATED = \"UPDATED\"\nconst TICK = \"TICK\"\nconst HIGH_WATER_MARK = \"hwm\"\n\nconst scheduleTick = async ctx => {\n  return setTimeout(\n    () => ctx.sendSelf(TICK),\n    await config().get(\"fcl.eventPollRate\", RATE)\n  )\n}\n\nconst HANDLERS = {\n  [TICK]: async ctx => {\n    if (!ctx.hasSubs()) return\n    let hwm = ctx.get(HIGH_WATER_MARK)\n    if (hwm == null) {\n      ctx.put(HIGH_WATER_MARK, await block())\n      ctx.put(TICK, await scheduleTick(ctx))\n    } else {\n      let next = await block()\n      ctx.put(HIGH_WATER_MARK, next)\n      if (hwm.height < next.height) {\n        const data = await send([\n          getEventsAtBlockHeightRange(ctx.self(), hwm.height + 1, next.height),\n        ]).then(decode)\n        for (let d of data) ctx.broadcast(UPDATED, d.data)\n      }\n      ctx.put(TICK, await scheduleTick(ctx))\n    }\n  },\n  [SUBSCRIBE]: async (ctx, letter) => {\n    if (!ctx.hasSubs()) {\n      ctx.put(TICK, await scheduleTick(ctx))\n    }\n    ctx.subscribe(letter.from)\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n    if (!ctx.hasSubs()) {\n      clearTimeout(ctx.get(TICK))\n      ctx.delete(TICK)\n      ctx.delete(HIGH_WATER_MARK)\n    }\n  },\n}\n\nconst spawnEvents = key => spawn(HANDLERS, key)\n\n/**\n * @typedef {import(\"@onflow/typedefs\").Event} Event\n */\n\n/**\n * @typedef {object} SubscribeObject\n * @property {Function} subscribe - The subscribe function.\n */\n\n/**\n * @callback SubscriptionCallback\n * @returns {Event}\n */\n\n/**\n * @description - Subscribe to events\n * @param {string} key - A valid event name\n * @returns {SubscribeObject}\n * \n * @example\n * import * as fcl from \"@onflow/fcl\"\n * fcl.events(eventName).subscribe((event) => console.log(event))\n */\nexport function events(key) {\n  return {\n    /**\n     * @description - Subscribe to events\n     * @param {Function} callback - The callback function\n     * @returns {SubscriptionCallback}\n     */\n    subscribe: callback => subscriber(key, spawnEvents, callback),\n  }\n}\n","\"use strict\";var copy=function copy(I,i){return function(O,o){var oi=o*2;var ii=i*2;O[oi]=I[ii];O[oi+1]=I[ii+1]}};module.exports=copy;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _copy=_interopRequireDefault(require(\"../copy\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var chi=function chi(_ref){var A=_ref.A,C=_ref.C;for(var y=0;y<25;y+=5){for(var x=0;x<5;x++){(0,_copy[\"default\"])(A,y+x)(C,x)}for(var _x=0;_x<5;_x++){var xy=(y+_x)*2;var x1=(_x+1)%5*2;var x2=(_x+2)%5*2;A[xy]^=~C[x1]&C[x2];A[xy+1]^=~C[x1+1]&C[x2+1]}}};var _default=chi;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var ROUND_CONSTANTS=new Uint32Array([0,1,0,32898,2147483648,32906,2147483648,2147516416,0,32907,0,2147483649,2147483648,2147516545,2147483648,32777,0,138,0,136,0,2147516425,0,2147483658,0,2147516555,2147483648,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,0,32778,2147483648,2147483658,2147483648,2147516545,2147483648,32896,0,2147483649,2147483648,2147516424]);var _default=ROUND_CONSTANTS;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _roundConstants=_interopRequireDefault(require(\"./round-constants\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var iota=function iota(_ref){var A=_ref.A,roundIndex=_ref.roundIndex;var i=roundIndex*2;A[0]^=_roundConstants[\"default\"][i];A[1]^=_roundConstants[\"default\"][i+1]};var _default=iota;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var PI_SHUFFLES=[10,7,11,17,18,3,5,16,8,21,24,4,15,23,19,13,12,2,20,14,22,9,6,1];var _default=PI_SHUFFLES;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var RHO_OFFSETS=[1,3,6,10,15,21,28,36,45,55,2,14,27,41,56,8,25,43,62,18,39,61,20,44];var _default=RHO_OFFSETS;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _piShuffles=_interopRequireDefault(require(\"./pi-shuffles\"));var _rhoOffsets=_interopRequireDefault(require(\"./rho-offsets\"));var _copy=_interopRequireDefault(require(\"../copy\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var rhoPi=function rhoPi(_ref){var A=_ref.A,C=_ref.C,W=_ref.W;(0,_copy[\"default\"])(A,1)(W,0);var H=0;var L=0;var Wi=0;var ri=32;for(var i=0;i<24;i++){var j=_piShuffles[\"default\"][i];var r=_rhoOffsets[\"default\"][i];(0,_copy[\"default\"])(A,j)(C,0);H=W[0];L=W[1];ri=32-r;Wi=r<32?0:1;W[Wi]=H<<r|L>>>ri;W[(Wi+1)%2]=L<<r|H>>>ri;(0,_copy[\"default\"])(W,0)(A,j);(0,_copy[\"default\"])(C,0)(W,0)}};var _default=rhoPi;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _copy=_interopRequireDefault(require(\"../copy\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var theta=function theta(_ref){var A=_ref.A,C=_ref.C,D=_ref.D,W=_ref.W;var H=0;var L=0;for(var x=0;x<5;x++){var x20=x*2;var x21=(x+5)*2;var x22=(x+10)*2;var x23=(x+15)*2;var x24=(x+20)*2;C[x20]=A[x20]^A[x21]^A[x22]^A[x23]^A[x24];C[x20+1]=A[x20+1]^A[x21+1]^A[x22+1]^A[x23+1]^A[x24+1]}for(var _x=0;_x<5;_x++){(0,_copy[\"default\"])(C,(_x+1)%5)(W,0);H=W[0];L=W[1];W[0]=H<<1|L>>>31;W[1]=L<<1|H>>>31;D[_x*2]=C[(_x+4)%5*2]^W[0];D[_x*2+1]=C[(_x+4)%5*2+1]^W[1];for(var y=0;y<25;y+=5){A[(y+_x)*2]^=D[_x*2];A[(y+_x)*2+1]^=D[_x*2+1]}}};var _default=theta;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _chi=_interopRequireDefault(require(\"./chi\"));var _iota=_interopRequireDefault(require(\"./iota\"));var _rhoPi=_interopRequireDefault(require(\"./rho-pi\"));var _theta=_interopRequireDefault(require(\"./theta\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var permute=function permute(){var C=new Uint32Array(10);var D=new Uint32Array(10);var W=new Uint32Array(2);return function(A){for(var roundIndex=0;roundIndex<24;roundIndex++){(0,_theta[\"default\"])({A:A,C:C,D:D,W:W});(0,_rhoPi[\"default\"])({A:A,C:C,W:W});(0,_chi[\"default\"])({A:A,C:C});(0,_iota[\"default\"])({A:A,roundIndex:roundIndex})}C.fill(0);D.fill(0);W.fill(0)}};var _default=permute;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=void 0;var _buffer=require(\"buffer\");var _permute=_interopRequireDefault(require(\"./permute\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var xorWords=function xorWords(I,O){for(var i=0;i<I.length;i+=8){var o=i/4;O[o]^=I[i+7]<<24|I[i+6]<<16|I[i+5]<<8|I[i+4];O[o+1]^=I[i+3]<<24|I[i+2]<<16|I[i+1]<<8|I[i]}return O};var readWords=function readWords(I,O){for(var o=0;o<O.length;o+=8){var i=o/4;O[o]=I[i+1];O[o+1]=I[i+1]>>>8;O[o+2]=I[i+1]>>>16;O[o+3]=I[i+1]>>>24;O[o+4]=I[i];O[o+5]=I[i]>>>8;O[o+6]=I[i]>>>16;O[o+7]=I[i]>>>24}return O};var Sponge=function Sponge(_ref){var _this=this;var capacity=_ref.capacity,padding=_ref.padding;var keccak=(0,_permute[\"default\"])();var stateSize=200;var blockSize=capacity/8;var queueSize=stateSize-capacity/4;var queueOffset=0;var state=new Uint32Array(stateSize/4);var queue=_buffer.Buffer.allocUnsafe(queueSize);this.absorb=function(buffer){for(var i=0;i<buffer.length;i++){queue[queueOffset]=buffer[i];queueOffset+=1;if(queueOffset>=queueSize){xorWords(queue,state);keccak(state);queueOffset=0}}return _this};this.squeeze=function(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var output={buffer:options.buffer||_buffer.Buffer.allocUnsafe(blockSize),padding:options.padding||padding,queue:_buffer.Buffer.allocUnsafe(queue.length),state:new Uint32Array(state.length)};queue.copy(output.queue);for(var i=0;i<state.length;i++){output.state[i]=state[i]}output.queue.fill(0,queueOffset);output.queue[queueOffset]|=output.padding;output.queue[queueSize-1]|=128;xorWords(output.queue,output.state);for(var offset=0;offset<output.buffer.length;offset+=queueSize){keccak(output.state);readWords(output.state,output.buffer.slice(offset,offset+queueSize))}return output.buffer};this.reset=function(){queue.fill(0);state.fill(0);queueOffset=0;return _this};return this};var _default=Sponge;exports[\"default\"]=_default;","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports[\"default\"]=exports.SHAKE=exports.SHA3Hash=exports.SHA3=exports.Keccak=void 0;var _buffer=require(\"buffer\");var _sponge=_interopRequireDefault(require(\"./sponge\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{\"default\":obj}}var createHash=function createHash(_ref){var allowedSizes=_ref.allowedSizes,defaultSize=_ref.defaultSize,padding=_ref.padding;return function Hash(){var _this=this;var size=arguments.length>0&&arguments[0]!==undefined?arguments[0]:defaultSize;if(!this||this.constructor!==Hash){return new Hash(size)}if(allowedSizes&&!allowedSizes.includes(size)){throw new Error(\"Unsupported hash length\")}var sponge=new _sponge[\"default\"]({capacity:size});this.update=function(input){var encoding=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"utf8\";if(_buffer.Buffer.isBuffer(input)){sponge.absorb(input);return _this}if(typeof input===\"string\"){return _this.update(_buffer.Buffer.from(input,encoding))}throw new TypeError(\"Not a string or buffer\")};this.digest=function(){var formatOrOptions=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"binary\";var options=typeof formatOrOptions===\"string\"?{format:formatOrOptions}:formatOrOptions;var buffer=sponge.squeeze({buffer:options.buffer,padding:options.padding||padding});if(options.format&&options.format!==\"binary\"){return buffer.toString(options.format)}return buffer};this.reset=function(){sponge.reset();return _this};return this}};var Keccak=createHash({allowedSizes:[224,256,384,512],defaultSize:512,padding:1});exports.Keccak=Keccak;var SHA3=createHash({allowedSizes:[224,256,384,512],defaultSize:512,padding:6});exports.SHA3=SHA3;var SHAKE=createHash({allowedSizes:[128,256],defaultSize:256,padding:31});exports.SHAKE=SHAKE;var SHA3Hash=Keccak;exports.SHA3Hash=SHA3Hash;SHA3.SHA3Hash=SHA3Hash;var _default=SHA3;exports[\"default\"]=_default;","import {SHA3} from \"sha3\"\nimport {Buffer} from \"@onflow/rlp\"\n\nexport async function genHash(utf8String) {\n  const sha = new SHA3(256)\n  sha.update(Buffer.from(utf8String, \"utf8\"))\n  return sha.digest(\"hex\")\n}\n","import {invariant} from \"@onflow/sdk\"\nimport {encode as rlpEncode} from \"@onflow/rlp\"\nimport {genHash} from \"./utils/hash.js\"\nimport {normalizeInteractionTemplate} from \"../normalizers/interaction-template/interaction-template.js\"\n\n/**\n * @description Generates Interaction Template ID for a given Interaction Template\n *  \n * @param {object} params\n * @param {object} params.template - Interaction Template\n * @returns {Promise<string>} - Interaction Template ID\n */\nexport async function generateTemplateId({template}) {\n  invariant(\n    template != undefined,\n    \"generateTemplateId({ template }) -- template must be defined\"\n  )\n  invariant(\n    typeof template === \"object\",\n    \"generateTemplateId({ template }) -- template must be an object\"\n  )\n  invariant(\n    typeof template.f_type === \"InteractionTemplate\",\n    \"generateTemplateId({ template }) -- template object must be an InteractionTemplate\"\n  )\n\n  template = normalizeInteractionTemplate(template)\n\n  switch (template.f_version) {\n    case \"1.0.0\":\n      const templateData = template.data\n\n      const messages = await Promise.all(\n        Object.keys(templateData.messages).map(async messageKey => [\n          await genHash(messageKey),\n          await Promise.all(\n            Object.keys(templateData.messages?.[messageKey]?.i18n).map(\n              async i18nkeylanguage => [\n                await genHash(i18nkeylanguage),\n                await genHash(\n                  templateData.messages?.[messageKey]?.i18n?.[i18nkeylanguage]\n                ),\n              ]\n            )\n          ),\n        ])\n      )\n\n      const dependencies = await Promise.all(\n        Object.keys(templateData?.dependencies).map(\n          async dependencyAddressPlaceholder => [\n            await genHash(dependencyAddressPlaceholder),\n            await Promise.all(\n              Object.keys(\n                templateData?.dependencies?.[dependencyAddressPlaceholder]\n              ).map(async dependencyContract => [\n                await genHash(dependencyContract),\n                await Promise.all(\n                  Object.keys(\n                    templateData?.dependencies?.[\n                      dependencyAddressPlaceholder\n                    ]?.[dependencyContract]\n                  ).map(async dependencyContractNetwork => [\n                    await genHash(dependencyContractNetwork),\n                    [\n                      await genHash(\n                        templateData?.dependencies?.[\n                          dependencyAddressPlaceholder\n                        ]?.[dependencyContract]?.[dependencyContractNetwork]\n                          .address\n                      ),\n                      await genHash(\n                        templateData?.dependencies?.[\n                          dependencyAddressPlaceholder\n                        ]?.[dependencyContract]?.[dependencyContractNetwork]\n                          .contract\n                      ),\n                      await genHash(\n                        templateData?.dependencies?.[\n                          dependencyAddressPlaceholder\n                        ]?.[dependencyContract]?.[dependencyContractNetwork]\n                          .fq_address\n                      ),\n                      await genHash(\n                        templateData?.dependencies?.[\n                          dependencyAddressPlaceholder\n                        ]?.[dependencyContract]?.[dependencyContractNetwork].pin\n                      ),\n                      await genHash(\n                        String(\n                          templateData?.dependencies?.[\n                            dependencyAddressPlaceholder\n                          ]?.[dependencyContract]?.[dependencyContractNetwork]\n                            .pin_block_height\n                        )\n                      ),\n                    ],\n                  ])\n                ),\n              ])\n            ),\n          ]\n        )\n      )\n\n      const _arguments = await Promise.all(\n        Object.keys(templateData?.[\"arguments\"]).map(async argumentLabel => [\n          await genHash(argumentLabel),\n          [\n            await genHash(\n              String(templateData?.[\"arguments\"]?.[argumentLabel].index)\n            ),\n            await genHash(templateData?.[\"arguments\"]?.[argumentLabel].type),\n            await genHash(\n              templateData?.[\"arguments\"]?.[argumentLabel].balance || \"\"\n            ),\n            await Promise.all(\n              Object.keys(\n                templateData?.[\"arguments\"]?.[argumentLabel].messages\n              ).map(async argumentMessageKey => [\n                await genHash(argumentMessageKey),\n                await Promise.all(\n                  Object.keys(\n                    templateData?.[\"arguments\"]?.[argumentLabel].messages?.[\n                      argumentMessageKey\n                    ].i18n\n                  ).map(async i18nkeylanguage => [\n                    await genHash(i18nkeylanguage),\n                    await genHash(\n                      templateData?.[\"arguments\"]?.[argumentLabel].messages?.[\n                        argumentMessageKey\n                      ].i18n?.[i18nkeylanguage]\n                    ),\n                  ])\n                ),\n              ])\n            ),\n          ],\n        ])\n      )\n\n      const encodedHex = rlpEncode([\n        await genHash(\"InteractionTemplate\"),\n        await genHash(\"1.0.0\"),\n        await genHash(templateData?.type),\n        await genHash(templateData?.interface),\n        messages,\n        await genHash(templateData?.cadence),\n        dependencies,\n        _arguments,\n      ]).toString(\"hex\")\n\n      return genHash(encodedHex)\n\n    default:\n      throw new Error(\"generateTemplateId Error: Unsupported template version\")\n  }\n}\n","import {config, invariant} from \"@onflow/sdk\"\nimport {log, LEVELS} from \"@onflow/util-logger\"\nimport {query} from \"../exec/query.js\"\nimport {generateTemplateId} from \"./generate-template-id.js\"\nimport {normalizeInteractionTemplate} from \"../normalizers/interaction-template/interaction-template.js\"\nimport {getChainId} from \"../utils\"\n\n/**\n * @description Returns whether a set of auditors have audited a given Interaction Template\n * \n * @param {object} params\n * @param {object} params.template - Interaction Template\n * @param {Array<string>} params.auditors - Array of auditors\n * @param {object} opts\n * @param {string} opts.flowInteractionAuditContract - Flow Interaction Template Audit contract address\n * @returns {Promise<object>} - Object of auditor addresses and audit status\n */\nexport async function getInteractionTemplateAudits(\n  {template, auditors},\n  opts = {}\n) {\n  invariant(\n    template != undefined,\n    \"getInteractionTemplateAudits({ template }) -- template must be defined\"\n  )\n\n  template = normalizeInteractionTemplate(template)\n\n  invariant(\n    template.f_type === \"InteractionTemplate\",\n    \"getInteractionTemplateAudits({ template }) -- template must be an InteractionTemplate\"\n  )\n\n  // Recompute ID to be sure it matches\n  let recomputedTemplateID = await generateTemplateId({template})\n\n  if (recomputedTemplateID !== template.id) {\n    log({\n      title: \"getInteractionTemplateAudits Debug Error\",\n      message: `Could not recompute and match template ID\n                computed: ${recomputedTemplateID}\n                template: ${template.id}\n            `,\n      level: LEVELS.debug,\n    })\n    throw new Error(\n      \"getInteractionTemplateAudits Error: Could not recompute and match template ID\"\n    )\n  }\n\n  switch (template.f_version) {\n    case \"1.0.0\":\n      const _auditors = auditors || (await config().get(\"flow.auditors\"))\n\n      invariant(\n        _auditors,\n        \"getInteractionTemplateAudits Error: Required configuration for 'fcl.auditors' is not set\"\n      )\n      invariant(\n        Array.isArray(_auditors),\n        \"getInteractionTemplateAudits Error: Required configuration for 'fcl.auditors' is not an array\"\n      )\n\n      let FlowInteractionAuditContract = opts.flowInteractionAuditContract\n      if (!FlowInteractionAuditContract) {\n        const fclNetwork = await getChainId()\n        invariant(\n          fclNetwork === \"mainnet\" || fclNetwork === \"testnet\",\n          \"getInteractionTemplateAudits Error: Unable to determine address for FlowInteractionTemplateAudit contract. Set configuration for 'fcl.network' to 'mainnet' or 'testnet'\"\n        )\n        if (fclNetwork === \"mainnet\") {\n          FlowInteractionAuditContract = \"0xfd100e39d50a13e6\"\n        } else {\n          FlowInteractionAuditContract = \"0xf78bfc12d0a786dc\"\n        }\n      }\n\n      const audits = await query({\n        cadence: `\n        import FlowInteractionTemplateAudit from ${FlowInteractionAuditContract}\n        pub fun main(templateId: String, auditors: [Address]): {Address:Bool} {\n          return FlowInteractionTemplateAudit.getHasTemplateBeenAuditedByAuditors(templateId: templateId, auditors: auditors)\n        }\n        `,\n        args: (arg, t) => [\n          arg(recomputedTemplateID, t.String),\n          arg(_auditors, t.Array(t.Address)),\n        ],\n      })\n\n      return audits\n\n    default:\n      throw new Error(\n        \"getInteractionTemplateAudits Error: Unsupported template version\"\n      )\n  }\n}\n","export function generateImport({contractName, address}) {\n  return {contractName, address, contract: \"\"}\n}\n","import {generateImport} from \"./generate-import.js\"\n\nexport function findImports(cadence) {\n  let imports = []\n\n  let importsReg = /import ((\\w|,| )+)* from 0x\\w+/g\n  let fileImports = cadence.match(importsReg) || []\n\n  for (const fileImport of fileImports) {\n    const importLineReg = /import ((\\w+|, |)*) from (0x\\w+)/g\n    const importLine = importLineReg.exec(fileImport)\n\n    const contractsReg = /((?:\\w+)+),?/g\n    const contracts = importLine[1].match(contractsReg) || []\n\n    for (const contract of contracts) {\n      imports.push(\n        generateImport({\n          address: importLine[3],\n          contractName: contract.replace(/,/g, \"\"),\n        })\n      )\n    }\n  }\n\n  return imports\n}\n","import {\n  invariant,\n  block,\n  send,\n  getAccount,\n  atBlockHeight,\n  config,\n  decode,\n} from \"@onflow/sdk\"\nimport {genHash} from \"./utils/hash.js\"\nimport {findImports} from \"./utils/find-imports.js\"\nimport {generateImport} from \"./utils/generate-import.js\"\n\n/**\n * @description Produces a dependency pin for a contract at a given block height\n * @param {object} params\n * @param {string} params.address - The address of the account containing the contract\n * @param {string} params.contractName - The name of the contract\n * @param {number} params.blockHeight - The block height to produce the dependency pin for\n * @param {object} opts - Options to pass to the interaction\n * @returns {Promise<string>} - The dependency pin\n */\nexport async function generateDependencyPin(\n  {address, contractName, blockHeight},\n  opts = {}\n) {\n  invariant(\n    address != undefined,\n    \"generateDependencyPin({ address }) -- address must be defined\"\n  )\n  invariant(\n    contractName != undefined,\n    \"generateDependencyPin({ contractName }) -- contractName must be defined\"\n  )\n  invariant(\n    blockHeight != undefined,\n    \"generateDependencyPin({ blockHeight }) -- blockHeight must be defined\"\n  )\n  invariant(\n    typeof address === \"string\",\n    \"generateDependencyPin({ address }) -- address must be a string\"\n  )\n  invariant(\n    typeof contractName === \"string\",\n    \"generateDependencyPin({ contractName }) -- contractName must be a string\"\n  )\n  invariant(\n    typeof blockHeight === \"number\",\n    \"generateDependencyPin({ blockHeight }) -- blockHeight must be a number\"\n  )\n\n  let horizon = [generateImport({contractName, address})]\n\n  for (const horizonImport of horizon) {\n    let account = await send(\n      [\n        getAccount(\n          await config().get(horizonImport.address, horizonImport.address)\n        ),\n        atBlockHeight(blockHeight),\n      ],\n      opts\n    ).then(decode)\n\n    horizonImport.contract = account.contracts?.[horizonImport.contractName]\n\n    if (!horizonImport.contract) {\n      console.error(\"Did not find expected contract\", horizonImport, account)\n      throw new Error(\"Did not find expected contract\")\n    }\n\n    let contractImports = findImports(horizonImport.contract)\n\n    horizon.push(...contractImports)\n  }\n\n  let contractHashes = horizon.map(iport => genHash(iport.contract))\n\n  let contractHashesJoined = contractHashes.join(\"\")\n\n  return genHash(contractHashesJoined)\n}\n\n/**\n * @description Produces a dependency pin for a contract at latest sealed block\n * @param {object} params\n * @param {string} params.address - The address of the account containing the contract\n * @param {string} params.contractName - The name of the contract\n * @param {object} opts - Options to pass to the interaction\n * @returns {Promise<string>} - The dependency pin\n */\nexport async function generateDependencyPinAtLatestSealedBlock(\n  {address, contractName},\n  opts = {}\n) {\n  let latestSealedBlock = await block({sealed: true}, opts)\n  let latestSealedBlockHeight = latestSealedBlock?.height\n\n  return generateDependencyPin(\n    {address, contractName, blockHeight: latestSealedBlockHeight},\n    opts\n  )\n}\n","export function normalizeInteractionTemplateInterface(templateInterface) {\n  if (templateInterface == null) return null\n\n  switch (templateInterface[\"f_version\"]) {\n    case \"1.0.0\":\n      return templateInterface\n\n    default:\n      throw new Error(\n        \"normalizeInteractionTemplateInterface Error: Invalid InteractionTemplateInterface\"\n      )\n  }\n}\n","import {invariant} from \"@onflow/sdk\"\nimport {encode as rlpEncode} from \"@onflow/rlp\"\nimport {genHash} from \"./utils/hash.js\"\nimport {normalizeInteractionTemplateInterface} from \"../normalizers/interaction-template/interaction-template-interface.js\"\n\n/**\n * @description Generates Interaction Template Interface ID for a given Interaction Template Interface\n * \n * @param {object} params\n * @param {object} params.templateInterface - Interaction Template Interface\n * @returns {Promise<string>} - Interaction Template Interface ID\n */\nexport async function generateTemplateInterfaceId({templateInterface}) {\n  invariant(\n    templateInterface != undefined,\n    \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface must be defined\"\n  )\n  invariant(\n    typeof templateInterface === \"object\",\n    \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface must be an object\"\n  )\n  invariant(\n    typeof templateInterface.f_type === \"InteractionTemplateInterface\",\n    \"generateTemplateInterfaceId({ templateInterface }) -- templateInterface object must be an InteractionTemplate\"\n  )\n\n  templateInterface = normalizeInteractionTemplateInterface(templateInterface)\n\n  switch (templateInterface.f_version) {\n    case \"1.0.0\":\n      const interfaceData = templateInterface.data\n\n      const encodedHex = rlpEncode([\n        await genHash(\"InteractionTemplateInterface\"),\n        await genHash(\"1.0.0\"),\n        await genHash(interfaceData.flip),\n        await Promise.all(\n          Object.keys(interfaceData.arguments).map(async argumentLabel => [\n            await genHash(argumentLabel),\n            await genHash(String(interfaceData.arguments[argumentLabel].index)),\n            await genHash(interfaceData.arguments[argumentLabel].type),\n          ])\n        ),\n      ]).toString(\"hex\")\n\n      return genHash(encodedHex)\n\n    default:\n      throw new Error(\n        \"generateTemplateInterfaceId Error: Unsupported templateInterface version\"\n      )\n  }\n}\n","import {generateDependencyPin} from \"./generate-dependency-pin.js\"\nimport {invariant, block} from \"@onflow/sdk\"\nimport {log, LEVELS} from \"@onflow/util-logger\"\nimport {normalizeInteractionTemplate} from \"../normalizers/interaction-template/interaction-template.js\"\n\n/**\n * @description Checks if an Interaction Template's pins match those generated at a block height\n * \n * @param {object} params\n * @param {object} params.template - Interaction Template to check pins for\n * @param {number} params.blockHeight - Block height to check pins at\n * @param {string} params.network - Network to check pins on\n * @param {object} opts\n * @returns {Promise<boolean>} - Whether or not the pins match\n */\nexport async function verifyDependencyPinsSame(\n  {template, blockHeight, network},\n  opts = {}\n) {\n  invariant(\n    template != undefined,\n    \"generateDependencyPin({ template }) -- template must be defined\"\n  )\n  invariant(\n    typeof template === \"object\",\n    \"generateDependencyPin({ template }) -- template must be an object\"\n  )\n  invariant(\n    template.f_type === \"InteractionTemplate\",\n    \"generateDependencyPin({ template }) -- template must be an InteractionTemplate\"\n  )\n\n  template = normalizeInteractionTemplate(template)\n\n  invariant(\n    network != undefined,\n    \"generateDependencyPin({ network }) network must be defined\"\n  )\n  invariant(\n    blockHeight != undefined,\n    \"generateDependencyPin({ blockHeight }) blockHeight must be defined\"\n  )\n  invariant(\n    typeof blockHeight === \"number\",\n    \"generateDependencyPin({ blockHeight }) blockHeight must be a number\"\n  )\n\n  switch (template.f_version) {\n    case \"1.0.0\":\n      let templateDependenciesPlaceholderKeys = Object.keys(\n        template.data.dependencies\n      )\n\n      for (let templateDependencyPlaceholderKey of templateDependenciesPlaceholderKeys) {\n        let templateDependencyPlaceholder =\n          template.data.dependencies[templateDependencyPlaceholderKey]\n\n        let templateDependencyPlaceholderContractNames = Object.keys(\n          templateDependencyPlaceholder\n        )\n\n        for (let templateDependencyPlaceholderContractName of templateDependencyPlaceholderContractNames) {\n          let templateDependencyPlaceholderContractNetworks =\n            template.data.dependencies[templateDependencyPlaceholderKey][\n              templateDependencyPlaceholderContractName\n            ]\n\n          let templateDependency =\n            templateDependencyPlaceholderContractNetworks[network]\n          if (typeof templateDependency === \"undefined\") continue\n\n          let pin = await generateDependencyPin(\n            {\n              address: templateDependency.address,\n              contractName: templateDependency.contract,\n              blockHeight,\n            },\n            opts\n          )\n\n          if (pin !== templateDependency.pin) {\n            log({\n              title: \"verifyDependencyPinsSame Debug Error\",\n              message: `Could not recompute and match dependency pin.\n                                address: ${templateDependency.address} | contract: ${templateDependency.contract}\n                                computed: ${pin}\n                                template: ${templateDependency.pin}\n                            `,\n              level: LEVELS.debug,\n            })\n            return false\n          }\n        }\n      }\n\n      return true\n\n    default:\n      throw new Error(\n        \"verifyDependencyPinsSame Error: Unsupported template version\"\n      )\n  }\n}\n\n/**\n * @description Checks if an Interaction Template's pins match those generated at the latest block height\n * \n * @param {object} params\n * @param {object} params.template - Interaction Template to check pins for\n * @param {string} params.network - Network to check pins on\n * @param {object} opts\n * @returns {Promise<boolean>} - Whether or not the pins match\n */\nexport async function verifyDependencyPinsSameAtLatestSealedBlock(\n  {template, network},\n  opts = {}\n) {\n  let latestSealedBlock = await block({sealed: true})\n  let latestSealedBlockHeight = latestSealedBlock?.height\n\n  return verifyDependencyPinsSame(\n    {template, network, blockHeight: latestSealedBlockHeight},\n    opts\n  )\n}\n","import {invariant} from \"@onflow/sdk\"\n\n/**\n * @description Get Interaction Template argument message\n * \n * @param {object} params\n * @param {string} params.localization [localization=\"en-US\"] - Localization code\n * @param {string} params.messageKey - Message key\n * @param {object} params.template - Interaction Template\n * @returns {string} - Message\n */\nexport function getTemplateMessage({\n  localization = \"en-US\",\n  messageKey,\n  template,\n}) {\n  invariant(\n    messageKey,\n    \"getTemplateMessage({ messageKey }) -- messageKey must be defined\"\n  )\n  invariant(\n    typeof messageKey === \"string\",\n    \"getTemplateMessage({ messageKey }) -- messageKey must be a string\"\n  )\n\n  invariant(\n    localization,\n    \"getTemplateMessage({ localization }) -- localization must be defined\"\n  )\n  invariant(\n    typeof localization === \"string\",\n    \"getTemplateMessage({ localization }) -- localization must be a string\"\n  )\n\n  invariant(\n    template != undefined,\n    \"getTemplateMessage({ template }) -- template must be defined\"\n  )\n  invariant(\n    typeof template === \"object\",\n    \"getTemplateMessage({ template }) -- template must be an object\"\n  )\n  invariant(\n    typeof template.f_type === \"InteractionTemplate\",\n    \"getTemplateMessage({ template }) -- template object must be an InteractionTemplate\"\n  )\n\n  const messages = template?.data?.messages\n\n  return messages?.[messageKey]?.i18n?.[localization]\n}\n","import {invariant} from \"@onflow/sdk\"\n\n/**\n * @description Gets Interaction Template argument message by message key, argument label, and localization\n * \n * @param {object} opts\n * @param {string} opts.localization [localization=\"en-US\"] - Localization to get message for\n * @param {string} opts.argumentLabel - Argument label to get message for\n * @param {string} opts.messageKey - Message key to get message for\n * @param {object} opts.template - Interaction Template to get message from\n * @returns {string} - Message\n */\nexport function getTemplateArgumentMessage({\n  localization = \"en-US\",\n  argumentLabel,\n  messageKey,\n  template,\n}) {\n  invariant(\n    messageKey,\n    \"getTemplateArgumentMessage({ messageKey }) -- messageKey must be defined\"\n  )\n  invariant(\n    typeof messageKey === \"string\",\n    \"getTemplateArgumentMessage({ messageKey }) -- messageKey must be a string\"\n  )\n\n  invariant(\n    argumentLabel,\n    \"getTemplateArgumentMessage({ argumentLabel }) -- argumentLabel must be defined\"\n  )\n  invariant(\n    typeof messageKey === \"string\",\n    \"getTemplateArgumentMessage({ argumentLabel }) -- argumentLabel must be a string\"\n  )\n\n  invariant(\n    localization,\n    \"getTemplateArgumentMessage({ localization }) -- localization must be defined\"\n  )\n  invariant(\n    typeof localization === \"string\",\n    \"getTemplateArgumentMessage({ localization }) -- localization must be a string\"\n  )\n\n  invariant(\n    template != undefined,\n    \"getTemplateArgumentMessage({ template }) -- template must be defined\"\n  )\n  invariant(\n    typeof template === \"object\",\n    \"getTemplateArgumentMessage({ template }) -- template must be an object\"\n  )\n  invariant(\n    typeof template.f_type === \"InteractionTemplate\",\n    \"getTemplateArgumentMessage({ template }) -- template object must be an InteractionTemplate\"\n  )\n\n  const args = template?.data?.arguments\n\n  return args?.[argumentLabel]?.messages?.[messageKey]?.i18n?.[localization]\n}\n","import \"./default-config\"\nexport {VERSION} from \"./VERSION\"\nexport {query} from \"./exec/query\"\nexport {mutate} from \"./exec/mutate\"\nexport {verifyUserSignatures} from \"./exec/verify\"\nexport {serialize} from \"./serialize\"\nexport {transaction as tx} from \"./transaction\"\nexport {events} from \"./events\"\nexport {pluginRegistry} from \"./current-user/exec-service/plugins\"\n\nimport {currentUser} from \"./current-user\"\nexport {currentUser}\n\nimport {discovery} from \"./discovery\"\nexport {discovery}\n\nexport const authenticate = (opts = {}) => currentUser().authenticate(opts)\nexport const unauthenticate = () => currentUser().unauthenticate()\nexport const reauthenticate = (opts = {}) => {\n  currentUser().unauthenticate()\n  return currentUser().authenticate(opts)\n}\nexport const signUp = (opts = {}) => currentUser().authenticate(opts)\nexport const logIn = (opts = {}) => currentUser().authenticate(opts)\n\nexport const authz = currentUser().authorization\n\nimport * as types from \"@onflow/types\"\n/**\n * @type {Types}\n */\nexport const t = types\n\nimport * as WalletUtils from \"./wallet-utils\"\nexport {WalletUtils}\n\nimport * as AppUtils from \"./app-utils\"\nexport {AppUtils}\n\nimport * as InteractionTemplateUtils from \"./interaction-template-utils\"\nexport {InteractionTemplateUtils}\n\nexport {getChainId} from \"./utils\"\n\nexport {TestUtils} from \"@onflow/sdk\"\nexport {config} from \"@onflow/config\"\nexport {send} from \"@onflow/sdk\"\nexport {decode} from \"@onflow/sdk\"\nexport {account} from \"@onflow/sdk\"\nexport {block} from \"@onflow/sdk\"\nexport {isOk, isBad, why, pipe, build} from \"@onflow/sdk\"\nexport {withPrefix, sansPrefix, display} from \"@onflow/util-address\"\nexport {template as cadence} from \"@onflow/util-template\"\nexport {template as cdc} from \"@onflow/util-template\"\nexport {createSignableVoucher} from \"@onflow/sdk\"\nexport {voucherIntercept} from \"@onflow/sdk\"\nexport {voucherToTxId} from \"@onflow/sdk\"\n\n// builders\nexport {transaction} from \"@onflow/sdk\"\nexport {script} from \"@onflow/sdk\"\nexport {ping} from \"@onflow/sdk\"\nexport {atBlockHeight} from \"@onflow/sdk\"\nexport {atBlockId} from \"@onflow/sdk\"\nexport {getAccount} from \"@onflow/sdk\"\nexport {getEvents} from \"@onflow/sdk\"\nexport {getEventsAtBlockHeightRange} from \"@onflow/sdk\"\nexport {getEventsAtBlockIds} from \"@onflow/sdk\"\nexport {getBlock} from \"@onflow/sdk\"\nexport {getBlockHeader} from \"@onflow/sdk\"\nexport {getCollection} from \"@onflow/sdk\"\nexport {getTransactionStatus} from \"@onflow/sdk\"\nexport {getTransaction} from \"@onflow/sdk\"\nexport {getNetworkParameters} from \"@onflow/sdk\"\nexport {authorizations, authorization} from \"@onflow/sdk\"\nexport {args, arg} from \"@onflow/sdk\"\nexport {proposer} from \"@onflow/sdk\"\nexport {payer} from \"@onflow/sdk\"\nexport {limit} from \"@onflow/sdk\"\nexport {ref} from \"@onflow/sdk\"\nexport {params, param} from \"@onflow/sdk\"\nexport {validator} from \"@onflow/sdk\"\nexport {invariant} from \"@onflow/sdk\"\n\n/**\n * @typedef {object} Types\n * @property {any} Identity - Represents the Identity type.\n * @property {any} UInt - Represents the UInt type.\n * @property {any} Int - Represents the Int type.\n * @property {any} UInt8 - Represents the UInt8 type.\n * @property {any} Int8 - Represents the Int8 type.\n * @property {any} UInt16 - Represents the UInt16 type.\n * @property {any} Int16 - Represents the Int16 type.\n * @property {any} UInt32 - Represents the UInt32 type.\n * @property {any} Int32 - Represents the Int32 type.\n * @property {any} UInt64 - Represents the UInt64 type.\n * @property {any} Int64 - Represents the Int64 type.\n * @property {any} UInt128 - Represents the UInt128 type.\n * @property {any} Int128 - Represents the Int128 type.\n * @property {any} UInt256 - Represents the UInt256 type.\n * @property {any} Int256 - Represents the Int256 type.\n * @property {any} Word8 - Represents the Word8 type.\n * @property {any} Word16 - Represents the Word16 type.\n * @property {any} Word32 - Represents the Word32 type.\n * @property {any} Word64 - Represents the Word64 type.\n * @property {any} UFix64 - Represents the UFix64 type.\n * @property {any} Fix64 - Represents the Fix64 type.\n * @property {any} String - Represents the String type.\n * @property {any} Character - Represents the Character type.\n * @property {any} Bool - Represents the Bool type.\n * @property {any} Address - Represents the Address type.\n * @property {any} Void - Represents the Void type.\n * @property {any} Optional - Represents the Optional type.\n * @property {any} Reference - Represents the Reference type.\n * @property {any} Array - Represents the Array type.\n * @property {any} Dictionary - Represents the Dictionary type.\n * @property {any} Event - Represents the Event type.\n * @property {any} Resource - Represents the Resource type.\n * @property {any} Struct - Represents the Struct type.\n * @property {any} Enum - Represents the Enum type.\n * @property {any} Path - Represents the Path type.\n */\n\n/**\n * @callback ArgsFn\n * @param {ArgFn} arg - Argument function to define a single argument\n * @param {Types} t - Cadence Types object used to define the type\n * @returns {any[]}\n */\n\n/**\n * @callback ArgFn\n * @param {any} value - the value of the argument\n * @param {any} type - the cadence type of the value\n * @returns {any}\n */"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}